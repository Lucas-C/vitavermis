/* 2:6036c16841ea1dc3b710f96e17d21a10 */
(function(f){var c=/^\s*|\s*$/g,a="$1"==="B".replace(/A(.)|B/,"$1"),b={majorVersion:"@@tinymce_major_version@@",minorVersion:"@@tinymce_minor_version@@",releaseDate:"@@tinymce_release_date@@",_init:function(){function a(c){if(c.src&&/tiny_mce(|_gzip|_jquery|_prototype|_full)(_dev|_src)?.js/.test(c.src)){/_(src|dev)\.js/g.test(c.src)&&(b.suffix="_src");if(-1!=(m=c.src.indexOf("?")))b.query=c.src.substring(m+1);b.baseURL=c.src.substring(0,c.src.lastIndexOf("/"));l&&-1==b.baseURL.indexOf("://")&&0!==
b.baseURL.indexOf("/")&&(b.baseURL=l+b.baseURL);return b.baseURL}return null}var b=this,c=document,h=navigator,k=h.userAgent,l,m,n;b.isOpera=f.opera&&opera.buildNumber;b.isWebKit=/WebKit/.test(k);b.isIE=!b.isWebKit&&!b.isOpera&&/MSIE/gi.test(k)&&/Explorer/gi.test(h.appName);b.isIE6=b.isIE&&/MSIE [56]/.test(k);b.isIE7=b.isIE&&/MSIE [7]/.test(k);b.isIE8=b.isIE&&/MSIE [8]/.test(k);b.isIE9=b.isIE&&/MSIE [9]/.test(k);b.isGecko=!b.isWebKit&&/Gecko/.test(k);b.isMac=-1!=k.indexOf("Mac");b.isAir=/adobeair/i.test(k);
b.isIDevice=/(iPad|iPhone)/.test(k);b.isIOS5=b.isIDevice&&534<=k.match(/AppleWebKit\/(\d*)/)[1];if(f.tinyMCEPreInit)b.suffix=tinyMCEPreInit.suffix,b.baseURL=tinyMCEPreInit.base,b.query=tinyMCEPreInit.query;else{b.suffix="";k=c.getElementsByTagName("base");for(h=0;h<k.length;h++)if(n=k[h].href)/^https?:\/\/[^\/]+$/.test(n)&&(n+="/"),l=n?n.match(/.*\//)[0]:"";k=c.getElementsByTagName("script");for(h=0;h<k.length;h++)if(a(k[h]))return;if(c=c.getElementsByTagName("head")[0]){k=c.getElementsByTagName("script");
for(h=0;h<k.length&&!a(k[h]);h++);}}},is:function(a,b){return!b?void 0!==a:"array"==b&&a.hasOwnProperty&&a instanceof Array?!0:typeof a==b},makeMap:function(a,b,c){a=a||[];"string"==typeof a&&(a=a.split(b||","));c=c||{};for(b=a.length;b--;)c[a[b]]={};return c},each:function(a,b,c){var h,k;if(!a)return 0;c=c||a;if(void 0!==a.length){h=0;for(k=a.length;h<k;h++)if(!1===b.call(c,a[h],h,a))return 0}else for(h in a)if(a.hasOwnProperty(h)&&!1===b.call(c,a[h],h,a))return 0;return 1},trim:function(a){return(a?
""+a:"").replace(c,"")},create:function(a,b,c){var h,k,f,m,n,o=0,a=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(a);f=a[3].match(/(^|\.)(\w+)$/i)[2];k=this.createNS(a[3].replace(/\.\w+$/,""),c);if(!k[f])if("static"==a[2]){if(k[f]=b,this.onCreate)this.onCreate(a[2],a[3],k[f])}else if(b[f]||(b[f]=function(){},o=1),k[f]=b[f],this.extend(k[f].prototype,b),a[5]&&(h=this.resolve(a[5]).prototype,m=a[5].match(/\.(\w+)$/i)[1],n=k[f],k[f]=o?function(){return h[m].apply(this,arguments)}:function(){this.parent=h[m];
return n.apply(this,arguments)},k[f].prototype[f]=k[f],this.each(h,function(a,b){k[f].prototype[b]=h[b]}),this.each(b,function(a,b){h[b]?k[f].prototype[b]=function(){this.parent=h[b];return a.apply(this,arguments)}:b!=f&&(k[f].prototype[b]=a)})),this.each(b["static"],function(a,b){k[f][b]=a}),this.onCreate)this.onCreate(a[2],a[3],k[f].prototype)},walk:function(a,c,g,h){h=h||this;a&&(g&&(a=a[g]),b.each(a,function(a,d){if(!1===c.call(h,a,d,g))return!1;b.walk(a,c,g,h)}))},createNS:function(a,b){var c,
h,b=b||f,a=a.split(".");for(c=0;c<a.length;c++)h=a[c],b[h]||(b[h]={}),b=b[h];return b},resolve:function(a,b){var c,h,b=b||f,a=a.split(".");c=0;for(h=a.length;c<h&&!(b=b[a[c]],!b);c++);return b},addUnload:function(a,b){function c(){function a(){b.detachEvent("onstop",a);k&&k();b=0}var b=document;"interactive"==b.readyState&&(b&&b.attachEvent("onstop",a),f.setTimeout(function(){b&&b.detachEvent("onstop",a)},0))}var h=this,k;k=function(){var a=h.unloads,b,e;if(a){for(e in a)(b=a[e])&&b.func&&b.func.call(b.scope,
1);f.detachEvent?(f.detachEvent("onbeforeunload",c),f.detachEvent("onunload",k)):f.removeEventListener&&f.removeEventListener("unload",k,!1);h.unloads=w=k=0;f.CollectGarbage&&CollectGarbage()}};a={func:a,scope:b||this};h.unloads?h.unloads.push(a):(f.attachEvent?(f.attachEvent("onunload",k),f.attachEvent("onbeforeunload",c)):f.addEventListener&&f.addEventListener("unload",k,!1),h.unloads=[a]);return a},removeUnload:function(a){var c=this.unloads,g=null;b.each(c,function(b,k){if(b&&b.func==a)return c.splice(k,
1),g=a,!1});return g},explode:function(a,c){return!a||b.is(a,"array")?a:b.map(a.split(c||","),b.trim)},_addVer:function(a){var b;if(!this.query)return a;b=(-1==a.indexOf("?")?"?":"&")+this.query;return-1==a.indexOf("#")?a+b:a.replace("#",b+"#")},_replace:function(b,c,g){return a?g.replace(b,function(){var a=c,b=arguments,d;for(d=0;d<b.length-2;d++)a=void 0===b[d]?a.replace(RegExp("\\$"+d,"g"),""):a.replace(RegExp("\\$"+d,"g"),b[d]);return a}):g.replace(b,c)}};b._init();f.tinymce=f.tinyMCE=b})(window);
(function(f,c){var a=/^(href|src|style)$/i;if(!f)return alert("Some of the Javascript files required for Wikispaces did not load. Please reload this page and try again. If this problem continues, make sure an anti-virus program, firewall, or web filter is not blocking Wikispaces Javascript files.");c.$=f;c.adapter={patchEditor:function(b){function c(a,b){b&&this.removeAttr("data-mce-style");return k.css.apply(this,arguments)}function g(c,e){return a.test(c)?void 0!==e?(this.each(function(a,h){b.dom.setAttrib(h,
c,e)}),this):this.attr("data-mce-"+c):k.attr.apply(this,arguments)}function h(a){a.css!==c&&(a.css=c,a.attr=g,a.tinymce=b,a.pushStack=function(){return h(k.pushStack.apply(this,arguments))});return a}var k=f.fn;b.$=function(a,c){var e=b.getDoc();return h(f(a||e,e||c))}}};c.extend=f.extend;c.extend(c,{map:f.map,grep:function(a,b){return f.grep(a,b||function(){return 1})},inArray:function(a,b){return f.inArray(b,a||[])}});var b={"tinymce.dom.DOMUtils":{select:function(a,b){return f.find(a,this.get(b)||
this.get(this.settings.root_element)||this.doc,[])},is:function(a,b){return f(this.get(a)).is(b)}}};c.onCreate=function(a,e,g){c.extend(g,b[e])}})(window.jQuery,tinymce);
tinymce.create("tinymce.util.Dispatcher",{scope:null,listeners:null,inDispatch:!1,Dispatcher:function(f){this.scope=f||this;this.listeners=[]},add:function(f,c){this.listeners.push({cb:f,scope:c||this.scope});return f},addToTop:function(f,c){var a={cb:f,scope:c||this.scope};this.inDispatch?this.listeners=[a].concat(this.listeners):this.listeners.unshift(a);return f},remove:function(f){var c=this.listeners,a=null;tinymce.each(c,function(b,d){if(f==b.cb)return a=b,c.splice(d,1),!1});return a},dispatch:function(){var f,
c=arguments,a,b=this.listeners;this.inDispatch=!0;for(a=0;a<b.length&&!(f=b[a],f=f.cb.apply(f.scope,0<c.length?c:[f.scope]),!1===f);a++);this.inDispatch=!1;return f}});
(function(){var f=tinymce.each;tinymce.create("tinymce.util.URI",{URI:function(c,a){var b=this,d,c=tinymce.trim(c),a=b.settings=a||{};if(/^([\w\-]+):([^\/]{2})/i.test(c)||/^\s*#/.test(c))b.source=c;else if(0===c.indexOf("/")&&0!==c.indexOf("//")&&(c=(a.base_uri?a.base_uri.protocol||"http":"http")+"://mce_host"+c),/^[\w\-]*:?\/\//.test(c)||(d=a.base_uri?a.base_uri.path:(new tinymce.util.URI(location.href)).directory,c=(a.base_uri&&a.base_uri.protocol||"http")+"://mce_host"+b.toAbsPath(d,c)),c=c.replace(/@@/g,
"(mce_at)"),c=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(c),f("source,protocol,authority,userInfo,user,password,host,port,relative,path,directory,file,query,anchor".split(","),function(a,d){var h=c[d];h&&(h=h.replace(/\(mce_at\)/g,"@@"));b[a]=h}),d=a.base_uri){b.protocol||(b.protocol=d.protocol);b.userInfo||(b.userInfo=d.userInfo);!b.port&&"mce_host"===
b.host&&(b.port=d.port);if(!b.host||"mce_host"===b.host)b.host=d.host;b.source=""}},setPath:function(c){c=/^(.*?)\/?(\w+)?$/.exec(c);this.path=c[0];this.directory=c[1];this.file=c[2];this.source="";this.getURI()},toRelative:function(c){var a;if("./"===c)return c;c=new tinymce.util.URI(c,{base_uri:this});if("mce_host"!=c.host&&this.host!=c.host&&c.host||this.port!=c.port||this.protocol!=c.protocol)return c.getURI();a=this.getURI();var b=c.getURI();if(a==b||"/"==a.charAt(a.length-1)&&a.substr(0,a.length-
1)==b)return a;a=this.toRelPath(this.path,c.path);c.query&&(a+="?"+c.query);c.anchor&&(a+="#"+c.anchor);return a},toAbsolute:function(c,a){c=new tinymce.util.URI(c,{base_uri:this});return c.getURI(this.host==c.host&&this.protocol==c.protocol?a:0)},toRelPath:function(c,a){var b,d=0,e="",g,h,c=c.substring(0,c.lastIndexOf("/")),c=c.split("/");b=a.split("/");if(c.length>=b.length){g=0;for(h=c.length;g<h;g++)if(g>=b.length||c[g]!=b[g]){d=g+1;break}}if(c.length<b.length){g=0;for(h=b.length;g<h;g++)if(g>=
c.length||c[g]!=b[g]){d=g+1;break}}if(1===d)return a;g=0;for(h=c.length-(d-1);g<h;g++)e+="../";g=d-1;for(h=b.length;g<h;g++)e=g!=d-1?e+("/"+b[g]):e+b[g];return e},toAbsPath:function(c,a){var b,d=0,e=[],g;g=/\/$/.test(a)?"/":"";c=c.split("/");a=a.split("/");f(c,function(a){a&&e.push(a)});c=e;b=a.length-1;for(e=[];0<=b;b--)0===a[b].length||"."===a[b]||(".."===a[b]?d++:0<d?d--:e.push(a[b]));b=c.length-d;b=0>=b?e.reverse().join("/"):c.slice(0,b).join("/")+"/"+e.reverse().join("/");0!==b.indexOf("/")&&
(b="/"+b);g&&b.lastIndexOf("/")!==b.length-1&&(b+=g);return b},getURI:function(c){var a;if(!this.source||c)a="",c||(this.protocol&&(a+=this.protocol+"://"),this.userInfo&&(a+=this.userInfo+"@"),this.host&&(a+=this.host),this.port&&(a+=":"+this.port)),this.path&&(a+=this.path),this.query&&(a+="?"+this.query),this.anchor&&(a+="#"+this.anchor),this.source=a;return this.source}})})();
(function(){var f=tinymce.each;tinymce.create("static tinymce.util.Cookie",{getHash:function(c){var c=this.get(c),a;c&&f(c.split("&"),function(b){b=b.split("=");a=a||{};a[unescape(b[0])]=unescape(b[1])});return a},setHash:function(c,a,b,d,e,g){var h="";f(a,function(a,b){h+=(!h?"":"&")+escape(b)+"="+escape(a)});this.set(c,h,b,d,e,g)},get:function(c){var a=document.cookie,b=c+"=",d;if(a){d=a.indexOf("; "+b);if(-1==d){if(d=a.indexOf(b),0!==d)return null}else d+=2;c=a.indexOf(";",d);-1==c&&(c=a.length);
return unescape(a.substring(d+b.length,c))}},set:function(c,a,b,d,e,g){document.cookie=c+"="+escape(a)+(b?"; expires="+b.toGMTString():"")+(d?"; path="+escape(d):"")+(e?"; domain="+e:"")+(g?"; secure":"")},remove:function(c,a,b){var d=new Date;d.setTime(d.getTime()-1E3);this.set(c,"",d,a,b)}})})();
(function(){function f(c,a){var b,d,e,g,a=a||'"';if(null==c)return"null";e=typeof c;if("string"==e)return d="\u0008b\tt\nn\u000cf\rr\"\"''\\\\",a+c.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(c,e){if('"'===a&&"'"===c)return c;b=d.indexOf(e);if(b+1)return"\\"+d.charAt(b+1);c=e.charCodeAt().toString(16);return"\\u"+"0000".substring(c.length)+c})+a;if("object"==e){if(c.hasOwnProperty&&c instanceof Array){b=0;for(d="[";b<c.length;b++)d+=(0<b?",":"")+f(c[b],a);return d+"]"}d="{";for(g in c)c.hasOwnProperty(g)&&
(d+="function"!=typeof c[g]?(1<d.length?","+a:a)+g+a+":"+f(c[g],a):"");return d+"}"}return""+c}tinymce.util.JSON={serialize:f,parse:function(c){try{return eval("("+c+")")}catch(a){}}}})();
tinymce.create("static tinymce.util.XHR",{send:function(f){function c(){!f.async||4==b.readyState||1E4<e++?(f.success&&1E4>e&&200==b.status?f.success.call(f.success_scope,""+b.responseText,b,f):f.error&&f.error.call(f.error_scope,1E4<e?"TIMED_OUT":"GENERAL",b,f),b=null):d.setTimeout(c,10)}function a(a){b=0;try{b=new ActiveXObject(a)}catch(c){}return b}var b,d=window,e=0;f.scope=f.scope||this;f.success_scope=f.success_scope||f.scope;f.error_scope=f.error_scope||f.scope;f.async=!1===f.async?!1:!0;f.data=
f.data||"";if(b=d.XMLHttpRequest?new XMLHttpRequest:a("Microsoft.XMLHTTP")||a("Msxml2.XMLHTTP")){b.overrideMimeType&&b.overrideMimeType(f.content_type);b.open(f.type||(f.data?"POST":"GET"),f.url,f.async);f.content_type&&b.setRequestHeader("Content-Type",f.content_type);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.send(f.data);if(!f.async)return c();d.setTimeout(c,10)}}});
(function(){var f=tinymce.extend,c=tinymce.util.JSON,a=tinymce.util.XHR;tinymce.create("tinymce.util.JSONRequest",{JSONRequest:function(a){this.settings=f({},a);this.count=0},send:function(b){var d=b.error,e=b.success,b=f(this.settings,b);b.success=function(a,h){a=c.parse(a);"undefined"==typeof a&&(a={error:"JSON Parse error."});a.error?d.call(b.error_scope||b.scope,a.error,h):e.call(b.success_scope||b.scope,a.result)};b.error=function(a,c){d&&d.call(b.error_scope||b.scope,a,c)};b.data=c.serialize({id:b.id||
"c"+this.count++,method:b.method,params:b.params});b.content_type="application/json";a.send(b)},"static":{sendRPC:function(a){return(new tinymce.util.JSONRequest).send(a)}}})})();(function(f){f.VK={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(c){return c.shiftKey||c.ctrlKey||c.altKey}}})(tinymce);
tinymce.util.Quirks=function(f){function c(a,b){try{f.getDoc().execCommand(a,!1,b)}catch(c){}}function a(){var a=f.getDoc().documentMode;return a?a:6}function b(){function a(b){var c,e,d;c=z.getRng();e=v.getParent(c.startContainer,v.isBlock);b&&(e=v.getNext(e,v.isBlock));if(e){for(e=e.firstChild;e&&3==e.nodeType&&0===e.nodeValue.length;)e=e.nextSibling;e&&"SPAN"===e.nodeName&&(d=e.cloneNode(!1))}f.getDoc().execCommand(b?"ForwardDelete":"Delete",!1,null);e=v.getParent(c.startContainer,v.isBlock);tinymce.each(v.select("span.Apple-style-span,font.Apple-style-span",
e),function(a){var b=z.getBookmark();d?v.replace(d.cloneNode(!1),a,!0):v.remove(a,!0);z.moveToBookmark(b)})}f.onKeyDown.add(function(b,c){var e;e=c.keyCode==A;if(!c.isDefaultPrevented()&&(e||c.keyCode==x)&&!D.modifierPressed(c))c.preventDefault(),a(e)});f.addCommand("Delete",function(){a()})}function d(){f.settings.content_editable||(v.bind(f.getDoc(),"focusin",function(){z.setRng(z.getRng())}),v.bind(f.getDoc(),"mousedown",function(a){a.target==f.getDoc().documentElement&&(f.getWin().focus(),z.setRng(z.getRng()))}))}
function e(){f.onKeyDown.add(function(a,b){if(!b.isDefaultPrevented()&&b.keyCode===x&&z.isCollapsed()&&0===z.getRng(!0).startOffset){var c=z.getNode().previousSibling;c&&c.nodeName&&"hr"===c.nodeName.toLowerCase()&&(v.remove(c),tinymce.dom.Event.cancel(b))}})}function g(){Range.prototype.getClientRects||f.onMouseDown.add(function(a,b){if("HTML"===b.target.nodeName){var c=a.getBody();c.blur();setTimeout(function(){c.focus()},0)}})}function h(){f.onClick.add(function(a,b){b=b.target;/^(IMG|HR)$/.test(b.nodeName)&&
z.getSel().setBaseAndExtent(b,0,b,1);"A"==b.nodeName&&v.hasClass(b,"mceItemAnchor")&&z.select(b);a.nodeChanged()})}function k(){function a(){var b=v.getAttribs(z.getStart().cloneNode(!1));return function(){var a=z.getStart();a!==f.getBody()&&(v.setAttrib(a,"style",null),tinymce.each(b,function(b){a.setAttributeNode(b.cloneNode(!0))}))}}function b(a,c){c.preventDefault();return!1}f.onKeyPress.add(function(b,c){var e;if((8==c.keyCode||46==c.keyCode)&&!z.isCollapsed()&&z.getStart()!=z.getEnd())return e=
a(),b.getDoc().execCommand("delete",!1,null),e(),c.preventDefault(),!1});v.bind(f.getDoc(),"cut",function(){var c;!z.isCollapsed()&&z.getStart()!=z.getEnd()&&(c=a(),f.onKeyUp.addToTop(b),setTimeout(function(){c();f.onKeyUp.remove(b)},0))})}function l(){var a,b;v.bind(f.getDoc(),"selectionchange",function(){b&&(clearTimeout(b),b=0);b=window.setTimeout(function(){var b=z.getRng();if(!a||!tinymce.dom.RangeUtils.compareRanges(b,a)){f.nodeChanged();a=b}},50)})}function m(){7<a()||(c("RespectVisibilityInDesign",
!0),f.contentStyles.push(".mceHideBrInPre pre br {display: none}"),v.addClass(f.getBody(),"mceHideBrInPre"),f.parser.addNodeFilter("pre",function(a){for(var b=a.length,c,e,d,h;b--;){c=a[b].getAll("br");for(e=c.length;e--;)d=c[e],(h=d.prev)&&3===h.type&&"\n"!=h.value.charAt(h.value-1)?h.value+="\n":d.parent.insert(new tinymce.html.Node("#text",3),d,!0).value="\n"}}),f.serializer.addNodeFilter("pre",function(a){for(var b=a.length,c,e,d;b--;){c=a[b].getAll("br");for(e=c.length;e--;)if(d=c[e],(d=d.prev)&&
3==d.type)d.value=d.value.replace(/\r?\n$/,"")}}))}function n(){v.bind(f.getBody(),"mouseup",function(){var a,b=z.getNode();if("IMG"==b.nodeName){if(a=v.getStyle(b,"width"))v.setAttrib(b,"width",a.replace(/[^0-9%]+/g,"")),v.setStyle(b,"width","");if(a=v.getStyle(b,"height"))v.setAttrib(b,"height",a.replace(/[^0-9%]+/g,"")),v.setStyle(b,"height","")}})}function o(){f.onKeyDown.add(function(a,b){var c,e,d,h;c=b.keyCode==A;if(!b.isDefaultPrevented()&&(c||b.keyCode==x)&&!D.modifierPressed(b))if(e=z.getRng(),
d=e.startContainer,h=e.startOffset,e=e.collapsed,3==d.nodeType&&0<d.nodeValue.length&&(0===h&&!e||e&&h===(c?0:1)))nonEmptyElements=a.schema.getNonEmptyElements(),b.preventDefault(),h=v.create("br",{id:"__tmp"}),d.parentNode.insertBefore(h,d),a.getDoc().execCommand(c?"ForwardDelete":"Delete",!1,null),d=z.getRng().startContainer,(c=d.previousSibling)&&1==c.nodeType&&!v.isBlock(c)&&v.isEmpty(c)&&!nonEmptyElements[c.nodeName.toLowerCase()]&&v.remove(c),v.remove("__tmp")})}function p(){function a(){f._refreshContentEditable();
c("StyleWithCSS",!1);c("enableInlineTableEditing",!1);B.object_resizing||c("enableObjectResizing",!1)}B.readonly||(f.onBeforeExecCommand.add(a),f.onMouseDown.add(a))}function q(){function a(){tinymce.each(v.select("a"),function(a){var b=a.parentNode,c=v.getRoot();if(b.lastChild===a){for(;b&&!v.isBlock(b);){if(b.parentNode.lastChild!==b||b===c)return;b=b.parentNode}v.add(b,"br",{"data-mce-bogus":1})}})}f.onExecCommand.add(function(b,c){"CreateLink"===c&&a(b)});f.onSetContent.add(z.onSetContent.add(a))}
function s(){B.forced_root_block&&f.onInit.add(function(){c("DefaultParagraphSeparator",B.forced_root_block)})}function t(){function a(b,c){(!b||!c.initial)&&f.execCommand("mceRepaint")}f.onUndo.add(a);f.onRedo.add(a);f.onSetContent.add(a)}function r(){f.onKeyDown.add(function(a,b){!b.isDefaultPrevented()&&8==b.keyCode&&"IMG"==z.getNode().nodeName&&(b.preventDefault(),a.undoManager.beforeChange(),v.remove(z.getNode()),a.undoManager.add())})}function u(){var b;10<=a()&&(b="",tinymce.each("p,div,h1,h2,h3,h4,h5,h6".split(","),
function(a,c){b=b+((c>0?",":"")+a+":empty")}),f.contentStyles.push(b+"{padding-right: 1px !important}"))}var D=tinymce.VK,x=D.BACKSPACE,A=D.DELETE,v=f.dom,z=f.selection,B=f.settings;(function(){f.onKeyDown.add(function(a,b){if(!b.isDefaultPrevented()&&b.keyCode===x&&z.isCollapsed()&&0===z.getRng(!0).startOffset){var c=z.getNode().previousSibling;if(c&&c.nodeName&&"table"===c.nodeName.toLowerCase())return tinymce.dom.Event.cancel(b)}})})();(function(){f.onKeyDown.add(function(a,b){var c,e,d,h,g;if(!(b.isDefaultPrevented()||
b.keyCode!=D.BACKSPACE))if(c=z.getRng(),e=c.startContainer,d=c.startOffset,h=v.getRoot(),g=e,c.collapsed&&0===d){for(;g&&g.parentNode&&g.parentNode.firstChild==g&&g.parentNode!=h;)g=g.parentNode;"BLOCKQUOTE"===g.tagName&&(a.formatter.toggle("blockquote",null,g),c.setStart(e,0),c.setEnd(e,0),z.setRng(c),z.collapse(!1))}})})();(function(){function a(b,c){var e,d;d=c?"start":"end";e=b[d+"Container"];d=b[d+"Offset"];1==e.nodeType&&e.hasChildNodes()&&(e=e.childNodes[Math.min(c?d:0<d?d-1:0,e.childNodes.length-
1)]);return e}function b(c,e){var d,h,g;g=e?"start":"end";var k;d=c[g+"Container"];h=c[g+"Offset"];g=v.getRoot();1==d.nodeType&&(k=h>=d.childNodes.length,d=a(c,e),3==d.nodeType&&(h=e&&!k?0:d.nodeValue.length));if(3==d.nodeType&&(e&&0<h||!e&&h<d.nodeValue.length))return!1;for(;d!==g;){h=d.parentNode[e?"firstChild":"lastChild"];"BR"==h.nodeName&&(h=h[e?"nextSibling":"previousSibling"]||h);if(h!==d)return!1;d=d.parentNode}return!0}f.onKeyDown.addToTop(function(c,e){var d;d=e.keyCode;if(!e.isDefaultPrevented()&&
(d==A||d==x))if(d=z.getRng(!0),b(d,!0)&&b(d,!1)&&(d.collapsed||v.findCommonAncestor(a(d,!0),a(d))===v.getRoot()))c.setContent(""),c.nodeChanged(),e.preventDefault()})})();tinymce.isWebKit&&(o(),b(),d(),h(),s(),tinymce.isIDevice&&l());tinymce.isIE&&(e(),document.body.setAttribute("role","application"),m(),n(),r(),u());tinymce.isGecko&&(e(),g(),k(),p(),q(),t())};
(function(f){function c(a,c){var e,d,h,g={};if(a){a=a.split(",");c=c||10;for(e=0;e<a.length;e+=2)d=String.fromCharCode(parseInt(a[e],c)),b[d]||(h="&"+a[e+1]+";",g[d]=h,g[h]=d);return g}}var a,b,d,e=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,g=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,h=/[<>&\"\']/g,k=/&(#x|#)?([\w]+);/g,l={128:"\u20ac",130:"\u201a",131:"\u0192",132:"\u201e",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02c6",137:"\u2030",138:"\u0160",
139:"\u2039",140:"\u0152",142:"\u017d",145:"\u2018",146:"\u2019",147:"\u201c",148:"\u201d",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02dc",153:"\u2122",154:"\u0161",155:"\u203a",156:"\u0153",158:"\u017e",159:"\u0178"};b={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};d={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};a=c("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",
32);f.html=f.html||{};f.html.Entities={encodeRaw:function(a,c){return a.replace(c?e:g,function(a){return b[a]||a})},encodeAllRaw:function(a){return(""+a).replace(h,function(a){return b[a]||a})},encodeNumeric:function(a,c){return a.replace(c?e:g,function(a){return 1<a.length?"&#"+(1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320)+65536)+";":b[a]||"&#"+a.charCodeAt(0)+";"})},encodeNamed:function(c,d,h){h=h||a;return c.replace(d?e:g,function(a){return b[a]||h[a]||a})},getEncodeFunc:function(d,h){function k(a,
c){return a.replace(c?e:g,function(a){return b[a]||h[a]||"&#"+a.charCodeAt(0)+";"||a})}function l(a,b){return q.encodeNamed(a,b,h)}var q=f.html.Entities,h=c(h)||a,d=f.makeMap(d.replace(/\+/g,","));return d.named&&d.numeric?k:d.named?h?l:q.encodeNamed:d.numeric?q.encodeNumeric:q.encodeRaw},decode:function(b){return b.replace(k,function(b,c,e){if(c)return e=parseInt(e,2===c.length?16:10),65535<e?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(e&1023))):l[e]||String.fromCharCode(e);if(!(c=d[b]))if(!(c=
a[b]))c=document.createElement("div"),c.innerHTML=b,c=c.textContent||c.innerText||b;return c})}}})(tinymce);
tinymce.html.Styles=function(f,c){function a(a,b,c,e){function d(a){a=parseInt(a).toString(16);return 1<a.length?a:"0"+a}return"#"+d(b)+d(c)+d(e)}var b=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,d=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,e=/\s*([^:]+):\s*([^;]+);?/g,g=/\s+$/,h,k={},l,f=f||{};l="\\\",\\',\\;,\\:,;,:,\ufeff".split(",");for(h=0;h<l.length;h++)k[l[h]]="\ufeff"+h,k["\ufeff"+h]=l[h];return{toHex:function(c){return c.replace(b,
a)},parse:function(c){function h(a,b){var c,e;if(c=r[a+"-top"+b])e=r[a+"-right"+b],c==e&&(c=r[a+"-bottom"+b],e==c&&(e=r[a+"-left"+b],c==e&&(r[a+b]=e,delete r[a+"-top"+b],delete r[a+"-right"+b],delete r[a+"-bottom"+b],delete r[a+"-left"+b])))}function o(a){var b=r[a],c;if(b&&!(0>b.indexOf(" "))){b=b.split(" ");for(c=b.length;c--;)if(b[c]!==b[0])return!1;r[a]=b[0];return!0}}function l(a,b,c,e){o(b)&&o(c)&&o(e)&&(r[a]=r[b]+" "+r[c]+" "+r[e],delete r[b],delete r[c],delete r[e])}function q(a){A=!0;return k[a]}
function s(a,b){A&&(a=a.replace(/\uFEFF[0-9]/g,function(a){return k[a]}));b||(a=a.replace(/\\([\'\";:])/g,"$1"));return a}function t(a,b,c,e,d,h){if(d=d||h)return d=s(d),"'"+d.replace(/\'/g,"\\'")+"'";b=s(b||c||e);v&&(b=v.call(z,b,"style"));return"url('"+b.replace(/\'/g,"\\'")+"')"}var r={},u,D,x,A,v=f.url_converter,z=f.url_converter_scope||this;if(c){for(c=c.replace(/\\[\"\';:\uFEFF]/g,q).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(a){return a.replace(/[;:]/g,q)});u=e.exec(c);){D=u[1].replace(g,"").toLowerCase();
x=u[2].replace(g,"");if(D&&0<x.length){if("font-weight"===D&&"700"===x)x="bold";else if("color"===D||"background-color"===D)x=x.toLowerCase();x=x.replace(b,a);x=x.replace(d,t);r[D]=A?s(x,!0):x}e.lastIndex=u.index+u[0].length}h("border","");h("border","-width");h("border","-color");h("border","-style");h("padding","");h("margin","");l("border","border-width","border-style","border-color");"medium none"===r.border&&delete r.border}return r},serialize:function(a,b){function e(b){var h,g,k,f;if(h=c.styles[b]){g=
0;for(k=h.length;g<k;g++)b=h[g],f=a[b],void 0!==f&&0<f.length&&(d+=(0<d.length?" ":"")+b+": "+f+";")}}var d="",h,g;if(b&&c&&c.styles)e("*"),e(b);else for(h in a)g=a[h],void 0!==g&&0<g.length&&(d+=(0<d.length?" ":"")+h+": "+g+";");return d}}};
(function(f){function c(a,b){return a.split(b||",")}function a(a,b){function e(b){return b.replace(/[A-Z]+/g,function(b){return e(a[b])})}var d,h={};for(d in a)a.hasOwnProperty(d)&&(a[d]=e(a[d]));e(b).replace(/#/g,"#text").replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,function(a,b,e,d){e=c(e,"|");h[b]={attributes:g(e),attributesOrder:e,children:g(d,"|",{"#comment":{}})}});return h}function b(){var b=e.html5;b||(b=e.html5=a({A:"id|accesskey|class|dir|draggable|item|hidden|itemprop|role|spellcheck|style|subject|title",
B:"#|a|abbr|area|audio|b|bdo|br|button|canvas|cite|code|command|datalist|del|dfn|em|embed|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|meta|meter|noscript|object|output|progress|q|ruby|samp|script|select|small|span|strong|sub|sup|svg|textarea|time|var|video",C:"#|a|abbr|area|address|article|aside|audio|b|bdo|blockquote|br|button|canvas|cite|code|command|datalist|del|details|dfn|dialog|div|dl|em|embed|fieldset|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|menu|meta|meter|nav|noscript|ol|object|output|p|pre|progress|q|ruby|samp|script|section|select|small|span|strong|style|sub|sup|svg|table|textarea|time|ul|var|video"},
"html[A|manifest][body|head]head[A][base|command|link|meta|noscript|script|style|title]title[A][#]base[A|href|target][]link[A|href|rel|media|type|sizes][]meta[A|http-equiv|name|content|charset][]style[A|type|media|scoped][#]script[A|charset|type|src|defer|async][#]noscript[A][C]body[A][C]section[A][C]nav[A][C]article[A][C]aside[A][C]h1[A][B]h2[A][B]h3[A][B]h4[A][B]h5[A][B]h6[A][B]hgroup[A][h1|h2|h3|h4|h5|h6]header[A][C]footer[A][C]address[A][C]p[A][B]br[A][]pre[A][B]dialog[A][dd|dt]blockquote[A|cite][C]ol[A|start|reversed][li]ul[A][li]li[A|value][C]dl[A][dd|dt]dt[A][B]dd[A][C]a[A|href|target|ping|rel|media|type][B]em[A][B]strong[A][B]small[A][B]cite[A][B]q[A|cite][B]dfn[A][B]abbr[A][B]code[A][B]var[A][B]samp[A][B]kbd[A][B]sub[A][B]sup[A][B]i[A][B]b[A][B]mark[A][B]progress[A|value|max][B]meter[A|value|min|max|low|high|optimum][B]time[A|datetime][B]ruby[A][B|rt|rp]rt[A][B]rp[A][B]bdo[A][B]span[A][B]ins[A|cite|datetime][B]del[A|cite|datetime][B]figure[A][C|legend|figcaption]figcaption[A][C]img[A|alt|src|height|width|usemap|ismap][]iframe[A|name|src|height|width|sandbox|seamless][]embed[A|src|height|width|type][]object[A|data|type|height|width|usemap|name|form|classid][param]param[A|name|value][]details[A|open][C|legend]command[A|type|label|icon|disabled|checked|radiogroup][]menu[A|type|label][C|li]legend[A][C|B]div[A][C]source[A|src|type|media][]audio[A|src|autobuffer|autoplay|loop|controls][source]video[A|src|autobuffer|autoplay|loop|controls|width|height|poster][source]hr[A][]form[A|accept-charset|action|autocomplete|enctype|method|name|novalidate|target][C]fieldset[A|disabled|form|name][C|legend]label[A|form|for][B]input[A|type|accept|alt|autocomplete|checked|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|height|list|max|maxlength|min|multiple|pattern|placeholder|readonly|required|size|src|step|width|files|value|name][]button[A|autofocus|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|name|value|type][B]select[A|autofocus|disabled|form|multiple|name|size][option|optgroup]datalist[A][B|option]optgroup[A|disabled|label][option]option[A|disabled|selected|label|value][]textarea[A|autofocus|disabled|form|maxlength|name|placeholder|readonly|required|rows|cols|wrap][]keygen[A|autofocus|challenge|disabled|form|keytype|name][]output[A|for|form|name][B]canvas[A|width|height][]map[A|name][B|C]area[A|shape|coords|href|alt|target|media|rel|ping|type][]mathml[A][]svg[A][]table[A|border][caption|colgroup|thead|tfoot|tbody|tr]caption[A][C]colgroup[A|span][col]col[A|span][]thead[A][tr]tfoot[A][tr]tbody[A][tr]tr[A][th|td]th[A|headers|rowspan|colspan|scope][B]td[A|headers|rowspan|colspan][C]"));
return b}function d(){var b=e.html4;b||(b=e.html4=a({Z:"H|K|N|O|P",Y:"X|form|R|Q",ZG:"E|span|width|align|char|charoff|valign",X:"p|T|div|U|W|isindex|fieldset|table",ZF:"E|align|char|charoff|valign",W:"pre|hr|blockquote|address|center|noframes",ZE:"abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height",ZD:"[E][S]",U:"ul|ol|dl|menu|dir",ZC:"p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",T:"h1|h2|h3|h4|h5|h6",ZB:"X|S|Q",S:"R|P",ZA:"a|G|J|M|O|P",R:"a|H|K|N|O",
Q:"noscript|P",P:"ins|del|script",O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe",E:"A|B|C",D:"accesskey|tabindex|onfocus|onblur",C:"onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"lang|xml:lang|dir",A:"id|class|style|title"},"script[id|charset|type|language|src|defer|xml:space][]style[B|id|type|media|title|xml:space][]object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]param[id|name|value|valuetype|type][]p[E|align][#|S]a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]br[A|clear][]span[E][#|S]bdo[A|C|B][#|S]applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]h1[E|align][#|S]img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]map[B|C|A|name][X|form|Q|area]h2[E|align][#|S]iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]h3[E|align][#|S]tt[E][#|S]i[E][#|S]b[E][#|S]u[E][#|S]s[E][#|S]strike[E][#|S]big[E][#|S]small[E][#|S]font[A|B|size|color|face][#|S]basefont[id|size|color|face][]em[E][#|S]strong[E][#|S]dfn[E][#|S]code[E][#|S]q[E|cite][#|S]samp[E][#|S]kbd[E][#|S]var[E][#|S]cite[E][#|S]abbr[E][#|S]acronym[E][#|S]sub[E][#|S]sup[E][#|S]input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]optgroup[E|disabled|label][option]option[E|selected|disabled|label|value][]textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]label[E|for|accesskey|onfocus|onblur][#|S]button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]h4[E|align][#|S]ins[E|cite|datetime][#|Y]h5[E|align][#|S]del[E|cite|datetime][#|Y]h6[E|align][#|S]div[E|align][#|Y]ul[E|type|compact][li]li[E|type|value][#|Y]ol[E|type|compact|start][li]dl[E|compact][dt|dd]dt[E][#|S]dd[E][#|Y]menu[E|compact][li]dir[E|compact][li]pre[E|width|xml:space][#|ZA]hr[E|align|noshade|size|width][]blockquote[E|cite][#|Y]address[E][#|S|p]center[E][#|Y]noframes[E][#|Y]isindex[A|B|prompt][]fieldset[E][#|legend|Y]legend[E|accesskey|align][#|S]table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]caption[E|align][#|S]col[ZG][]colgroup[ZG][col]thead[ZF][tr]tr[ZF|bgcolor][th|td]th[E|ZE][#|Y]form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]noscript[E][#|Y]td[E|ZE][#|Y]tfoot[ZF][tr]tbody[ZF][tr]area[E|D|shape|coords|href|nohref|alt|target][]base[id|href|target][]body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]"));
return b}var e={},g=f.makeMap,h=f.each;f.html.Schema=function(a){function l(b,c,d){var h=a[b];h?h=g(h,",",g(h.toUpperCase()," ")):(h=e[b],h||(h=g(c," ",g(c.toUpperCase()," ")),h=f.extend(h,d),e[b]=h));return h}function m(a){var b,e,d,h,k,o,n,l,m,p,t,q,u,x,D,A,v,z,B=/^([#+\-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,C=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,E=/[*?+]/;if(a){a=c(a);s["@"]&&(A=s["@"].attributes,v=s["@"].attributesOrder);b=0;for(e=a.length;b<e;b++)if(k=B.exec(a[b])){x=k[1];
m=k[2];D=k[3];l=k[4];q={};u=[];o={attributes:q,attributesOrder:u};"#"===x&&(o.paddEmpty=!0);"-"===x&&(o.removeEmpty=!0);if(A){for(z in A)q[z]=A[z];u.push.apply(u,v)}if(l){l=c(l,"|");d=0;for(h=l.length;d<h;d++)if(k=C.exec(l[d]))if(n={},t=k[1],p=k[2].replace(/::/g,":"),x=k[3],k=k[4],"!"===t&&(o.attributesRequired=o.attributesRequired||[],o.attributesRequired.push(p),n.required=!0),"-"===t)delete q[p],u.splice(f.inArray(u,p),1);else{if(x&&("="===x&&(o.attributesDefault=o.attributesDefault||[],o.attributesDefault.push({name:p,
value:k}),n.defaultValue=k),":"===x&&(o.attributesForced=o.attributesForced||[],o.attributesForced.push({name:p,value:k}),n.forcedValue=k),"<"===x))n.validValues=g(k,"?");E.test(p)?(o.attributePatterns=o.attributePatterns||[],n.pattern=RegExp("^"+p.replace(/([?+*])/g,".$1")+"$"),o.attributePatterns.push(n)):(q[p]||u.push(p),q[p]=n)}}!A&&"@"==m&&(A=q,v=u);D&&(o.outputName=m,s[D]=o);E.test(m)?(o.pattern=RegExp("^"+m.replace(/([?+*])/g,".$1")+"$"),r.push(o)):s[m]=o}}}function n(a){s={};r=[];m(a);h(D,
function(a,b){t[b]=a.children})}function o(a){var b=/^(~)?(.+)$/;a&&h(c(a),function(a){var a=b.exec(a),c="~"===a[1],e=c?"span":"div",d=a[2];t[d]=t[e];C[d]=e;c||(B[d]={});h(t,function(a){a[e]&&(a[d]=a[e])})})}function p(a){var b=/^([+\-]?)(\w+)\[([^\]]+)\]$/;a&&h(c(a),function(a){var a=b.exec(a),e,d;a&&(e=(d=a[1])?t[a[2]]:t[a[2]]={"#comment":{}},e=t[a[2]],h(c(a[3],"|"),function(a){"-"===d?delete e[a]:e[a]={}}))})}function q(a){var b=s[a],c;if(b)return b;for(c=r.length;c--;)if(b=r[c],b.pattern.test(a))return b}
var s={},t={},r=[],u,D,x,A,v,z,B,E,C={},a=a||{};D="html5"==a.schema?b():d();!1===a.verify_html&&(a.valid_elements="*[*]");a.valid_styles&&(u={},h(a.valid_styles,function(a,b){u[b]=f.explode(a)}));x=l("whitespace_elements","pre script style textarea");A=l("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr");v=l("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source");z=l("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls");
E=l("non_empty_elements","td th iframe video audio object",v);B=l("block_elements","h1 h2 h3 h4 h5 h6 hr p div address pre form table tbody thead tfoot th tr td li ol ul caption blockquote center dl dt dd dir fieldset noscript menu isindex samp header footer article section hgroup aside nav figure option datalist select optgroup");a.valid_elements?n(a.valid_elements):(h(D,function(a,b){s[b]={attributes:a.attributes,attributesOrder:a.attributesOrder};t[b]=a.children}),"html5"!=a.schema&&h(c("strong/b,em/i"),
function(a){a=c(a,"/");s[a[1]].outputName=a[0]}),s.img.attributesDefault=[{name:"alt",value:""}],h(c("ol,ul,sub,sup,blockquote,span,font,a,table,tbody,tr,strong,em,b,i"),function(a){if(s[a])s[a].removeEmpty=true}),h(c("p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption"),function(a){s[a].paddEmpty=true}));o(a.custom_elements);p(a.valid_children);m(a.extended_valid_elements);p("+ol[ul|ol],+ul[ul|ol]");a.invalid_elements&&f.each(f.explode(a.invalid_elements),function(a){s[a]&&delete s[a]});q("span")||
m("span[!data-mce-type|*]");this.children=t;this.styles=u;this.getBoolAttrs=function(){return z};this.getBlockElements=function(){return B};this.getShortEndedElements=function(){return v};this.getSelfClosingElements=function(){return A};this.getNonEmptyElements=function(){return E};this.getWhiteSpaceElements=function(){return x};this.isValidChild=function(a,b){var c=t[a];return!(!c||!c[b])};this.isValid=function(a,b){var c,e;if(c=q(a))if(b){if(c.attributes[b])return true;if(c=c.attributePatterns)for(e=
c.length;e--;)if(c[e].pattern.test(a))return true}else return true;return false};this.getElementRule=q;this.getCustomElements=function(){return C};this.addValidElements=m;this.setValidElements=n;this.addCustomElements=o;this.addValidChildren=p}})(tinymce);
(function(f){f.html.SaxParser=function(c,a){var b=this,d=function(){},c=c||{};b.schema=a=a||new f.html.Schema;!1!==c.fix_self_closing&&(c.fix_self_closing=!0);f.each("comment,cdata,text,start,end,pi,doctype".split(","),function(a){a&&(b[a]=c[a]||d)});b.parse=function(b){function d(a){var b,c;for(b=p.length;b--;)if(p[b].name===a)break;if(b>=0){for(c=p.length-1;c>=b;c--){a=p[c];a.valid&&k.end(a.name)}p.length=b}}function h(a,b,c,e,d){b=b.toLowerCase();c=b in x?b:J(c||e||d||"");if(A&&!r&&b.indexOf("data-")!==
0){a=y[b];if(!a&&F){for(e=F.length;e--;){a=F[e];if(a.pattern.test(b))break}e===-1&&(a=null)}if(!a||a.validValues&&!(c in a.validValues))return}q.map[b]=c;q.push({name:b,value:c})}var k=this,l,m=0,n,o,p=[],q,s,t,r,u,D,x,A,v,z,B,E,C,y,F,G,L,O,H,M,K,N,T=0,J=f.html.Entities.decode,I,P;M=RegExp("<(?:(?:!--([\\w\\W]*?)--\>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-\\:]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))",
"g");K=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:\\.|[^\"])*)\")|(?:\'((?:\\.|[^\'])*)\')|([^>\s]+)))?/g;N={script:/<\/script[^>]*>/gi,style:/<\/style[^>]*>/gi,noscript:/<\/noscript[^>]*>/gi};D=a.getShortEndedElements();H=c.self_closing_elements||a.getSelfClosingElements();x=a.getBoolAttrs();A=c.validate;u=c.remove_internals;I=c.fix_self_closing;P=f.isIE;for(C=/^:/;l=M.exec(b);){m<l.index&&k.text(J(b.substr(m,l.index-m)));if(n=l[6]){n=n.toLowerCase();P&&C.test(n)&&(n=n.substr(1));d(n)}else if(n=l[7]){n=n.toLowerCase();
P&&C.test(n)&&(n=n.substr(1));m=n in D;I&&H[n]&&p.length>0&&p[p.length-1].name===n&&d(n);if(!A||(v=a.getElementRule(n))){z=true;if(A){y=v.attributes;F=v.attributePatterns}if(E=l[8]){(r=E.indexOf("data-mce-type")!==-1)&&u&&(z=false);q=[];q.map={};E.replace(K,h)}else{q=[];q.map={}}if(A&&!r){G=v.attributesRequired;L=v.attributesDefault;if(O=v.attributesForced)for(o=O.length;o--;){B=O[o];t=B.name;B=B.value;B==="{$uid}"&&(B="mce_"+T++);q.map[t]=B;q.push({name:t,value:B})}if(L)for(o=L.length;o--;){B=L[o];
t=B.name;if(!(t in q.map)){B=B.value;B==="{$uid}"&&(B="mce_"+T++);q.map[t]=B;q.push({name:t,value:B})}}if(G){for(o=G.length;o--;)if(G[o]in q.map)break;o===-1&&(z=false)}q.map["data-mce-bogus"]&&(z=false)}z&&k.start(n,q,m)}else z=false;if(o=N[n]){o.lastIndex=m=l.index+l[0].length;if(l=o.exec(b)){z&&(s=b.substr(m,l.index-m));m=l.index+l[0].length}else{s=b.substr(m);m=b.length}z&&s.length>0&&k.text(s,true);z&&k.end(n);M.lastIndex=m;continue}m||(!E||E.indexOf("/")!=E.length-1?p.push({name:n,valid:z}):
z&&k.end(n))}else(n=l[1])?k.comment(n):(n=l[2])?k.cdata(n):(n=l[3])?k.doctype(n):(n=l[4])&&k.pi(n,l[5]);m=l.index+l[0].length}m<b.length&&k.text(J(b.substr(m)));for(o=p.length-1;o>=0;o--){n=p[o];n.valid&&k.end(n.name)}}}})(tinymce);
(function(f){function c(a,b,c){var d;d=c?"lastChild":"firstChild";c=c?"prev":"next";if(a[d])return a[d];if(a!==b){if(d=a[c])return d;for(a=a.parent;a&&a!==b;a=a.parent)if(d=a[c])return d}}function a(a,b){this.name=a;this.type=b;1===b&&(this.attributes=[],this.attributes.map={})}var b=/^[ \t\r\n]*$/,d={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};f.extend(a.prototype,{replace:function(a){a.parent&&a.remove();this.insert(a,this);this.remove();return this},attr:function(a,
b){var c,d;if("string"!==typeof a){for(d in a)this.attr(d,a[d]);return this}if(c=this.attributes){if(void 0!==b){if(null===b){if(a in c.map){delete c.map[a];for(d=c.length;d--;)if(c[d].name===a){c.splice(d,1);break}}return this}if(a in c.map)for(d=c.length;d--;){if(c[d].name===a){c[d].value=b;break}}else c.push({name:a,value:b});c.map[a]=b;return this}return c.map[a]}},clone:function(){var b=new a(this.name,this.type),c,d,k,f,m;if(k=this.attributes){m=[];m.map={};c=0;for(d=k.length;c<d;c++)f=k[c],
"id"!==f.name&&(m[m.length]={name:f.name,value:f.value},m.map[f.name]=f.value);b.attributes=m}b.value=this.value;b.shortEnded=this.shortEnded;return b},wrap:function(a){this.parent.insert(a,this);a.append(this);return this},unwrap:function(){var a,b;for(a=this.firstChild;a;)b=a.next,this.insert(a,this,!0),a=b;this.remove()},remove:function(){var a=this.parent,b=this.next,c=this.prev;if(a){if(a.firstChild===this){if(a.firstChild=b)b.prev=null}else c.next=b;if(a.lastChild===this){if(a.lastChild=c)c.next=
null}else b.prev=c;this.parent=this.next=this.prev=null}return this},append:function(a){var b;a.parent&&a.remove();(b=this.lastChild)?(b.next=a,a.prev=b,this.lastChild=a):this.lastChild=this.firstChild=a;a.parent=this;return a},insert:function(a,b,c){var d;a.parent&&a.remove();d=b.parent||this;c?(b===d.firstChild?d.firstChild=a:b.prev.next=a,a.prev=b.prev,a.next=b,b.prev=a):(b===d.lastChild?d.lastChild=a:b.next.prev=a,a.next=b.next,a.prev=b,b.next=a);a.parent=d;return a},getAll:function(a){var b,
d=[];for(b=this.firstChild;b;b=c(b,this))b.name===a&&d.push(b);return d},empty:function(){var a,b,d;if(this.firstChild){a=[];for(d=this.firstChild;d;d=c(d,this))a.push(d);for(b=a.length;b--;)d=a[b],d.parent=d.firstChild=d.lastChild=d.next=d.prev=null}this.firstChild=this.lastChild=null;return this},isEmpty:function(a){var d=this.firstChild,h,k;if(d){do{if(1===d.type){if(d.attributes.map["data-mce-bogus"])continue;if(a[d.name])return!1;for(h=d.attributes.length;h--;)if(k=d.attributes[h].name,"name"===
k||0===k.indexOf("data-"))return!1}if(8===d.type||3===d.type&&!b.test(d.value))return!1}while(d=c(d,this))}return!0},walk:function(a){return c(this,null,a)}});f.extend(a,{create:function(b,c){var h,k;h=new a(b,d[b]||1);if(c)for(k in c)h.attr(k,c[k]);return h}});f.html.Node=a})(tinymce);
(function(f){var c=f.html.Node;f.html.DomParser=function(a,b){function d(a){var d,h,g,k,l,t,r,u,D,x,A;x=f.makeMap("tr,td,th,tbody,thead,tfoot,table");D=b.getNonEmptyElements();for(d=0;d<a.length;d++)if(h=a[d],h.parent){k=[h];for(g=h.parent;g&&!b.isValidChild(g.name,h.name)&&!x[g.name];g=g.parent)k.push(g);if(g&&1<k.length){k.reverse();l=t=e.filterNode(k[0].clone());for(u=0;u<k.length-1;u++){b.isValidChild(t.name,k[u].name)?(r=e.filterNode(k[u].clone()),t.append(r)):r=t;for(t=k[u].firstChild;t&&t!=
k[u+1];)A=t.next,r.append(t),t=A;t=r}l.isEmpty(D)?g.insert(h,k[0],!0):(g.insert(l,k[0],!0),g.insert(h,l));g=k[0];(g.isEmpty(D)||g.firstChild===g.lastChild&&"br"===g.firstChild.name)&&g.empty().remove()}else h.parent&&("li"===h.name?(g=h.prev)&&("ul"===g.name||"ul"===g.name)?g.append(h):(g=h.next)&&("ul"===g.name||"ul"===g.name)?g.insert(h,g.firstChild,!0):h.wrap(e.filterNode(new c("ul",1))):b.isValidChild(h.parent.name,"div")&&b.isValidChild("div",h.name)?h.wrap(e.filterNode(new c("div",1))):"style"===
h.name||"script"===h.name?h.empty().remove():h.unwrap())}}var e=this,g={},h=[],k={},l={},a=a||{};a.validate="validate"in a?a.validate:!0;a.root_name=a.root_name||"body";e.schema=b=b||new f.html.Schema;e.filterNode=function(a){var b,c,d;c in g&&((d=k[c])?d.push(a):k[c]=[a]);for(b=h.length;b--;)c=h[b].name,c in a.attributes.map&&((d=l[c])?d.push(a):l[c]=[a]);return a};e.addNodeFilter=function(a,b){f.each(f.explode(a),function(a){var c=g[a];c||(g[a]=c=[]);c.push(b)})};e.addAttributeFilter=function(a,
b){f.each(f.explode(a),function(a){var c;for(c=0;c<h.length;c++)if(h[c].name===a){h[c].callbacks.push(b);return}h.push({name:a,callbacks:[b]})})};e.parse=function(e,n){function o(){for(var a=t.firstChild,b,c;a;)b=a.next,3==a.type||1==a.type&&"p"!==a.name&&!B[a.name]&&!a.attr("data-mce-type")?(c||(c=p(K,1),t.insert(c,a)),c.append(a)):c=null,a=b}function p(a,b){var d=new c(a,b),e;a in g&&((e=k[a])?e.push(d):k[a]=[d]);return d}function q(a){for(var b,a=a.prev;a&&3===a.type;)b=a.value.replace(F,""),0<
b.length?(a.value=b,a=a.prev):(b=a.prev,a.remove(),a=b)}var s,t,r,u,D,x,A,v,z,B,E,C=[],y,F,G,L,O,H,M,K,n=n||{};k={};l={};B=f.extend(f.makeMap("script,style,head,html,body,title,meta,param"),b.getBlockElements());M=b.getNonEmptyElements();H=b.children;z=a.validate;K="forced_root_block"in n?n.forced_root_block:a.forced_root_block;O=b.getWhiteSpaceElements();E=/^[ \t\r\n]+/;F=/[ \t\r\n]+$/;G=/[ \t\r\n]+/g;L=/^[ \t\r\n]+$/;s=new f.html.SaxParser({validate:z,self_closing_elements:function(a){var b,c={};
for(b in a)"li"!==b&&"p"!=b&&(c[b]=a[b]);return c}(b.getSelfClosingElements()),cdata:function(a){r.append(p("#cdata",4)).value=a},text:function(a,b){var c;y||(a=a.replace(G," "),r.lastChild&&B[r.lastChild.name]&&(a=a.replace(E,"")));0!==a.length&&(c=p("#text",3),c.raw=!!b,r.append(c).value=a)},comment:function(a){r.append(p("#comment",8)).value=a},pi:function(a,b){r.append(p(a,7)).value=b;q(r)},doctype:function(a){r.append(p("#doctype",10)).value=a;q(r)},start:function(a,c,d){var e,g,k;if(e=z?b.getElementRule(a):
{}){e=p(e.outputName||a,1);e.attributes=c;e.shortEnded=d;r.append(e);(g=H[r.name])&&H[e.name]&&!g[e.name]&&C.push(e);for(g=h.length;g--;)k=h[g].name,k in c.map&&((v=l[k])?v.push(e):l[k]=[e]);B[a]&&q(e);d||(r=e);!y&&O[a]&&(y=!0)}},end:function(a){var d,e,h,g;if(e=z?b.getElementRule(a):{}){if(B[a]){if(!y){if((d=r.firstChild)&&3===d.type){h=d.value.replace(E,"");0<h.length?(d.value=h,d=d.next):(g=d.next,d.remove(),d=g);for(;d&&3===d.type;)h=d.value,g=d.next,(0===h.length||L.test(h))&&d.remove(),d=g}if((d=
r.lastChild)&&3===d.type){h=d.value.replace(F,"");0<h.length?(d.value=h,d=d.prev):(g=d.prev,d.remove(),d=g);for(;d&&3===d.type;)h=d.value,g=d.prev,(0===h.length||L.test(h))&&d.remove(),d=g}}if((d=r.prev)&&3===d.type)h=d.value.replace(E,""),0<h.length?d.value=h:d.remove()}y&&O[a]&&(y=!1);if((e.removeEmpty||e.paddEmpty)&&r.isEmpty(M))if(e.paddEmpty)r.empty().append(new c("#text","3")).value="\u00a0";else if(!r.attributes.map.name&&!r.attributes.map.id){a=r.parent;r.empty().remove();r=a;return}r=r.parent}}},
b);t=r=new c(n.context||a.root_name,11);s.parse(e);z&&C.length&&(n.context?n.invalid=!0:d(C));K&&"body"==t.name&&o();if(!n.invalid){for(A in k){v=g[A];s=k[A];for(x=s.length;x--;)s[x].parent||s.splice(x,1);u=0;for(D=v.length;u<D;u++)v[u](s,A,n)}u=0;for(D=h.length;u<D;u++)if(v=h[u],v.name in l){s=l[v.name];for(x=s.length;x--;)s[x].parent||s.splice(x,1);x=0;for(A=v.callbacks.length;x<A;x++)v.callbacks[x](s,v.name,n)}}return t};a.remove_trailing_brs&&e.addNodeFilter("br",function(a){var c,d=a.length,
e,h=f.extend({},b.getBlockElements()),g=b.getNonEmptyElements(),k,l,u;h.body=1;for(c=0;c<d;c++)if(e=a[c],k=e.parent,h[e.parent.name]&&e===k.lastChild){for(l=e.prev;l;){u=l.name;if("span"!==u||"bookmark"!==l.attr("data-mce-type")){if("br"!==u)break;if("br"===u){e=null;break}}l=l.prev}if(e&&(e.remove(),k.isEmpty(g)&&(elementRule=b.getElementRule(k.name))))elementRule.removeEmpty?k.remove():elementRule.paddEmpty&&(k.empty().append(new f.html.Node("#text",3)).value="\u00a0")}else{for(l=e;k.firstChild===
l&&k.lastChild===l;){l=k;if(h[k.name])break;k=k.parent}l===k&&(textNode=new f.html.Node("#text",3),textNode.value="\u00a0",e.replace(textNode))}});a.allow_html_in_named_anchor||e.addAttributeFilter("id,name",function(a){for(var b=a.length,c,d,e,h;b--;)if(h=a[b],"a"===h.name&&h.firstChild&&!h.attr("href")){e=h.parent;c=h.lastChild;do d=c.prev,e.insert(c,h),c=d;while(c)}})}})(tinymce);
tinymce.html.Writer=function(f){var c=[],a,b,d,e,g,f=f||{};a=f.indent;b=tinymce.makeMap(f.indent_before||"");d=tinymce.makeMap(f.indent_after||"");e=tinymce.html.Entities.getEncodeFunc(f.entity_encoding||"raw",f.entities);g="html"==f.element_format;return{start:function(h,k,f){var m,n,o;a&&b[h]&&0<c.length&&(m=c[c.length-1],0<m.length&&"\n"!==m&&c.push("\n"));c.push("<",h);if(k){m=0;for(n=k.length;m<n;m++)o=k[m],c.push(" ",o.name,'="',e(o.value,!0),'"')}c[c.length]=!f||g?">":" />";f&&a&&d[h]&&0<c.length&&
(m=c[c.length-1],0<m.length&&"\n"!==m&&c.push("\n"))},end:function(b){c.push("</",b,">");a&&d[b]&&0<c.length&&(b=c[c.length-1],0<b.length&&"\n"!==b&&c.push("\n"))},text:function(a,b){0<a.length&&(c[c.length]=b?a:e(a))},cdata:function(a){c.push("<![CDATA[",a,"]]\>")},comment:function(a){c.push("<\!--",a,"--\>")},pi:function(b,d){d?c.push("<?",b," ",d,"?>"):c.push("<?",b,"?>");a&&c.push("\n")},doctype:function(b){c.push("<!DOCTYPE",b,">",a?"\n":"")},reset:function(){c.length=0},getContent:function(){return c.join("").replace(/\n$/,
"")}}};
(function(f){f.html.Serializer=function(c,a){var b=new f.html.Writer(c),c=c||{};c.validate="validate"in c?c.validate:!0;this.schema=a=a||new f.html.Schema;this.writer=b;this.serialize=function(d){function e(c){var d=g[c.type],f,n,o,p,q,s,t,r;if(d)d(c);else{d=c.name;f=c.shortEnded;n=c.attributes;if(h&&n&&1<n.length){q=[];q.map={};r=a.getElementRule(c.name);s=0;for(t=r.attributesOrder.length;s<t;s++)o=r.attributesOrder[s],o in n.map&&(p=n.map[o],q.map[o]=p,q.push({name:o,value:p}));s=0;for(t=n.length;s<
t;s++)o=n[s].name,o in q.map||(p=n.map[o],q.map[o]=p,q.push({name:o,value:p}));n=q}b.start(c.name,n,f);if(!f){if(c=c.firstChild){do e(c);while(c=c.next)}b.end(d)}}}var g,h;h=c.validate;g={3:function(a){b.text(a.value,a.raw)},8:function(a){b.comment(a.value)},7:function(a){b.pi(a.name,a.value)},10:function(a){b.doctype(a.value)},4:function(a){b.cdata(a.value)},11:function(a){if(a=a.firstChild){do e(a);while(a=a.next)}}};b.reset();if(1==d.type&&!c.inner)e(d);else g[11](d);return b.getContent()}}})(tinymce);
tinymce.dom={};
(function(f,c){function a(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&&a.attachEvent("on"+b,c)}function b(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d||!1):a.detachEvent&&a.detachEvent("on"+b,c)}function d(a,b){function c(){return!1}function d(){return!0}var e,h=b||{};for(e in a)"layerX"!==e&&"layerY"!==e&&(h[e]=a[e]);h.target||(h.target=h.srcElement||document);h.preventDefault=function(){h.isDefaultPrevented=d;if(a)a.preventDefault?a.preventDefault():a.returnValue=
false};h.stopPropagation=function(){h.isPropagationStopped=d;if(a)a.stopPropagation?a.stopPropagation():a.cancelBubble=true};h.stopImmediatePropagation=function(){h.isImmediatePropagationStopped=d;h.stopPropagation()};h.isDefaultPrevented||(h.isDefaultPrevented=c,h.isPropagationStopped=c,h.isImmediatePropagationStopped=c);return h}function e(c,d,e){function g(){e.domLoaded||(e.domLoaded=!0,d(p))}var f=c.document,p={type:"ready"};h?a(c,"DOMContentLoaded",g):(a(f,"readystatechange",function(){"complete"===
f.readyState&&(b(f,"readystatechange",arguments.callee),g())}),f.documentElement.doScroll&&c===c.top&&function(){try{f.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}g()}());a(c,"load",g)}function g(g){function f(a,b){var c,d,e,h;if(c=n[b][a.type]){d=0;for(e=c.length;d<e&&!((h=c[d])&&!1===h.func.call(h.scope,a)&&a.preventDefault(),a.isImmediatePropagationStopped());d++);}}var m=this,n={},o,p,q,s;q="onmouseenter"in document.documentElement;p="onfocusin"in document.documentElement;
s={mouseenter:"mouseover",mouseleave:"mouseout"};o=1;m.domLoaded=!1;m.events=n;m.bind=function(b,r,u,D){function x(a){f(d(a||F.event),A)}var A,v,z,B,E,C,y,F=window;if(b&&!(3===b.nodeType||8===b.nodeType)){b[c]?(A=b[c],n[A]||(n[A]={})):(A=o++,b[c]=A,n[A]={});D=D||b;r=r.split(" ");for(z=r.length;z--;)if(B=r[z],C=x,E=y=!1,"DOMContentLoaded"===B&&(B="ready"),(m.domLoaded||"complete"==b.readyState)&&"ready"===B)m.domLoaded=!0,u.call(D,d({type:B}));else{q||(E=s[B])&&(C=function(a){var b,c;b=a.currentTarget;
if((c=a.relatedTarget)&&b.contains)c=b.contains(c);else for(;c&&c!==b;)c=c.parentNode;if(!c){a=d(a||F.event);a.type=a.type==="mouseout"?"mouseleave":"mouseenter";a.target=b;f(a,A)}});if(!p&&("focusin"===B||"focusout"===B))y=!0,E="focusin"===B?"focus":"blur",C=function(a){a=d(a||F.event);a.type=a.type==="focus"?"focusin":"focusout";f(a,A)};(v=n[A][B])?v.push({func:u,scope:D}):(n[A][B]=v=[{func:u,scope:D}],v.fakeName=E,v.capture=y,v.nativeHandler=C,h||(v.proxyHandler=g(A)),"ready"===B?e(b,C,m):a(b,
E||B,h?C:v.proxyHandler,y))}b=v=0;return u}};m.unbind=function(a,d,e){var g,k,f,o,l,p;if(!a||3===a.nodeType||8===a.nodeType)return m;if(g=a[c]){p=n[g];if(d){d=d.split(" ");for(f=d.length;f--;)if(l=d[f],k=p[l]){if(e)for(o=k.length;o--;)k[o].func===e&&k.splice(o,1);if(!e||0===k.length)delete p[l],b(a,k.fakeName||l,h?k.nativeHandler:k.proxyHandler,k.capture)}}else{for(l in p)k=p[l],b(a,k.fakeName||l,h?k.nativeHandler:k.proxyHandler,k.capture);p={}}for(l in p)return m;delete n[g];try{delete a[c]}catch(q){a[c]=
null}}return m};m.fire=function(a,b,e){if(!a||3===a.nodeType||8===a.nodeType)return m;e=d(null,e);e.type=b;do(b=a[c])&&f(e,b),a=a.parentNode||a.ownerDocument||a.defaultView||a.parentWindow;while(a&&!e.isPropagationStopped());return m};m.clean=function(a){var b,d,e=m.unbind;if(!a||3===a.nodeType||8===a.nodeType)return m;a[c]&&e(a);a.getElementsByTagName||(a=a.document);if(a&&a.getElementsByTagName){e(a);d=a.getElementsByTagName("*");for(b=d.length;b--;)a=d[b],a[c]&&e(a)}return m};m.callNativeHandler=
function(a,b){n&&n[a][b.type].nativeHandler(b)};m.destory=function(){n={}};m.add=function(a,b,c,d){"string"===typeof a&&(a=document.getElementById(a));if(a&&a instanceof Array)for(var e=a;e--;)m.add(a[e],b,c,d);else return"init"===b&&(b="ready"),m.bind(a,b instanceof Array?b.join(" "):b,c,d)};m.remove=function(a,b,c,d){if(!a)return m;"string"===typeof a&&(a=document.getElementById(a));if(a instanceof Array){for(var e=a.length;e--;)m.remove(a[e],b,c,d);return m}return m.unbind(a,b instanceof Array?
b.join(" "):b,c)};m.clear=function(a){"string"===typeof a&&(a=document.getElementById(a));return m.clean(a)};m.cancel=function(a){a&&(m.prevent(a),m.stop(a));return!1};m.prevent=function(a){a.preventDefault||(a=d(a));a.preventDefault();return!1};m.stop=function(a){a.stopPropagation||(a=d(a));a.stopPropagation();return!1}}var h=!!document.addEventListener;f.EventUtils=g;f.Event=new g(function(a){return function(b){tinymce.dom.Event.callNativeHandler(a,b)}});f.Event.bind(window,"ready",function(){});
f=0})(tinymce.dom,"data-mce-expando");tinymce.dom.TreeWalker=function(f,c){function a(a,b,g,h){if(a){if(!h&&a[b])return a[b];if(a!=c){if(b=a[g])return b;for(a=a.parentNode;a&&a!=c;a=a.parentNode)if(b=a[g])return b}}}var b=f;this.current=function(){return b};this.next=function(c){return b=a(b,"firstChild","nextSibling",c)};this.prev=function(c){return b=a(b,"lastChild","previousSibling",c)}};
(function(f){var c=f.each,a=f.is,b=f.isWebKit,d=f.isIE,e=f.html.Entities,g=/^[ \t\r\n]*$/;f.create("tinymce.dom.DOMUtils",{doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},DOMUtils:function(a,b){var c;this.doc=a;this.win=window;this.files={};this.cssFlicker=
!1;this.counter=0;this.stdMode=!f.isIE||8<=a.documentMode;this.boxModel=!f.isIE||"CSS1Compat"==a.compatMode||this.stdMode;this.hasOuterHTML="outerHTML"in a.createElement("a");this.settings=b=f.extend({keep_values:!1,hex_colors:1},b);this.schema=b.schema;this.styles=new f.html.Styles({url_converter:b.url_converter,url_converter_scope:b.url_converter_scope},b.schema);if(f.isIE6)try{a.execCommand("BackgroundImageCache",!1,!0)}catch(d){this.cssFlicker=!0}this.fixDoc(a);this.events=b.ownEvents?new f.dom.EventUtils(b.proxy):
f.dom.Event;f.addUnload(this.destroy,this);c=b.schema?b.schema.getBlockElements():{};this.isBlock=function(a){var b=a.nodeType;return b?!!(1===b&&c[a.nodeName]):!!c[a]}},fixDoc:function(a){var b=this.settings,c;if(d&&b.schema)for(c in"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(b){a.createElement(b)}),b.schema.getCustomElements())a.createElement(c)},clone:function(a,b){var e=
this,g,f;if(!d||1!==a.nodeType||b)return a.cloneNode(b);f=e.doc;return!b?(g=f.createElement(a.nodeName),c(e.getAttribs(a),function(b){e.setAttrib(g,b.nodeName,e.getAttrib(a,b.nodeName))}),g):g.firstChild},getRoot:function(){var a=this.settings;return a&&this.get(a.root_element)||this.doc.body},getViewPort:function(a){var b,a=!a?this.win:a;b=a.document;b=this.boxModel?b.documentElement:b.body;return{x:a.pageXOffset||b.scrollLeft,y:a.pageYOffset||b.scrollTop,w:a.innerWidth||b.clientWidth,h:a.innerHeight||
b.clientHeight}},getRect:function(a){var b,a=this.get(a);b=this.getPos(a);a=this.getSize(a);return{x:b.x,y:b.y,w:a.w,h:a.h}},getSize:function(a){var b,c,a=this.get(a);b=this.getStyle(a,"width");c=this.getStyle(a,"height");-1===b.indexOf("px")&&(b=0);-1===c.indexOf("px")&&(c=0);return{w:parseInt(b,10)||a.offsetWidth||a.clientWidth,h:parseInt(c,10)||a.offsetHeight||a.clientHeight}},getParent:function(a,b,c){return this.getParents(a,b,c,!1)},getParents:function(b,c,d,e){var g=this,f,p=g.settings,q=[],
b=g.get(b),e=void 0===e;p.strict_root&&(d=d||g.getRoot());a(c,"string")&&(f=c,c="*"===c?function(a){return 1==a.nodeType}:function(a){return g.is(a,f)});for(;b&&!(b==d||!b.nodeType||9===b.nodeType);){if(!c||c(b))if(e)q.push(b);else return b;b=b.parentNode}return e?q:null},get:function(a){var b;return a&&this.doc&&"string"==typeof a&&(b=a,(a=this.doc.getElementById(a))&&a.id!==b)?this.doc.getElementsByName(b)[1]:a},getNext:function(a,b){return this._findSib(a,b,"nextSibling")},getPrev:function(a,b){return this._findSib(a,
b,"previousSibling")},add:function(b,c,d,e,g){var f=this;return this.run(b,function(b){var h;h=a(c,"string")?f.doc.createElement(c):c;f.setAttribs(h,d);e&&(e.nodeType?h.appendChild(e):f.setHTML(h,e));return!g?b.appendChild(h):h})},create:function(a,b,c){return this.add(this.doc.createElement(a),a,b,c,1)},createHTML:function(a,b,c){var d,e;d="<"+a;for(e in b)b.hasOwnProperty(e)&&(d+=" "+e+'="'+this.encode(b[e])+'"');return"undefined"!=typeof c?d+">"+c+"</"+a+">":d+" />"},remove:function(a,b){return this.run(a,
function(a){var c,d=a.parentNode;if(!d)return null;if(b)for(;c=a.firstChild;)!f.isIE||3!==c.nodeType||c.nodeValue?d.insertBefore(c,a):a.removeChild(c);return d.removeChild(a)})},setStyle:function(a,b,c){var e=this;return e.run(a,function(g){var o;o=g.style;b=b.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(e.pixelStyles.test(b)&&(f.is(c,"number")||/^[\-0-9\.]+$/.test(c)))c+="px";switch(b){case "opacity":if(d&&(o.filter=""===c?"":"alpha(opacity="+100*c+")",!a.currentStyle||!a.currentStyle.hasLayout))o.display=
"inline-block";o[b]=o["-moz-opacity"]=o["-khtml-opacity"]=c||"";break;case "float":d?o.styleFloat=c:o.cssFloat=c;break;default:o[b]=c||""}e.settings.update_styles&&e.setAttrib(g,"data-mce-style")})},getStyle:function(a,b,c){if(a=this.get(a)){if(this.doc.defaultView&&c){b=b.replace(/[A-Z]/g,function(a){return"-"+a});try{return this.doc.defaultView.getComputedStyle(a,null).getPropertyValue(b)}catch(e){return null}}b=b.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});"float"==b&&(b=d?"styleFloat":
"cssFloat");return a.currentStyle&&c?a.currentStyle[b]:a.style?a.style[b]:void 0}},setStyles:function(a,b){var d=this,e=d.settings,g;g=e.update_styles;e.update_styles=0;c(b,function(b,c){d.setStyle(a,c,b)});e.update_styles=g;e.update_styles&&d.setAttrib(a,e.cssText)},removeAllAttribs:function(a){return this.run(a,function(a){var b,c=a.attributes;for(b=c.length-1;0<=b;b--)a.removeAttributeNode(c.item(b))})},setAttrib:function(b,d,e){var g=this;if(b&&d)return g.settings.strict&&(d=d.toLowerCase()),
this.run(b,function(b){var h=g.settings,f=b.getAttribute(d);if(null!==e)switch(d){case "style":if(!a(e,"string")){c(e,function(a,c){g.setStyle(b,c,a)});return}h.keep_values&&(e&&!g._isRes(e)?b.setAttribute("data-mce-style",e,2):b.removeAttribute("data-mce-style",2));b.style.cssText=e;break;case "class":b.className=e||"";break;case "src":case "href":h.keep_values&&(h.url_converter&&(e=h.url_converter.call(h.url_converter_scope||g,e,d,b)),g.setAttrib(b,"data-mce-"+d,e,2));break;case "shape":b.setAttribute("data-mce-style",
e)}a(e)&&null!==e&&0!==e.length?b.setAttribute(d,""+e,2):b.removeAttribute(d,2);tinyMCE.activeEditor&&f!=e&&(h=tinyMCE.activeEditor,h.onSetAttrib.dispatch(h,b,d,e))})},setAttribs:function(a,b){var d=this;return this.run(a,function(a){c(b,function(b,c){d.setAttrib(a,c,b)})})},getAttrib:function(c,e,g){var m,c=this.get(c);if(!c||1!==c.nodeType)return void 0===g?!1:g;a(g)||(g="");if(/^(src|href|style|coords|shape)$/.test(e)&&(m=c.getAttribute("data-mce-"+e)))return m;d&&this.props[e]&&(m=(m=c[this.props[e]])&&
m.nodeValue?m.nodeValue:m);m||(m=c.getAttribute(e,2));if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(e))return!0===c[this.props[e]]&&""===m?e:m?e:"";if("FORM"===c.nodeName&&c.getAttributeNode(e))return c.getAttributeNode(e).nodeValue;if("style"===e&&(m=m||c.style.cssText))m=this.serializeStyle(this.parseStyle(m),c.nodeName),this.settings.keep_values&&!this._isRes(m)&&c.setAttribute("data-mce-style",m);b&&"class"===e&&m&&(m=m.replace(/(apple|webkit)\-[a-z\-]+/gi,
""));if(d)switch(e){case "rowspan":case "colspan":1===m&&(m="");break;case "size":if("+0"===m||20===m||0===m)m="";break;case "width":case "height":case "vspace":case "checked":case "disabled":case "readonly":0===m&&(m="");break;case "hspace":-1===m&&(m="");break;case "maxlength":case "tabindex":if(32768===m||2147483647===m||"32768"===m)m="";break;case "multiple":case "compact":case "noshade":case "nowrap":return 65535===m?e:g;case "shape":m=m.toLowerCase();break;default:0===e.indexOf("on")&&m&&(m=
f._replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1",""+m))}return void 0!==m&&null!==m&&""!==m?""+m:g},getPos:function(a,b){var c=0,d=0,e=this.doc,a=this.get(a),b=b||e.body;if(a){if(a.getBoundingClientRect)return a=a.getBoundingClientRect(),d=this.boxModel?e.documentElement:e.body,c=a.left+(e.documentElement.scrollLeft||e.body.scrollLeft)-d.clientTop,d=a.top+(e.documentElement.scrollTop||e.body.scrollTop)-d.clientLeft,{x:c,y:d};for(e=a;e&&e!=b&&e.nodeType;)c+=e.offsetLeft||0,d+=e.offsetTop||0,
e=e.offsetParent;for(e=a.parentNode;e&&e!=b&&e.nodeType;)c-=e.scrollLeft||0,d-=e.scrollTop||0,e=e.parentNode}return{x:c,y:d}},parseStyle:function(a){return this.styles.parse(a)},serializeStyle:function(a,b){return this.styles.serialize(a,b)},addStyle:function(a){var b=this.doc,c;styleElm=b.getElementById("mceDefaultStyles");styleElm||(styleElm=b.createElement("style"),styleElm.id="mceDefaultStyles",styleElm.type="text/css",c=b.getElementsByTagName("head")[0],c.firstChild?c.insertBefore(styleElm,c.firstChild):
c.appendChild(styleElm));styleElm.styleSheet?styleElm.styleSheet.cssText+=a:styleElm.appendChild(b.createTextNode(a))},loadCSS:function(a){var b=this,e=b.doc,g;a||(a="");g=e.getElementsByTagName("head")[0];c(a.split(","),function(a){var c;b.files[a]||(b.files[a]=!0,c=b.create("link",{rel:"stylesheet",href:f._addVer(a)}),d&&e.documentMode&&e.recalc&&(c.onload=function(){e.recalc&&e.recalc();c.onload=null}),g.appendChild(c))})},addClass:function(a,b){return this.run(a,function(a){var c;if(!b)return 0;
if(this.hasClass(a,b))return a.className;c=this.removeClass(a,b);return a.className=(""!=c?c+" ":"")+b})},removeClass:function(a,b){var c=this,e;return c.run(a,function(a){var d;return c.hasClass(a,b)?(e||(e=RegExp("(^|\\s+)"+b+"(\\s+|$)","g")),d=a.className.replace(e," "),d=f.trim(" "!=d?d:""),a.className=d,d||(a.removeAttribute("class"),a.removeAttribute("className")),d):a.className})},hasClass:function(a,b){a=this.get(a);return!a||!b?!1:-1!==(" "+a.className+" ").indexOf(" "+b+" ")},show:function(a){return this.setStyle(a,
"display","block")},hide:function(a){return this.setStyle(a,"display","none")},isHidden:function(a){a=this.get(a);return!a||"none"==a.style.display||"none"==this.getStyle(a,"display")},uniqueId:function(a){return(!a?"mce_":a)+this.counter++},setHTML:function(a,b){var e=this;return e.run(a,function(a){if(d){for(;a.firstChild;)a.removeChild(a.firstChild);try{a.innerHTML="<br />"+b,a.removeChild(a.firstChild)}catch(g){var h=e.create("div");h.innerHTML="<br />"+b;c(f.grep(h.childNodes),function(b,c){c&&
a.appendChild(b)})}}else a.innerHTML=b;return b})},getOuterHTML:function(a){var b,a=this.get(a);if(!a)return null;if(1===a.nodeType&&this.hasOuterHTML)return a.outerHTML;b=(a.ownerDocument||this.doc).createElement("body");b.appendChild(a.cloneNode(!0));return b.innerHTML},setOuterHTML:function(a,b,c){function e(a,b,c){c=c.createElement("body");c.innerHTML=b;for(b=c.lastChild;b;)g.insertAfter(b.cloneNode(!0),a),b=b.previousSibling;g.remove(a)}var g=this;return this.run(a,function(a){a=g.get(a);if(1==
a.nodeType)if(c=c||a.ownerDocument||g.doc,d)try{d&&1==a.nodeType?a.outerHTML=b:e(a,b,c)}catch(h){e(a,b,c)}else e(a,b,c)})},decode:e.decode,encode:e.encodeAllRaw,insertAfter:function(a,b){b=this.get(b);return this.run(a,function(a){var c,e;c=b.parentNode;(e=b.nextSibling)?c.insertBefore(a,e):c.appendChild(a);return a})},replace:function(b,e,d){a(e,"array")&&(b=b.cloneNode(!0));return this.run(e,function(a){d&&c(f.grep(a.childNodes),function(a){b.appendChild(a)});return a.parentNode.replaceChild(b,
a)})},rename:function(a,b){var e=this,d;a.nodeName!=b.toUpperCase()&&(d=e.create(b),c(e.getAttribs(a),function(b){e.setAttrib(d,b.nodeName,e.getAttrib(a,b.nodeName))}),e.replace(d,a,1));return d||a},findCommonAncestor:function(a,b){for(var c=a,e;c;){for(e=b;e&&c!=e;)e=e.parentNode;if(c==e)break;c=c.parentNode}return!c&&a.ownerDocument?a.ownerDocument.documentElement:c},toHex:function(a){function b(a){a=parseInt(a,10).toString(16);return 1<a.length?a:"0"+a}var c=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(a);
c&&(a="#"+b(c[1])+b(c[2])+b(c[3]));return a},getClasses:function(){function a(o){c(o.imports,function(b){a(b)});c(o.cssRules||o.rules,function(o){switch(o.type||1){case 1:o.selectorText&&c(o.selectorText.split(","),function(a){a=a.replace(/^\s*|\s*$|^\s\./g,"");if(!/\.mce/.test(a)&&/\.[\w\-]+$/.test(a)&&(g=a,a=f._replace(/.*\.([a-z0-9_\-]+).*/i,"$1",a),(!d||(a=d(a,g)))&&!e[a]))b.push({"class":a}),e[a]=1});break;case 3:a(o.styleSheet)}})}var b=[],e={},d=this.settings.class_filter,g;if(this.classes)return this.classes;
try{c(this.doc.styleSheets,a)}catch(o){}0<b.length&&(this.classes=b);return b},run:function(a,b,e){var d=this,g;d.doc&&"string"===typeof a&&(a=d.get(a));if(!a)return!1;e=e||this;return!a.nodeType&&(a.length||0===a.length)?(g=[],c(a,function(a,c){a&&("string"==typeof a&&(a=d.doc.getElementById(a)),g.push(b.call(e,a,c)))}),g):b.call(e,a)},getAttribs:function(a){var b,a=this.get(a);if(!a)return[];if(d){b=[];if("OBJECT"==a.nodeName)return a.attributes;"OPTION"===a.nodeName&&this.getAttrib(a,"selected")&&
b.push({specified:1,nodeName:"selected"});a.cloneNode(!1).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(a){b.push({specified:1,nodeName:a})});return b}return a.attributes},isEmpty:function(a,b){var c,e,d,o,p=0;if(a=a.firstChild){d=new f.dom.TreeWalker(a,a.parentNode);b=b||this.schema?this.schema.getNonEmptyElements():null;do{e=a.nodeType;if(1===e){if(a.getAttribute("data-mce-bogus"))continue;o=a.nodeName.toLowerCase();if(b&&b[o]){if("br"===
o){p++;continue}return!1}this.getAttribs(a);for(c=a.attributes.length;c--;)if(o=a.attributes[c].nodeName,"name"===o||"data-mce-bookmark"===o)return!1}if(8==e||3===e&&!g.test(a.nodeValue))return!1}while(a=d.next())}return 1>=p},destroy:function(a){this.win=this.doc=this.root=this.events=this.frag=null;a||f.removeUnload(this.destroy)},createRng:function(){var a=this.doc;return a.createRange?a.createRange():new f.dom.Range(this)},nodeIndex:function(a,b){var c=0,e,d;if(a){e=a.nodeType;for(a=a.previousSibling;a;a=
a.previousSibling)if(d=a.nodeType,!(b&&3==d)||d!=e&&a.nodeValue.length)c++,e=d}return c},split:function(a,b,c){function e(a){var b,c=a.childNodes,g=a.nodeType;if(!(1==g&&"bookmark"==a.getAttribute("data-mce-type"))){for(b=c.length-1;0<=b;b--)e(c[b]);if(9!=g){if(3==g&&0<a.nodeValue.length){b=f.trim(a.nodeValue).length;if(!(c=!d.isBlock(a.parentNode)))if(!(c=0<b)){if(b=0===b)b=a.nextSibling&&"SPAN"==a.nextSibling.nodeName,b=a.previousSibling&&"SPAN"==a.previousSibling.nodeName&&b;c=b}if(c)return}else if(1==
g&&(c=a.childNodes,1==c.length&&c[0]&&1==c[0].nodeType&&"bookmark"==c[0].getAttribute("data-mce-type")&&a.parentNode.insertBefore(c[0],a),c.length||/^(br|hr|input|img)$/i.test(a.nodeName)))return;d.remove(a)}return a}}var d=this,g=d.createRng(),p,q;if(a&&b)return g.setStart(a.parentNode,d.nodeIndex(a)),g.setEnd(b.parentNode,d.nodeIndex(b)),p=g.extractContents(),g=d.createRng(),g.setStart(b.parentNode,d.nodeIndex(b)+1),g.setEnd(a.parentNode,d.nodeIndex(a)+1),g=g.extractContents(),q=a.parentNode,q.insertBefore(e(p),
a),c?q.replaceChild(c,b):q.insertBefore(b,a),q.insertBefore(e(g),a),d.remove(a),c||b},bind:function(a,b,c,e){return this.events.add(a,b,c,e||this)},unbind:function(a,b,c){return this.events.remove(a,b,c)},fire:function(a,b,c){return this.events.fire(a,b,c)},getContentEditable:function(a){var b;return 1!=a.nodeType?null:(b=a.getAttribute("data-mce-contenteditable"))&&"inherit"!==b?b:"inherit"!==a.contentEditable?a.contentEditable:null},_findSib:function(b,c,e){var d=this,g=c;if(b){a(g,"string")&&(g=
function(a){return d.is(a,c)});for(b=b[e];b;b=b[e])if(g(b))return b}return null},_isRes:function(a){return/^(top|left|bottom|right|width|height)/i.test(a)||/;\s*(top|left|bottom|right|width|height)/i.test(a)}});f.DOM=new f.dom.DOMUtils(document,{process_html:0})})(tinymce);
(function(f){function c(a){function b(a,b){m(A,a,b)}function d(a,b){m(v,a,b)}function e(a){b(a.parentNode,F(a))}function g(a){d(a.parentNode,F(a)+1)}function h(){return n(D)}function f(a,b){var c;if(3==a.nodeType||0>b)return a;for(c=a.firstChild;c&&0<b;)--b,c=c.nextSibling;return c?c:a}function l(b,c,e,d){var g,h;if(b==e)return c==d?0:c<d?-1:1;for(g=e;g&&g.parentNode!=b;)g=g.parentNode;if(g){h=0;for(e=b.firstChild;e!=g&&h<c;)h++,e=e.nextSibling;return c<=h?-1:1}for(g=b;g&&g.parentNode!=e;)g=g.parentNode;
if(g){h=0;for(e=e.firstChild;e!=g&&h<d;)h++,e=e.nextSibling;return h<d?-1:1}for(c=a.findCommonAncestor(b,e);b&&b.parentNode!=c;)b=b.parentNode;b||(b=c);for(d=e;d&&d.parentNode!=c;)d=d.parentNode;d||(d=c);if(b==d)return 0;for(e=c.firstChild;e;){if(e==b)return-1;if(e==d)return 1;e=e.nextSibling}}function m(b,c,e){b?(r[B]=c,r[z]=e):(r[E]=c,r[C]=e);for(c=r[E];c.parentNode;)c=c.parentNode;for(e=r[B];e.parentNode;)e=e.parentNode;e==c?0<l(r[B],r[z],r[E],r[C])&&r.collapse(b):r.collapse(b);r.collapsed=r[B]==
r[E]&&r[z]==r[C];r.commonAncestorContainer=a.findCommonAncestor(r[B],r[E])}function n(a){var b,c=0,e=0,d;if(r[B]==r[E])return o(a);b=r[E];for(d=b.parentNode;d;b=d,d=d.parentNode){if(d==r[B]){var g=b;d=e=c=d=b=void 0;a!=x&&(b=u.createDocumentFragment());d=p(g,a);b&&b.appendChild(d);c=F(g)-r[z];if(!(0>=c))for(d=g.previousSibling;0<c;)e=d.previousSibling,d=t(d,a),b&&b.insertBefore(d,b.firstChild),--c,d=e;a!=D&&(r.setEndBefore(g),r.collapse(v));a=b;return a}++c}b=r[B];for(d=b.parentNode;d;b=d,d=d.parentNode){if(d==
r[E]){g=b;d=e=c=d=c=b=void 0;a!=x&&(b=u.createDocumentFragment());d=q(g,a);b&&b.appendChild(d);c=F(g);++c;c=r[C]-c;for(d=g.nextSibling;d&&0<c;)e=d.nextSibling,d=t(d,a),b&&b.appendChild(d),--c,d=e;a!=D&&(r.setStartAfter(g),r.collapse(A));return b}++e}e-=c;for(b=r[B];0<e;)b=b.parentNode,e--;for(c=r[E];0>e;)c=c.parentNode,e++;e=b.parentNode;for(d=c.parentNode;e!=d;e=e.parentNode,d=d.parentNode)b=e,c=d;var h;a!=x&&(g=u.createDocumentFragment());h=q(b,a);g&&g.appendChild(h);e=F(b);d=F(c);++e;e=d-e;for(h=
b.nextSibling;0<e;)d=h.nextSibling,h=t(h,a),g&&g.appendChild(h),h=d,--e;h=p(c,a);g&&g.appendChild(h);a!=D&&(r.setStartAfter(b),r.collapse(A));return g}function o(a){var b,c,e,d,g;a!=x&&(b=u.createDocumentFragment());if(r[z]==r[C])return b;if(3==r[B].nodeType){c=r[B].nodeValue;e=c.substring(r[z],r[C]);a!=D&&(c=r[B],d=r[z],g=r[C]-r[z],0===d&&g>=c.nodeValue.length-1?c.parentNode.removeChild(c):c.deleteData(d,g),r.collapse(A));if(a==x)return;0<e.length&&b.appendChild(u.createTextNode(e));return b}c=f(r[B],
r[z]);for(e=r[C]-r[z];c&&0<e;)d=c.nextSibling,c=t(c,a),b&&b.appendChild(c),--e,c=d;a!=D&&r.collapse(A);return b}function p(a,b){var c=f(r[E],r[C]-1),e,d,g,h=c!=r[E];if(c==a)return s(c,h,v,b);e=c.parentNode;for(d=s(e,v,v,b);e;){for(;c;)g=c.previousSibling,c=s(c,h,v,b),b!=x&&d.insertBefore(c,d.firstChild),h=A,c=g;if(e==a)return d;c=e.previousSibling;e=e.parentNode;g=s(e,v,v,b);b!=x&&g.appendChild(d);d=g}}function q(a,b){var c=f(r[B],r[z]),e=c!=r[B],d,g,h;if(c==a)return s(c,e,A,b);d=c.parentNode;for(g=
s(d,v,A,b);d;){for(;c;)h=c.nextSibling,c=s(c,e,A,b),b!=x&&g.appendChild(c),e=A,c=h;if(d==a)return g;c=d.nextSibling;d=d.parentNode;h=s(d,v,A,b);b!=x&&h.appendChild(g);g=h}}function s(b,c,e,d){var g;if(c)return t(b,d);if(3==b.nodeType){c=b.nodeValue;e?(g=r[z],e=c.substring(g),c=c.substring(0,g)):(g=r[C],e=c.substring(0,g),c=c.substring(g));d!=D&&(b.nodeValue=c);if(d==x)return;b=a.clone(b,v);b.nodeValue=e;return b}return d==x?void 0:a.clone(b,v)}function t(b,c){if(c!=x)return c==D?a.clone(b,A):b;b.parentNode.removeChild(b)}
var r=this,u=a.doc,D=1,x=2,A=!0,v=!1,z="startOffset",B="startContainer",E="endContainer",C="endOffset",y=tinymce.extend,F=a.nodeIndex;y(r,{startContainer:u,startOffset:0,endContainer:u,endOffset:0,collapsed:A,commonAncestorContainer:u,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:b,setEnd:d,setStartBefore:e,setStartAfter:function(a){b(a.parentNode,F(a)+1)},setEndBefore:function(a){d(a.parentNode,F(a))},setEndAfter:g,collapse:function(a){a?(r[E]=r[B],r[C]=r[z]):(r[B]=r[E],r[z]=
r[C]);r.collapsed=A},selectNode:function(a){e(a);g(a)},selectNodeContents:function(a){b(a,0);d(a,1===a.nodeType?a.childNodes.length:a.nodeValue.length)},compareBoundaryPoints:function(a,b){var c=r[B],e=r[z],d=r[E],g=r[C],h=b.startContainer,f=b.startOffset,k=b.endContainer,o=b.endOffset;if(0===a)return l(c,e,h,f);if(1===a)return l(d,g,h,f);if(2===a)return l(d,g,k,o);if(3===a)return l(c,e,k,o)},deleteContents:function(){n(x)},extractContents:function(){return n(0)},cloneContents:h,insertNode:function(b){var c=
this[B],e=this[z],d;(3===c.nodeType||4===c.nodeType)&&c.nodeValue?e?e>=c.nodeValue.length?a.insertAfter(b,c):(e=c.splitText(e),c.parentNode.insertBefore(b,e)):c.parentNode.insertBefore(b,c):(0<c.childNodes.length&&(d=c.childNodes[e]),d?c.insertBefore(b,d):c.appendChild(b))},surroundContents:function(a){var b=r.extractContents();r.insertNode(a);a.appendChild(b);r.selectNode(a)},cloneRange:function(){return y(new c(a),{startContainer:r[B],startOffset:r[z],endContainer:r[E],endOffset:r[C],collapsed:r.collapsed,
commonAncestorContainer:r.commonAncestorContainer})},toStringIE:function(){return a.create("body",null,h()).outerText}});return r}f.Range=c;c.prototype.toString=function(){return this.toStringIE()}})(tinymce.dom);
(function(){tinymce.dom.TridentSelection=function(f){function c(a,b){var c,d=0,l,m,n,o,p,q=-1,s;c=a.duplicate();c.collapse(b);s=c.parentElement();if(s.ownerDocument===f.dom.doc){for(;"false"===s.contentEditable;)s=s.parentNode;if(!s.hasChildNodes())return{node:s,inside:1};n=s.children;for(l=n.length-1;d<=l;)if(p=Math.floor((d+l)/2),o=n[p],c.moveToElementText(o),q=c.compareEndPoints(b?"StartToStart":"EndToEnd",a),0<q)l=p-1;else if(0>q)d=p+1;else return{node:o};if(0>q){o?c.collapse(!1):(c.moveToElementText(s),
c.collapse(!0),o=s,m=!0);for(d=0;0!==c.compareEndPoints(b?"StartToStart":"StartToEnd",a)&&!(0===c.move("character",1)||s!=c.parentElement());)d++}else{c.collapse(!0);for(d=0;0!==c.compareEndPoints(b?"StartToStart":"StartToEnd",a)&&!(0===c.move("character",-1)||s!=c.parentElement());)d++}return{node:o,position:q,offset:d,inside:m}}}var a=this,b=f.dom,d=!1;this.getBookmark=function(a){function d(a){var c,e,g,h,f=[];c=a.parentNode;for(e=b.getRoot().parentNode;c!=e&&9!==c.nodeType;){g=c.children;for(h=
g.length;h--;)if(a===g[h]){f.push(h);break}a=c;c=c.parentNode}return f}function h(a){if(a=c(k,a))return{position:a.position,offset:a.offset,indexes:d(a.node),inside:a.inside}}var k=f.getRng(),l={};2===a&&(k.item?l.start={ctrl:!0,indexes:d(k.item(0))}:(l.start=h(!0),f.isCollapsed()||(l.end=h())));return l};this.moveToBookmark=function(a){function c(a){var e,d,g,h;e=b.getRoot();for(d=a.length-1;0<=d;d--)h=e.children,g=a[d],g<=h.length-1&&(e=h[g]);return e}function d(b){var h=a[b?"start":"end"],o,p;
h&&(o=0<h.position,p=l.createTextRange(),p.moveToElementText(c(h.indexes)),offset=h.offset,void 0!==offset?(p.collapse(h.inside||o),p.moveStart("character",o?-offset:offset)):p.collapse(b),f.setEndPoint(b?"StartToStart":"EndToStart",p),b&&f.collapse(!0))}var f,l=b.doc.body;a.start&&(a.start.ctrl?(f=l.createControlRange(),f.addElement(c(a.start.indexes))):(f=l.createTextRange(),d(!0),d()),f.select())};this.addRange=function(a){function c(a){var e,g,f,k,s;f=b.create("a");e=a?l:n;g=a?m:o;k=h.duplicate();
if(e==p||e==p.documentElement)e=q,g=0;3==e.nodeType?(e.parentNode.insertBefore(f,e),k.moveToElementText(f),k.moveStart("character",g),b.remove(f),h.setEndPoint(a?"StartToStart":"EndToEnd",k)):(s=e.childNodes,s.length?(g>=s.length?b.insertAfter(f,s[s.length-1]):e.insertBefore(f,s[g]),k.moveToElementText(f)):e.canHaveHTML&&(e.innerHTML="<span>\ufeff</span>",f=e.firstChild,k.moveToElementText(f),k.collapse(d)),h.setEndPoint(a?"StartToStart":"EndToEnd",k),b.remove(f))}var h,k,l,m,n,o,p=f.dom.doc,q=p.body;
l=a.startContainer;m=a.startOffset;n=a.endContainer;o=a.endOffset;h=q.createTextRange();if(l==n&&1==l.nodeType){if(m==o&&!l.hasChildNodes()){if(l.canHaveHTML){(a=l.previousSibling)&&!a.hasChildNodes()&&b.isBlock(a)?a.innerHTML="\ufeff":a=null;l.innerHTML="<span>\ufeff</span><span>\ufeff</span>";h.moveToElementText(l.lastChild);h.select();b.doc.selection.clear();l.innerHTML="";a&&(a.innerHTML="");return}m=b.nodeIndex(l);l=l.parentNode}if(m==o-1)try{k=q.createControlRange();k.addElement(l.childNodes[m]);
k.select();return}catch(s){}}c(!0);c();h.select()};this.getRangeAt=function(){function e(a){var b=c(d,a),e,f,k=0,o;e=b.node;f=b.offset;if(b.inside&&!e.hasChildNodes())h[a?"setStart":"setEnd"](e,0);else if(void 0===f)h[a?"setStartBefore":"setEndAfter"](e);else{if(0>b.position){b=b.inside?e.firstChild:e.nextSibling;if(!b){h[a?"setStartAfter":"setEndAfter"](e);return}if(!f){if(3==b.nodeType)h[a?"setStart":"setEnd"](b,0);else h[a?"setStartBefore":"setEndBefore"](b);return}for(;b;){o=b.nodeValue;k+=o.length;
if(k>=f){e=b;k-=f;k=o.length-k;break}b=b.nextSibling}}else{b=e.previousSibling;if(!b)return h[a?"setStartBefore":"setEndBefore"](e);if(!f){if(3==e.nodeType)h[a?"setStart":"setEnd"](b,e.nodeValue.length);else h[a?"setStartAfter":"setEndAfter"](b);return}for(;b;){k+=b.nodeValue.length;if(k>=f){e=b;k-=f;break}b=b.previousSibling}}h[a?"setStart":"setEnd"](e,k)}}var d=f.getRng(),h=b.createRng(),k,l,m,n;k=d.item?d.item(0):d.parentElement();if(k.ownerDocument!=b.doc)return h;l=f.isCollapsed();if(d.item)return h.setStart(k.parentNode,
b.nodeIndex(k)),h.setEnd(h.startContainer,h.startOffset+1),h;try{e(!0),l||e()}catch(o){if(-2147024809==o.number)n=a.getBookmark(2),m=d.duplicate(),m.collapse(!0),k=m.parentElement(),l||(m=d.duplicate(),m.collapse(!1),m=m.parentElement(),m.innerHTML=m.innerHTML),k.innerHTML=k.innerHTML,a.moveToBookmark(n),d=f.getRng(),e(!0),l||e();else throw o;}return h}}})();
(function(f){f.dom.Element=function(c,a){var b=this,d;b.settings=a=a||{};b.id=c;b.dom=d=a.dom||f.DOM;f.isIE||d.get(b.id);f.each("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,setAttrib,setAttribs,getAttrib,addClass,removeClass,hasClass,getOuterHTML,setOuterHTML,remove,show,hide,isHidden,setHTML,get".split(/,/),function(a){b[a]=function(){var g=[c],h;for(h=0;h<arguments.length;h++)g.push(arguments[h]);g=d[a].apply(d,g);b.update(a);return g}});f.extend(b,{on:function(a,c,d){return f.dom.Event.add(b.id,
a,c,d)},getXY:function(){return{x:parseInt(b.getStyle("left")),y:parseInt(b.getStyle("top"))}},getSize:function(){var a=d.get(b.id);return{w:parseInt(b.getStyle("width")||a.clientWidth),h:parseInt(b.getStyle("height")||a.clientHeight)}},moveTo:function(a,c){b.setStyles({left:a,top:c})},moveBy:function(a,c){var d=b.getXY();b.moveTo(d.x+a,d.y+c)},resizeTo:function(a,c){b.setStyles({width:a,height:c})},resizeBy:function(a,c){var d=b.getSize();b.resizeTo(d.w+a,d.h+c)},update:function(c){f.isIE6&&a.blocker&&
(c=c||"",0===c.indexOf("get")||0===c.indexOf("has")||0===c.indexOf("is")||("remove"==c?d.remove(b.blocker):(b.blocker?c=d.get(b.blocker):(b.blocker=d.uniqueId(),c=d.add(a.container||d.getRoot(),"iframe",{id:b.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'}),d.setStyle(c,"opacity",0)),d.setStyles(c,{left:b.getStyle("left",1),top:b.getStyle("top",1),width:b.getStyle("width",1),height:b.getStyle("height",1),display:b.getStyle("display",1),zIndex:parseInt(b.getStyle("zIndex",1)||
0)-1}))))}})}})(tinymce);
(function(f){var c=f.is,a=f.isIE,b=f.each,d=f.dom.TreeWalker;f.create("tinymce.dom.Selection",{Selection:function(a,c,d,k){var l=this;l.dom=a;l.win=c;l.serializer=d;l.editor=k;b(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(a){l[a]=new f.util.Dispatcher(l)});l.win.getSelection||(l.tridentSel=new f.dom.TridentSelection(l));f.isIE&&a.boxModel&&this._fixIESelection();f.addUnload(l.destroy,l)},setCursorLocation:function(a,b){var c=this.dom.createRng();c.setStart(a,
b);c.setEnd(a,b);this.setRng(c);this.collapse(!1)},getContent:function(a){var b=this.getRng(),d=this.dom.create("body"),f=this.getSel(),l,m,a=a||{};l=m="";a.get=!0;a.format=a.format||"html";a.forced_root_block="";this.onBeforeGetContent.dispatch(this,a);if("text"==a.format)return this.isCollapsed()?"":b.text||(f.toString?f.toString():"");b.cloneContents?(b=b.cloneContents())&&d.appendChild(b):c(b.item)||c(b.htmlText)?(d.innerHTML="<br>"+(b.item?b.item(0).outerHTML:b.htmlText),d.removeChild(d.firstChild)):
d.innerHTML=b.toString();/^\s/.test(d.innerHTML)&&(l=" ");/\s+$/.test(d.innerHTML)&&(m=" ");a.getInner=!0;a.content=this.isCollapsed()?"":l+this.serializer.serialize(d,a)+m;this.onGetContent.dispatch(this,a);return a.content},setContent:function(a,b){var c=this.getRng(),d,f=this.win.document,m,b=b||{format:"html"};b.set=!0;b.content=a;b.no_events||this.onBeforeSetContent.dispatch(this,b);a=b.content;if(c.insertNode){a+='<span id="__caret">_</span>';c.startContainer==f&&c.endContainer==f?f.body.innerHTML=
a:(c.deleteContents(),0===f.body.childNodes.length?f.body.innerHTML=a:c.createContextualFragment?c.insertNode(c.createContextualFragment(a)):(d=f.createDocumentFragment(),m=f.createElement("div"),d.appendChild(m),m.outerHTML=a,c.insertNode(d)));d=this.dom.get("__caret");c=f.createRange();c.setStartBefore(d);c.setEndBefore(d);this.setRng(c);this.dom.remove("__caret");try{this.setRng(c)}catch(n){}}else(c.item&&(f.execCommand("Delete",!1,null),c=this.getRng()),/^\s+/.test(a))?(c.pasteHTML('<span id="__mce_tmp">_</span>'+
a),this.dom.remove("__mce_tmp")):c.pasteHTML(a);b.no_events||this.onSetContent.dispatch(this,b)},getStart:function(){var a=this.getRng(),b,c;if(a.duplicate||a.item){if(a.item)return a.item(0);b=a.duplicate();b.collapse(1);b=b.parentElement();for(a=c=a.parentElement();c=c.parentNode;)if(c==b){b=a;break}return b}b=a.startContainer;1==b.nodeType&&b.hasChildNodes()&&(b=b.childNodes[Math.min(b.childNodes.length-1,a.startOffset)]);return b&&3==b.nodeType?b.parentNode:b},getEnd:function(){var a=this.getRng(),
b;if(a.duplicate||a.item){if(a.item)return a.item(0);a=a.duplicate();a.collapse(0);return(b=a.parentElement())&&"BODY"==b.nodeName?b.lastChild||b:b}b=a.endContainer;a=a.endOffset;1==b.nodeType&&b.hasChildNodes()&&(b=b.childNodes[0<a?a-1:a]);return b&&3==b.nodeType?b.parentNode:b},getBookmark:function(a,c){function d(a,c){var e=0;b(n.select(a),function(a,b){a==c&&(e=b)});return e}function f(a){function b(c){var d,e;e=c?"start":"end";d=a[e+"Container"];e=a[e+"Offset"];if(1==d.nodeType&&"TR"==d.nodeName&&
(d=d.childNodes,d=d[Math.min(c?e:e-1,d.length-1)]))e=c?0:d.childNodes.length,a["set"+(c?"Start":"End")](d,e)}b(!0);b();return a}function l(){function a(b,e){var h=b[e?"startContainer":"endContainer"],f=b[e?"startOffset":"endOffset"],k=[],o,n=0;if(3==h.nodeType){if(c)for(o=h.previousSibling;o&&3==o.nodeType;o=o.previousSibling)f+=o.nodeValue.length;k.push(f)}else o=h.childNodes,f>=o.length&&o.length&&(n=1,f=Math.max(0,o.length-1)),k.push(m.dom.nodeIndex(o[f],c)+n);for(;h&&h!=d;h=h.parentNode)k.push(m.dom.nodeIndex(h,
c));return k}var b=m.getRng(!0),d=n.getRoot(),e={};e.start=a(b,!0);m.isCollapsed()||(e.end=a(b));return e}var m=this,n=m.dom,o,p,q,s,t;if(2==a)return m.tridentSel?m.tridentSel.getBookmark(a):l();if(a)return{rng:m.getRng()};o=m.getRng();q=n.uniqueId();s=tinyMCE.activeEditor.selection.isCollapsed();if(o.duplicate||o.item){if(o.item)return t=o.item(0),p=t.nodeName,{name:p,index:d(p,t)};p=o.duplicate();try{o.collapse(),o.pasteHTML('<span data-mce-type="bookmark" id="'+q+'_start" style="overflow:hidden;line-height:0px">\ufeff</span>'),
s||(p.collapse(!1),o.moveToElementText(p.parentElement()),0===o.compareEndPoints("StartToEnd",p)&&p.move("character",-1),p.pasteHTML('<span data-mce-type="bookmark" id="'+q+'_end" style="overflow:hidden;line-height:0px">\ufeff</span>'))}catch(r){return null}}else{t=m.getNode();p=t.nodeName;if("IMG"==p)return{name:p,index:d(p,t)};p=f(o.cloneRange());s||(p.collapse(!1),p.insertNode(n.create("span",{"data-mce-type":"bookmark",id:q+"_end",style:"overflow:hidden;line-height:0px"},"\ufeff")));o=f(o);o.collapse(!0);
o.insertNode(n.create("span",{"data-mce-type":"bookmark",id:q+"_start",style:"overflow:hidden;line-height:0px"},"\ufeff"))}m.moveToBookmark({id:q,keep:1});return{id:q}},moveToBookmark:function(c){function d(a){var b=c[a?"start":"end"],g,h,f;if(b){f=b[0];h=n;for(g=b.length-1;1<=g;g--){h=h.childNodes;if(b[g]>h.length-1)return;h=h[b[g]]}3===h.nodeType&&(f=Math.min(b[0],h.nodeValue.length));1===h.nodeType&&(f=Math.min(b[0],h.childNodes.length));a?m.setStart(h,f):m.setEnd(h,f)}return!0}function h(a){var d=
l.get(c.id+"_"+a),g,h,k;k=c.keep;if(d&&(g=d.parentNode,"start"==a?(k?(g=d.firstChild,h=1):h=l.nodeIndex(d),o=p=g,q=s=h):(k?(g=d.firstChild,h=1):h=l.nodeIndex(d),p=g,s=h),!k)){k=d.previousSibling;g=d.nextSibling;for(b(f.grep(d.childNodes),function(a){if(a.nodeType==3)a.nodeValue=a.nodeValue.replace(/\uFEFF/g,"")});d=l.get(c.id+"_"+a);)l.remove(d,1);k&&g&&k.nodeType==g.nodeType&&3==k.nodeType&&!f.isOpera&&(h=k.nodeValue.length,k.appendData(g.nodeValue),l.remove(g),"start"==a?(o=p=k,q=s=h):(p=k,s=h))}}
function k(b){l.isBlock(b)&&!b.innerHTML&&!a&&(b.innerHTML='<br data-mce-bogus="1" />');return b}var l=this.dom,m,n,o,p,q,s;if(c)if(c.start){m=l.createRng();n=l.getRoot();if(this.tridentSel)return this.tridentSel.moveToBookmark(c);d(!0)&&d()&&this.setRng(m)}else c.id?(h("start"),h("end"),o&&(m=l.createRng(),m.setStart(k(o),q),m.setEnd(k(p),s),this.setRng(m))):c.name?this.select(l.select(c.name)[c.index]):c.rng&&this.setRng(c.rng)},select:function(a,b){function c(a,b){var e=new d(a,a);do{if(3==a.nodeType&&
0!==f.trim(a.nodeValue).length){b?l.setStart(a,0):l.setEnd(a,a.nodeValue.length);break}if("BR"==a.nodeName){b?l.setStartBefore(a):l.setEndBefore(a);break}}while(a=b?e.next():e.prev())}var k=this.dom,l=k.createRng();a&&(k=k.nodeIndex(a),l.setStart(a.parentNode,k),l.setEnd(a.parentNode,k+1),b&&(c(a,1),c(a)),this.setRng(l));return a},isCollapsed:function(){var a=this.getRng(),b=this.getSel();return!a||a.item?!1:a.compareEndPoints?0===a.compareEndPoints("StartToEnd",a):!b||a.collapsed},collapse:function(a){var b=
this.getRng(),c;b.item&&(c=b.item(0),b=this.win.document.body.createTextRange(),b.moveToElementText(c));b.collapse(!!a);this.setRng(b)},getSel:function(){var a=this.win;return a.getSelection?a.getSelection():a.document.selection},getRng:function(a){var b,c,d=this.win.document;if(a&&this.tridentSel)return this.tridentSel.getRangeAt(0);try{if(b=this.getSel())c=0<b.rangeCount?b.getRangeAt(0):b.createRange?b.createRange():d.createRange()}catch(l){}f.isIE&&c&&c.setStart&&d.selection.createRange().item&&
(a=d.selection.createRange().item(0),c=d.createRange(),c.setStartBefore(a),c.setEndAfter(a));c||(c=d.createRange?d.createRange():d.body.createTextRange());!f.isIE&&c.setStart&&9===c.startContainer.nodeType&&c.collapsed&&(a=this.dom.getRoot(),c.setStart(a,0),c.setEnd(a,0));this.selectedRange&&this.explicitRange&&(0===c.compareBoundaryPoints(c.START_TO_START,this.selectedRange)&&0===c.compareBoundaryPoints(c.END_TO_END,this.selectedRange)?c=this.explicitRange:this.explicitRange=this.selectedRange=null);
return c},setRng:function(a,b){var c;if(this.tridentSel){if(a.cloneRange)try{this.tridentSel.addRange(a);return}catch(d){}try{a.select()}catch(f){}}else if(c=this.getSel()){this.explicitRange=a;try{c.removeAllRanges()}catch(m){}c.addRange(a);!1===b&&c.extend&&(c.collapse(a.endContainer,a.endOffset),c.extend(a.startContainer,a.startOffset));this.selectedRange=0<c.rangeCount?c.getRangeAt(0):null}},setNode:function(a){this.setContent(this.dom.getOuterHTML(a));return a},getNode:function(){function a(b,
c){for(var d=b;b&&3===b.nodeType&&0===b.length;)b=c?b.nextSibling:b.previousSibling;return b||d}var b=this.getRng();this.getSel();var c,d=b.startContainer,f=b.endContainer;return!b?this.dom.getRoot():b.setStart?(c=b.commonAncestorContainer,!b.collapsed&&(b.startContainer==b.endContainer&&2>b.endOffset-b.startOffset&&b.startContainer.hasChildNodes()&&(c=b.startContainer.childNodes[b.startOffset]),3===d.nodeType&&3===f.nodeType&&(d=d.length===b.startOffset?a(d.nextSibling,!0):d.parentNode,f=0===b.endOffset?
a(f.previousSibling,!1):f.parentNode,d&&d===f))?d:c&&3==c.nodeType?c.parentNode:c):b.item?b.item(0):b.parentElement()},getSelectedBlocks:function(a,b){var c=this.dom,f,l,m,n=[];f=c.getParent(a||this.getStart(),c.isBlock);l=c.getParent(b||this.getEnd(),c.isBlock);f&&n.push(f);if(f&&l&&f!=l){m=f;for(var o=new d(f,c.getRoot());(m=o.next())&&m!=l;)c.isBlock(m)&&n.push(m)}l&&f!=l&&n.push(l);return n},isForward:function(){var a=this.dom,b=this.getSel(),c;if(!b||null==b.anchorNode||null==b.focusNode)return!0;
c=a.createRng();c.setStart(b.anchorNode,b.anchorOffset);c.collapse(!0);a=a.createRng();a.setStart(b.focusNode,b.focusOffset);a.collapse(!0);return 0>=c.compareBoundaryPoints(c.START_TO_START,a)},normalize:function(){function a(e){function f(a,b){for(var c=new d(a,t.getParent(a.parentNode,t.isBlock)||r);a=c[b?"prev":"next"]();)if("BR"===a.nodeName)return!0}function o(a,b){var c,e,b=b||p;for(c=new d(b,t.getParent(b.parentNode,t.isBlock)||r);u=c[a?"prev":"next"]();){if(3===u.nodeType&&0<u.nodeValue.length){p=
u;q=a?u.nodeValue.length:0;k=!0;return}if(t.isBlock(u)||D[u.nodeName.toLowerCase()])return;e=u}l&&e&&(p=e,k=!0,q=0)}var p,q,s,t=b.dom,r=t.getRoot(),u,D;p=c[(e?"start":"end")+"Container"];q=c[(e?"start":"end")+"Offset"];D=t.schema.getNonEmptyElements();9===p.nodeType&&(p=t.getRoot(),q=0);if(p===r){if(e&&(u=p.childNodes[0<q?q-1:0]))if(u.nodeName.toLowerCase(),D[u.nodeName]||"TABLE"==u.nodeName)return;if(p.hasChildNodes()&&(p=p.childNodes[Math.min(!e&&0<q?q-1:q,p.childNodes.length-1)],q=0,p.hasChildNodes()&&
!/TABLE/.test(p.nodeName))){u=p;s=new d(p,r);do{if(3===u.nodeType&&0<u.nodeValue.length){q=e?0:u.nodeValue.length;p=u;k=!0;break}if(D[u.nodeName.toLowerCase()]){q=t.nodeIndex(u);p=u.parentNode;"IMG"==u.nodeName&&!e&&q++;k=!0;break}}while(u=e?s.next():s.prev())}}l&&(3===p.nodeType&&0===q&&o(!0),1===p.nodeType&&(u=p.childNodes[q])&&"BR"===u.nodeName&&!f(u)&&!f(u,!0)&&o(!0,p.childNodes[q]));e&&!l&&3===p.nodeType&&q===p.nodeValue.length&&o(!1);if(k)c["set"+(e?"Start":"End")](p,q)}var b=this,c,k,l;f.isIE||
(c=b.getRng(),l=c.collapsed,a(!0),l||a(),k&&(l&&c.collapse(!0),b.setRng(c,b.isForward())))},selectorChanged:function(a,c){var d=this,f;d.selectorChangedData||(d.selectorChangedData={},f={},d.editor.onNodeChange.addToTop(function(a,c,e){var g=d.dom,p=g.getParents(e,null,g.getRoot()),q={};b(d.selectorChangedData,function(a,c){b(p,function(d){if(g.is(d,c))return f[c]||(b(a,function(a){a(!0,{node:d,selector:c,parents:p})}),f[c]=a),q[c]=a,!1})});b(f,function(a,c){q[c]||(delete f[c],b(a,function(a){a(!1,
{node:e,selector:c,parents:p})}))})}));d.selectorChangedData[a]||(d.selectorChangedData[a]=[]);d.selectorChangedData[a].push(c);return d},destroy:function(a){this.win=null;a||f.removeUnload(this.destroy)},_fixIESelection:function(){function a(b,c){var d=m.createTextRange();try{d.moveToPoint(b,c)}catch(e){d=null}return d}function b(d){if(d.button){if(d=a(d.x,d.y))0<d.compareEndPoints("StartToStart",o)?d.setEndPoint("StartToStart",o):d.setEndPoint("EndToEnd",o),d.select()}else c()}function c(){var a=
f.selection.createRange();o&&!a.item&&0===a.compareEndPoints("StartToEnd",a)&&o.select();d.unbind(f,"mouseup",c);d.unbind(f,"mousemove",b);o=n=0}var d=this.dom,f=d.doc,m=f.body,n,o,p;f.documentElement.unselectable=!0;d.bind(f,["mousedown","contextmenu"],function(m){if("HTML"===m.target.nodeName&&(n&&c(),p=f.documentElement,!(p.scrollHeight>p.clientHeight)&&(n=1,o=a(m.x,m.y))))d.bind(f,"mouseup",c),d.bind(f,"mousemove",b),d.win.focus(),o.select()})}})})(tinymce);
(function(f){f.dom.Serializer=function(c,a,b){var d,e,g=f.isIE,h=f.each,k;c.apply_source_formatting||(c.indent=!1);a=a||f.DOM;b=b||new f.html.Schema(c);c.entity_encoding=c.entity_encoding||"named";c.remove_trailing_brs="remove_trailing_brs"in c?c.remove_trailing_brs:!0;d=new f.util.Dispatcher(self);e=new f.util.Dispatcher(self);k=new f.html.DomParser(c,b);k.addAttributeFilter("src,href,style",function(b,d){for(var e=b.length,g,h,f="data-mce-"+d,k=c.url_converter,t=c.url_converter_scope;e--;){g=b[e];
h=g.attributes.map[f];if(h!==void 0){g.attr(d,h.length>0?h:null);g.attr(f,null)}else{h=g.attributes.map[d];d==="style"?h=a.serializeStyle(a.parseStyle(h),g.name):k&&(h=k.call(t,h,d,g.name));g.attr(d,h.length>0?h:null)}}});k.addAttributeFilter("class",function(a){for(var b=a.length,c,d;b--;){c=a[b];d=c.attr("class").replace(/(?:^|\s)mce(Item\w+|Selected)(?!\S)/g,"");c.attr("class",d.length>0?d:null)}});k.addAttributeFilter("data-mce-type",function(a,b,c){for(var b=a.length,d;b--;){d=a[b];d.attributes.map["data-mce-type"]===
"bookmark"&&!c.cleanup&&d.remove()}});k.addAttributeFilter("data-mce-expando",function(a,b){for(var c=a.length;c--;)a[c].attr(b,null)});k.addNodeFilter("script,style",function(a,b){function c(a){return a.replace(/(<\!--\[CDATA\[|\]\]--\>)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<\!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<\!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<\!--|\/\*\s*<\!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(--\>)?|\s*\/\/\s*\]\]>(--\>)?|\/\/\s*(--\>)?|\]\]>|\/\*\s*--\>\s*\*\/|\s*--\>\s*)\s*$/g,
"")}for(var d=a.length,e,g;d--;){e=a[d];g=e.firstChild?e.firstChild.value:"";if(b==="script"){e.attr("type",(e.attr("type")||"text/javascript").replace(/^mce\-/,""));if(g.length>0)e.firstChild.value="// <![CDATA[\n"+c(g)+"\n// ]]\>"}else if(g.length>0)e.firstChild.value="<\!--\n"+c(g)+"\n--\>"}});k.addNodeFilter("#comment",function(a){for(var b=a.length,c;b--;){c=a[b];if(c.value.indexOf("[CDATA[")===0){c.name="#cdata";c.type=4;c.value=c.value.replace(/^\[CDATA\[|\]\]$/g,"")}else if(c.value.indexOf("mce:protected ")===
0){c.name="#text";c.type=3;c.raw=true;c.value=unescape(c.value).substr(14)}}});k.addNodeFilter("xml:namespace,input",function(a,b){for(var c=a.length,d;c--;){d=a[c];d.type===7?d.remove():d.type===1&&b==="input"&&!("type"in d.attributes.map)&&d.attr("type","text")}});c.fix_list_elements&&k.addNodeFilter("ul,ol",function(a){for(var b=a.length,c,d;b--;){c=a[b];d=c.parent;(d.name==="ul"||d.name==="ol")&&c.prev&&c.prev.name==="li"&&c.prev.append(c)}});k.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style",
function(a,b){for(var c=a.length;c--;)a[c].attr(b,null)});return{schema:b,addNodeFilter:k.addNodeFilter,addAttributeFilter:k.addAttributeFilter,onPreProcess:d,onPostProcess:e,serialize:function(l,m){var n,o,p;if(g&&a.select("script,style,select,map").length>0){n=l.innerHTML;l=l.cloneNode(false);a.setHTML(l,n)}else l=l.cloneNode(true);n=l.ownerDocument.implementation;if(n.createHTMLDocument){o=n.createHTMLDocument("");h(l.nodeName=="BODY"?l.childNodes:[l],function(a){o.body.appendChild(o.importNode(a,
true))});l=l.nodeName!="BODY"?o.body.firstChild:o.body;p=a.doc;a.doc=o}m=m||{};m.format=m.format||"html";if(!m.no_events){m.node=l;d.dispatch(self,m)}n=new f.html.Serializer(c,b);m.content=n.serialize(k.parse(f.trim(m.getInner?l.innerHTML:a.getOuterHTML(l)),m));if(!m.cleanup)m.content=m.content.replace(/\uFEFF|\u200B/g,"");m.no_events||e.dispatch(self,m);if(p)a.doc=p;m.node=null;return m.content},addRules:function(a){b.addValidElements(a)},setRules:function(a){b.setValidElements(a)}}}})(tinymce);
(function(f){f.dom.ScriptLoader=function(){function c(a,b){function c(){e.remove(s);g&&(g.onreadystatechange=g.onload=g=null);b()}function d(){"undefined"!==typeof console&&console.log&&console.log("Failed to load: "+a)}var e=f.DOM,g,p,q,s;s=e.uniqueId();if(f.isIE6&&(p=new f.util.URI(a),q=location,p.host==q.hostname&&p.port==q.port&&p.protocol+":"==q.protocol&&"file"!=p.protocol.toLowerCase())){f.util.XHR.send({url:f._addVer(p.getURI()),success:function(a){var b=e.create("script",{type:"text/javascript"});
b.text=a;document.getElementsByTagName("head")[0].appendChild(b);e.remove(b);c()},error:d});return}g=document.createElement("script");g.id=s;g.type="text/javascript";g.src=f._addVer(a);f.isIE||(g.onload=c);g.onerror=d;f.isOpera||(g.onreadystatechange=function(){var a=g.readyState;(a=="complete"||a=="loaded")&&c()});(document.getElementsByTagName("head")[0]||document.body).appendChild(g)}var a={},b=[],d={},e=[],g=0;this.isDone=function(b){return 2==a[b]};this.markDone=function(b){a[b]=2};this.add=
this.load=function(c,e,g){void 0==a[c]&&(b.push(c),a[c]=0);e&&(d[c]||(d[c]=[]),d[c].push({func:e,scope:g||this}))};this.loadQueue=function(a,c){this.loadScripts(b,a,c)};this.loadScripts=function(b,k,l){function m(a){f.each(d[a],function(a){a.func.call(a.scope)});d[a]=void 0}var n;e.push({func:k,scope:l||this,executing:!1});n=function(){var d=f.grep(b);b.length=0;f.each(d,function(b){2==a[b]?m(b):1!=a[b]&&(a[b]=1,g++,c(b,function(){a[b]=2;g--;m(b);n()}))});g||(f.each(e,function(a){a.executing||(a.executing=
!0,a.func.call(a.scope))}),e.length=0)};n()}};f.ScriptLoader=new f.dom.ScriptLoader})(tinymce);
(function(f){f.dom.RangeUtils=function(c){this.walk=function(a,b){function d(a){var b;b=a[0];3===b.nodeType&&b===k&&l>=b.nodeValue.length&&a.splice(0,1);b=a[a.length-1];0===n&&0<a.length&&b===m&&3===b.nodeType&&a.splice(a.length-1,1);return a}function e(a,b,c){for(var d=[];a&&a!=c;a=a[b])d.push(a);return d}function g(a,b){do{if(a.parentNode==b)return a;a=a.parentNode}while(a)}function h(a,c,g){var h=g?"nextSibling":"previousSibling";q=a;for(s=q.parentNode;q&&q!=c;q=s)s=q.parentNode,t=e(q==a?q:q[h],
h),t.length&&(g||t.reverse(),b(d(t)))}var k=a.startContainer,l=a.startOffset,m=a.endContainer,n=a.endOffset,o,p,q,s,t;p=c.select("td.mceSelected,th.mceSelected");if(0<p.length)f.each(p,function(a){b([a])});else{1==k.nodeType&&k.hasChildNodes()&&(k=k.childNodes[l]);1==m.nodeType&&m.hasChildNodes()&&(m=m.childNodes[Math.min(n-1,m.childNodes.length-1)]);if(k==m)return b(d([k]));o=c.findCommonAncestor(k,m);for(q=k;q;q=q.parentNode){if(q===m)return h(k,o,!0);if(q===o)break}for(q=m;q;q=q.parentNode){if(q===
k)return h(m,o);if(q===o)break}p=g(k,o)||k;o=g(m,o)||m;h(k,p,!0);t=e(p==k?p:p.nextSibling,"nextSibling",o==m?o.nextSibling:o);t.length&&b(d(t));h(m,o)}};this.split=function(a){var b=a.startContainer,c=a.startOffset,e=a.endContainer,a=a.endOffset;if(b==e&&3==b.nodeType)0<c&&c<b.nodeValue.length&&(e=b.splitText(c),b=e.previousSibling,a>c?(b=e=e.splitText(a-c).previousSibling,a=e.nodeValue.length,c=0):a=0);else if(3==b.nodeType&&0<c&&c<b.nodeValue.length&&(b=b.splitText(c),c=0),3==e.nodeType&&0<a&&a<
e.nodeValue.length)e=e.splitText(a).previousSibling,a=e.nodeValue.length;return{startContainer:b,startOffset:c,endContainer:e,endOffset:a}}};f.dom.RangeUtils.compareRanges=function(c,a){if(c&&a)if(c.item||c.duplicate){if(c.item&&a.item&&c.item(0)===a.item(0)||c.isEqual&&a.isEqual&&a.isEqual(c))return!0}else return c.startContainer==a.startContainer&&c.startOffset==a.startOffset;return!1}})(tinymce);
(function(f){var c=f.dom.Event,a=f.each;f.create("tinymce.ui.KeyboardNavigation",{KeyboardNavigation:function(b,d){var e=this,g=b.root,h=b.items,k=b.enableUpDown,l=b.enableLeftRight||!b.enableUpDown,m=b.excludeFromTabOrder,n,o,p,q,s,d=d||f.DOM;n=function(a){s=a.target.id};o=function(a){d.setAttrib(a.target.id,"tabindex","-1")};q=function(){var a=d.get(s);d.setAttrib(a,"tabindex","0");a.focus()};e.focus=function(){d.get(s).focus()};e.destroy=function(){a(h,function(a){a=d.get(a.id);d.unbind(a,"focus",
n);d.unbind(a,"blur",o)});var b=d.get(g);d.unbind(b,"focus",q);d.unbind(b,"keydown",p);h=d=g=e.focus=n=o=p=q=null;e.destroy=function(){}};e.moveFocus=function(e,g){var f=-1,k;if(s){a(h,function(a,b){if(a.id===s)return f=b,!1});f+=e;0>f?f=h.length-1:f>=h.length&&(f=0);k=h[f];d.setAttrib(s,"tabindex","-1");d.setAttrib(k.id,"tabindex","0");d.get(k.id).focus();if(b.actOnFocus)b.onAction(k.id);g&&c.cancel(g)}};p=function(a){switch(a.keyCode){case 37:l&&e.moveFocus(-1);break;case 39:l&&e.moveFocus(1);break;
case 38:k&&e.moveFocus(-1);break;case 40:k&&e.moveFocus(1);break;case 27:b.onCancel&&(b.onCancel(),c.cancel(a));break;case 14:case 13:case 32:b.onAction&&(b.onAction(s),c.cancel(a))}};a(h,function(a,b){var c,e;a.id||(a.id=d.uniqueId("_mce_item_"));e=d.get(a.id);m?(d.bind(e,"blur",o),c="-1"):c=0===b?"0":"-1";e.setAttribute("tabindex",c);d.bind(e,"focus",n)});h[0]&&(s=h[0].id);d.setAttrib(g,"tabindex","-1");var t=d.get(g);d.bind(t,"focus",q);d.bind(t,"keydown",p)}})})(tinymce);
(function(f){var c=f.DOM,a=f.is;f.create("tinymce.ui.Control",{Control:function(a,c,e){this.id=a;this.settings=c=c||{};this.rendered=!1;this.onRender=new f.util.Dispatcher(this);this.classPrefix="";this.scope=c.scope||this;this.active=this.disabled=0;this.editor=e},setAriaProperty:function(a,d){var e=c.get(this.id+"_aria")||c.get(this.id);e&&c.setAttrib(e,"aria-"+a,!!d)},focus:function(){c.get(this.id).focus()},setDisabled:function(a){a!=this.disabled&&(this.setAriaProperty("disabled",a),this.setState("Disabled",
a),this.setState("Enabled",!a),this.disabled=a)},isDisabled:function(){return this.disabled},setActive:function(a){a!=this.active&&(this.setState("Active",a),this.active=a,this.setAriaProperty("pressed",a))},isActive:function(){return this.active},setState:function(a,d){var e=c.get(this.id),a=this.classPrefix+a;d?c.addClass(e,a):c.removeClass(e,a)},isRendered:function(){return this.rendered},renderHTML:function(){},renderTo:function(a){c.setHTML(a,this.renderHTML())},postRender:function(){var b;a(this.disabled)&&
(b=this.disabled,this.disabled=-1,this.setDisabled(b));a(this.active)&&(b=this.active,this.active=-1,this.setActive(b))},remove:function(){c.remove(this.id);this.destroy()},destroy:function(){f.dom.Event.clear(this.id)}})})(tinymce);tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{Container:function(f,c,a){this.parent(f,c,a);this.controls=[];this.lookup={}},add:function(f){this.lookup[f.id]=f;this.controls.push(f);return f},get:function(f){return this.lookup[f]}});
tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{Separator:function(f,c){this.parent(f,c);this.classPrefix="mceSeparator";this.setDisabled(!0)},renderHTML:function(){return tinymce.DOM.createHTML("span",{"class":this.classPrefix,role:"separator","aria-orientation":"vertical",tabindex:"-1"})}});
(function(f){var c=f.is;f.create("tinymce.ui.MenuItem:tinymce.ui.Control",{MenuItem:function(a,b){this.parent(a,b);this.classPrefix="mceMenuItem"},setSelected:function(a){this.setState("Selected",a);this.setAriaProperty("checked",!!a);this.selected=a},isSelected:function(){return this.selected},postRender:function(){this.parent();c(this.selected)&&this.setSelected(this.selected)}})})(tinymce);
(function(f){var c=f.DOM,a=f.walk;f.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{Menu:function(a,c){this.parent(a,c);this.items={};this.collapsed=!1;this.menuCount=0;this.onAddItem=new f.util.Dispatcher(this)},expand:function(b){b&&a(this,function(a){a.expand&&a.expand()},"items",this);this.collapsed=!1},collapse:function(b){b&&a(this,function(a){a.collapse&&a.collapse()},"items",this);this.collapsed=!0},isCollapsed:function(){return this.collapsed},add:function(a){a.settings||(a=new f.ui.MenuItem(a.id||
c.uniqueId(),a));this.onAddItem.dispatch(this,a);return this.items[a.id]=a},addSeparator:function(){return this.add({separator:!0})},addMenu:function(a){a.collapse||(a=this.createMenu(a));this.menuCount++;return this.add(a)},hasMenus:function(){return 0!==this.menuCount},remove:function(a){delete this.items[a.id]},removeAll:function(){a(this,function(a){a.removeAll?a.removeAll():a.remove();a.destroy()},"items",this);this.items={}},createMenu:function(a){a=new f.ui.Menu(a.id||c.uniqueId(),a);a.onAddItem.add(this.onAddItem.dispatch,
this.onAddItem);return a}})})(tinymce);
(function(f){var c=f.is,a=f.DOM,b=f.each,d=f.dom.Event,e=f.dom.Element;f.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{DropMenu:function(b,d){d=d||{};d.container=d.container||a.doc.body;d.offset_x=d.offset_x||0;d.offset_y=d.offset_y||0;d.vp_offset_x=d.vp_offset_x||0;d.vp_offset_y=d.vp_offset_y||0;c(d.icons)&&!d.icons&&(d["class"]+=" mceNoIcons");this.parent(b,d);this.onShowMenu=new f.util.Dispatcher(this);this.onHideMenu=new f.util.Dispatcher(this);this.classPrefix="mceMenu"},createMenu:function(b){var c=
this.settings;b.container=b.container||c.container;b.parent=this;b.constrain=b.constrain||c.constrain;b["class"]=b["class"]||c["class"];b.vp_offset_x=b.vp_offset_x||c.vp_offset_x;b.vp_offset_y=b.vp_offset_y||c.vp_offset_y;b.keyboard_focus=c.keyboard_focus;b=new f.ui.DropMenu(b.id||a.uniqueId(),b);b.onAddItem.add(this.onAddItem.dispatch,this.onAddItem);return b},focus:function(){this.keyboardNav&&this.keyboardNav.focus()},update:function(){var b=this.settings,c=a.get("menu_"+this.id+"_tbl"),d=a.get("menu_"+
this.id+"_co"),e,f;e=b.max_width?Math.min(c.offsetWidth,b.max_width):c.offsetWidth;f=b.max_height?Math.min(c.offsetHeight,b.max_height):c.offsetHeight;a.boxModel?this.element.setStyles({width:e,height:f}):this.element.setStyles({width:e+2,height:f+2});b.max_width&&a.setStyle(d,"width",e);b.max_height&&(a.setStyle(d,"height",f),c.clientHeight<b.max_height&&a.setStyle(d,"overflow","hidden"))},showMenu:function(c,h,k){var l=this,m=l.settings,n,o=a.getViewPort(),p,q,s,t,r=l.classPrefix;l.collapse(1);
l.isMenuVisible||(l.rendered?n=a.get("menu_"+l.id):(n=a.add(l.settings.container,l.renderNode()),b(l.items,function(a){a.postRender()}),l.element=new e("menu_"+l.id,{blocker:1,container:m.container})),f.isOpera||a.setStyles(n,{left:-65535,top:-65535}),a.show(n),l.update(),c+=m.offset_x||0,h+=m.offset_y||0,o.w-=4,o.h-=4,m.constrain&&(p=n.clientWidth-2,q=n.clientHeight-2,s=o.x+o.w,o=o.y+o.h,c+m.vp_offset_x+p>s&&(c=k?k-p:Math.max(0,s-m.vp_offset_x-p)),h+m.vp_offset_y+q>o&&(h=Math.max(0,o-m.vp_offset_y-
q))),a.setStyles(n,{left:c,top:h}),l.element.update(),l.isMenuVisible=1,l.mouseClickFunc=d.add(n,"click",function(b){var c;if((b=b.target)&&(b=a.getParent(b,"tr"))&&!a.hasClass(b,r+"ItemSub")){c=l.items[b.id];if(!c.isDisabled()){for(t=l;t;){t.hideMenu&&t.hideMenu();t=t.settings.parent}if(c.settings.onclick)c.settings.onclick(b);return false}}}),l.hasMenus()&&(l.mouseOverFunc=d.add(n,"mouseover",function(b){var c;if((b=b.target)&&(b=a.getParent(b,"tr"))){c=l.items[b.id];l.lastMenu&&l.lastMenu.collapse(1);
if(!c.isDisabled()&&b&&a.hasClass(b,r+"ItemSub")){b=a.getRect(b);c.showMenu(b.x+b.w-2,b.y-2,b.x);l.lastMenu=c;a.addClass(a.get(c.id).firstChild,r+"ItemActive")}}})),d.add(n,"keydown",l._keyHandler,l),l.onShowMenu.dispatch(l),m.keyboard_focus&&l._setupKeyboardNav())},hideMenu:function(b){var c=a.get("menu_"+this.id),e;this.isMenuVisible&&(this.keyboardNav&&this.keyboardNav.destroy(),d.remove(c,"mouseover",this.mouseOverFunc),d.remove(c,"click",this.mouseClickFunc),d.remove(c,"keydown",this._keyHandler),
a.hide(c),this.isMenuVisible=0,b||this.collapse(1),this.element&&this.element.hide(),(e=a.get(this.id))&&a.removeClass(e.firstChild,this.classPrefix+"ItemActive"),this.onHideMenu.dispatch(this))},add:function(b){var c,b=this.parent(b);this.isRendered&&(c=a.get("menu_"+this.id))&&this._add(a.select("tbody",c)[0],b);return b},collapse:function(a){this.parent(a);this.hideMenu(1)},remove:function(b){a.remove(b.id);this.destroy();return this.parent(b)},destroy:function(){var b=a.get("menu_"+this.id);this.keyboardNav&&
this.keyboardNav.destroy();d.remove(b,"mouseover",this.mouseOverFunc);d.remove(a.select("a",b),"focus",this.mouseOverFunc);d.remove(b,"click",this.mouseClickFunc);d.remove(b,"keydown",this._keyHandler);this.element&&this.element.remove();a.remove(b)},renderNode:function(){var c=this,d=c.settings,f,l,m;m=a.create("div",{role:"listbox",id:"menu_"+c.id,"class":d["class"],style:"position:absolute;left:0;top:0;z-index:200000;outline:0"});c.settings.parent&&a.setAttrib(m,"aria-parent","menu_"+c.settings.parent.id);
l=a.add(m,"div",{role:"presentation",id:"menu_"+c.id+"_co","class":c.classPrefix+(d["class"]?" "+d["class"]:"")});c.element=new e("menu_"+c.id,{blocker:1,container:d.container});d.menu_line&&a.add(l,"span",{"class":c.classPrefix+"Line"});d=a.add(l,"table",{role:"presentation",id:"menu_"+c.id+"_tbl",border:0,cellPadding:0,cellSpacing:0});f=a.add(d,"tbody");b(c.items,function(a){c._add(f,a)});c.rendered=!0;return m},_setupKeyboardNav:function(){var b,c,d=this;b=a.get("menu_"+d.id);c=a.select("a[role=option]",
"menu_"+d.id);c.splice(0,0,b);d.keyboardNav=new f.ui.KeyboardNavigation({root:"menu_"+d.id,items:c,onCancel:function(){d.hideMenu()},enableUpDown:!0});b.focus()},_keyHandler:function(a){switch(a.keyCode){case 37:this.settings.parent&&(this.hideMenu(),this.settings.parent.focus(),d.cancel(a));break;case 39:this.mouseOverFunc&&this.mouseOverFunc(a);break;case 38:case 40:f.dom.Event.cancel(a)}},_add:function(b,c){var d,e=c.settings,f,n,o,p=this.classPrefix;e.separator?(n=a.add(b,"tr",{id:c.id,"class":p+
"ItemSeparator"}),a.add(n,"td",{"class":p+"ItemSeparator"}),(d=n.previousSibling)&&a.addClass(d,"mceLast")):(d=n=a.add(b,"tr",{id:c.id,"class":p+"Item "+p+"ItemEnabled"}),d=o=a.add(d,e.titleItem?"th":"td"),d=f=a.add(d,"a",{id:c.id+"_aria",role:e.titleItem?"presentation":"option",href:"javascript:;",onclick:"return false;",onmousedown:"return false;"}),e.parent&&(a.setAttrib(f,"aria-haspopup","true"),a.setAttrib(f,"aria-owns","menu_"+c.id)),a.addClass(o,e["class"]),f=a.add(d,"span",{"class":"mceIcon"+
(e.icon?" mce_"+e.icon:"")}),e.icon_src&&a.add(f,"img",{src:e.icon_src}),d=a.add(d,e.element||"span",{"class":"mceText",title:c.settings.title},c.settings.title),c.settings.style&&("function"==typeof c.settings.style&&(c.settings.style=c.settings.style()),a.setAttrib(d,"style",c.settings.style)),1==b.childNodes.length&&a.addClass(n,"mceFirst"),(d=n.previousSibling)&&a.hasClass(d,p+"ItemSeparator")&&a.addClass(n,"mceFirst"),c.collapse&&a.addClass(n,p+"ItemSub"),(d=n.previousSibling)&&a.removeClass(d,
"mceLast"),a.addClass(n,"mceLast"))}})})(tinymce);
(function(f){var c=f.DOM;f.create("tinymce.ui.Button:tinymce.ui.Control",{Button:function(a,b,c){this.parent(a,b,c);this.classPrefix="mceButton"},renderHTML:function(){var a=this.classPrefix,b=this.settings,d,e;e=c.encode(b.label||"");d='<a role="button" id="'+this.id+'" href="javascript:;" class="'+a+" "+a+"Enabled "+b["class"]+(e?" "+a+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" aria-labelledby="'+this.id+'_voice" title="'+c.encode(b.title)+'">';d=b.image&&(!this.editor||
!this.editor.forcedHighContrastMode)?d+('<img class="mceIcon" src="'+b.image+'" alt="'+c.encode(b.title)+'" />'+e):d+('<span class="mceIcon '+b["class"]+'"></span>'+(e?'<span class="'+a+'Label">'+e+"</span>":""));d+='<span class="mceVoiceLabel mceIconOnly" style="display: none;" id="'+this.id+'_voice">'+b.title+"</span>";return d+"</a>"},postRender:function(){var a=this,b=a.settings,c;f.isIE&&a.editor&&f.dom.Event.add(a.id,"mousedown",function(){c="IMG"===a.editor.selection.getNode().nodeName?a.editor.selection.getBookmark():
null});f.dom.Event.add(a.id,"click",function(e){if(!a.isDisabled())return f.isIE&&a.editor&&null!==c&&a.editor.selection.moveToBookmark(c),b.onclick.call(b.scope,e)});f.dom.Event.add(a.id,"keyup",function(c){if(!a.isDisabled()&&c.keyCode==f.VK.SPACEBAR)return b.onclick.call(b.scope,c)})}})})(tinymce);
(function(f){var c=f.DOM,a=f.dom.Event,b=f.each,d=f.util.Dispatcher;f.create("tinymce.ui.ListBox:tinymce.ui.Control",{ListBox:function(a,b,c){this.parent(a,b,c);this.items=[];this.onChange=new d(this);this.onPostRender=new d(this);this.onAdd=new d(this);this.onRenderMenu=new f.util.Dispatcher(this);this.classPrefix="mceListBox";this.marked={}},select:function(a){var c=this,d,f;c.marked={};if(void 0==a)return c.selectByIndex(-1);f=a&&"function"==typeof a?a:function(b){return b==a};a!=c.selectedValue&&
(b(c.items,function(a,b){if(f(a.value))return d=1,c.selectByIndex(b),!1}),d||c.selectByIndex(-1))},selectByIndex:function(a){var b,d,f;this.marked={};a!=this.selectedIndex&&(b=c.get(this.id+"_text"),f=c.get(this.id+"_voiceDesc"),(d=this.items[a])?(this.selectedValue=d.value,this.selectedIndex=a,c.setHTML(b,c.encode(d.title)),c.setHTML(f,this.settings.title+" - "+d.title),c.removeClass(b,"mceTitle"),c.setAttrib(this.id,"aria-valuenow",d.title)):(c.setHTML(b,c.encode(this.settings.title)),c.setHTML(f,
c.encode(this.settings.title)),c.addClass(b,"mceTitle"),this.selectedValue=this.selectedIndex=null,c.setAttrib(this.id,"aria-valuenow",this.settings.title)))},mark:function(a){this.marked[a]=!0},add:function(a,b,c){c=c||{};c=f.extend(c,{title:a,value:b});this.items.push(c);this.onAdd.dispatch(this,c)},getLength:function(){return this.items.length},renderHTML:function(){var a="",a=this.settings,b=this.classPrefix,a='<span role="listbox" aria-haspopup="true" aria-labelledby="'+this.id+'_voiceDesc" aria-describedby="'+
this.id+'_voiceDesc"><table role="presentation" tabindex="0" id="'+this.id+'" cellpadding="0" cellspacing="0" class="'+b+" "+b+"Enabled"+(a["class"]?" "+a["class"]:"")+'"><tbody><tr>',a=a+("<td>"+c.createHTML("span",{id:this.id+"_voiceDesc","class":"voiceLabel",style:"display:none;"},this.settings.title)),a=a+(c.createHTML("a",{id:this.id+"_text",tabindex:-1,href:"javascript:;","class":"mceText",onclick:"return false;",onmousedown:"return false;"},c.encode(this.settings.title))+"</td>"),a=a+("<td>"+
c.createHTML("a",{id:this.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"},'<span><span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25bc</span></span>')+"</td>");return a+"</tr></tbody></table></span>"},showMenu:function(){var d=this,g,h=c.get(this.id),k;if(!(d.isDisabled()||0===d.items.length)){if(d.menu&&d.menu.isMenuVisible)return d.hideMenu();d.isMenuRendered||(d.renderMenu(),d.isMenuRendered=!0);g=c.getPos(h);
k=d.menu;k.settings.offset_x=g.x;k.settings.offset_y=g.y;k.settings.keyboard_focus=!f.isOpera;b(d.items,function(a){k.items[a.id]&&k.items[a.id].setSelected(0)});b(d.items,function(a){k.items[a.id]&&d.marked[a.value]&&k.items[a.id].setSelected(1);a.value===d.selectedValue&&k.items[a.id].setSelected(1)});k.showMenu(0,h.clientHeight);a.add(c.doc,"mousedown",d.hideMenu,d);c.addClass(d.id,d.classPrefix+"Selected")}},hideMenu:function(b){if(this.menu&&this.menu.isMenuVisible&&(c.removeClass(this.id,this.classPrefix+
"Selected"),!b||!("mousedown"==b.type&&(b.target.id==this.id+"_text"||b.target.id==this.id+"_open"))))if(!b||!c.getParent(b.target,".mceMenu"))c.removeClass(this.id,this.classPrefix+"Selected"),a.remove(c.doc,"mousedown",this.hideMenu,this),this.menu.hideMenu()},renderMenu:function(){var a=this,d;d=a.settings.control_manager.createDropMenu(a.id+"_menu",{menu_line:1,"class":a.classPrefix+"Menu mceNoIcons",max_width:250,max_height:150});d.onHideMenu.add(function(){a.hideMenu();a.focus()});d.add({title:a.settings.title,
"class":"mceMenuItemTitle",onclick:function(){!1!==a.settings.onselect("")&&a.select("")}});b(a.items,function(b){void 0===b.value?d.add({title:b.title,role:"option","class":"mceMenuItemTitle",onclick:function(){!1!==a.settings.onselect("")&&a.select("")}}):(b.id=c.uniqueId(),b.role="option",b.onclick=function(){!1!==a.settings.onselect(b.value)&&a.select(b.value)},d.add(b))});a.onRenderMenu.dispatch(a,d);a.menu=d},postRender:function(){var b=this,d=b.classPrefix;a.add(b.id,"click",b.showMenu,b);
a.add(b.id,"keydown",function(c){32==c.keyCode&&(b.showMenu(c),a.cancel(c))});a.add(b.id,"focus",function(){b._focused||(b.keyDownHandler=a.add(b.id,"keydown",function(c){40==c.keyCode&&(b.showMenu(),a.cancel(c))}),b.keyPressHandler=a.add(b.id,"keypress",function(c){var d;13==c.keyCode&&(d=b.selectedValue,b.selectedValue=null,a.cancel(c),b.settings.onselect(d))}));b._focused=1});a.add(b.id,"blur",function(){a.remove(b.id,"keydown",b.keyDownHandler);a.remove(b.id,"keypress",b.keyPressHandler);b._focused=
0});if(f.isIE6||!c.boxModel)a.add(b.id,"mouseover",function(){c.hasClass(b.id,d+"Disabled")||c.addClass(b.id,d+"Hover")}),a.add(b.id,"mouseout",function(){c.hasClass(b.id,d+"Disabled")||c.removeClass(b.id,d+"Hover")});b.onPostRender.dispatch(b,c.get(b.id))},destroy:function(){this.parent();a.clear(this.id+"_text");a.clear(this.id+"_open")}})})(tinymce);
(function(f){var c=f.DOM,a=f.dom.Event,b=f.each;f.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{NativeListBox:function(a,b){this.parent(a,b);this.classPrefix="mceNativeListBox"},setDisabled:function(a){c.get(this.id).disabled=a;this.setAriaProperty("disabled",a)},isDisabled:function(){return c.get(this.id).disabled},select:function(a){var c=this,g,f;if(void 0==a)return c.selectByIndex(-1);f=a&&"function"==typeof a?a:function(b){return b==a};a!=c.selectedValue&&(b(c.items,function(a,b){if(f(a.value))return g=
1,c.selectByIndex(b),!1}),g||c.selectByIndex(-1))},selectByIndex:function(a){c.get(this.id).selectedIndex=a+1;this.selectedValue=this.items[a]?this.items[a].value:null},add:function(a,b,g){g=g||{};g.value=b;this.isRendered()&&c.add(c.get(this.id),"option",g,a);a={title:a,value:b,attribs:g};this.items.push(a);this.onAdd.dispatch(this,a)},getLength:function(){return this.items.length},renderHTML:function(){var a;a=c.createHTML("option",{value:""},"-- "+this.settings.title+" --");b(this.items,function(b){a+=
c.createHTML("option",{value:b.value},b.title)});a=c.createHTML("select",{id:this.id,"class":"mceNativeListBox","aria-labelledby":this.id+"_aria"},a);return a+=c.createHTML("span",{id:this.id+"_aria",style:"display: none"},this.settings.title)},postRender:function(){function b(a){if((a=e.items[a.target.selectedIndex-1])&&(a=a.value))if(e.onChange.dispatch(e,a),e.settings.onselect)e.settings.onselect(a)}var e=this,g=!0;e.rendered=!0;a.add(e.id,"change",b);a.add(e.id,"keydown",function(c){var k;a.remove(e.id,
"change",void 0);g=!1;k=a.add(e.id,"blur",function(){g||(g=!0,a.add(e.id,"change",b),a.remove(e.id,"blur",k))});if(f.isWebKit&&(37==c.keyCode||39==c.keyCode))return a.prevent(c);if(13==c.keyCode||32==c.keyCode)return b(c),a.cancel(c)});e.onPostRender.dispatch(e,c.get(e.id))}})})(tinymce);
(function(f){var c=f.DOM,a=f.dom.Event;f.create("tinymce.ui.MenuButton:tinymce.ui.Button",{MenuButton:function(a,d,e){this.parent(a,d,e);this.onRenderMenu=new f.util.Dispatcher(this);d.menu_container=d.menu_container||c.doc.body},showMenu:function(){var b,d=c.get(this.id),e;if(!this.isDisabled()){this.isMenuRendered||(this.renderMenu(),this.isMenuRendered=!0);if(this.isMenuVisible)return this.hideMenu();c.getPos(this.settings.menu_container);b=c.getPos(d);e=this.menu;e.settings.offset_x=b.x;e.settings.offset_y=
b.y;e.settings.vp_offset_x=b.x;e.settings.vp_offset_y=b.y;e.settings.keyboard_focus=this._focused;e.showMenu(0,d.firstChild.clientHeight);a.add(c.doc,"mousedown",this.hideMenu,this);this.setState("Selected",1);this.isMenuVisible=1}},renderMenu:function(){var a=this,c;c=a.settings.control_manager.createDropMenu(a.id+"_menu",{menu_line:1,"class":this.classPrefix+"Menu",icons:a.settings.icons});c.onHideMenu.add(function(){a.hideMenu();a.focus()});a.onRenderMenu.dispatch(a,c);a.menu=c},hideMenu:function(b){var d=
this;if(!b||!("mousedown"==b.type&&c.getParent(b.target,function(a){return a.id===d.id||a.id===d.id+"_open"}))){if(!b||!c.getParent(b.target,".mceMenu"))d.setState("Selected",0),a.remove(c.doc,"mousedown",d.hideMenu,d),d.menu&&d.menu.hideMenu();d.isMenuVisible=0}},postRender:function(){var b=this,c=b.settings;a.add(b.id,"click",function(){if(!b.isDisabled()){if(c.onclick)c.onclick(b.value);b.showMenu()}})}})})(tinymce);
(function(f){var c=f.DOM,a=f.dom.Event;f.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{SplitButton:function(a,c,e){this.parent(a,c,e);this.classPrefix="mceSplitButton"},renderHTML:function(){var a=this.classPrefix,d,e=this.settings,g;d="<tbody><tr>";var f=c.encode(e.label||"");g=e.image?c.createHTML("img ",{src:e.image,role:"presentation","class":"mceAction "+e["class"]})+1:c.createHTML("span",{"class":"mceAction "+e["class"]},"")+(f?'<span class="'+a+'Label">'+f+"</span>":"");g+=c.createHTML("span",
{"class":"mceVoiceLabel mceIconOnly",id:this.id+"_voice",style:"display:none;"},e.title);d+="<td >"+c.createHTML("a",{role:"button",id:this.id+"_action",tabindex:"-1",href:"javascript:;","class":"mceAction "+e["class"],onclick:"return false;",onmousedown:"return false;",title:e.title},g)+"</td>";g=c.createHTML("span",{"class":"mceOpen "+e["class"]},"");d+="<td>"+c.createHTML("a",{id:this.id+"_open",href:"javascript:;","class":"mceOpen "+e["class"],onclick:"return false;",onmousedown:"return false;",
title:e.title},g)+"</td>";return c.createHTML("table",{id:this.id,"class":a+" "+a+"Enabled "+e["class"]+(f?" "+a+"Labeled":""),cellpadding:"0",cellspacing:"0",onmousedown:"return false;",title:e.title},d+"</tr></tbody>")},postRender:function(){var b=this,d=b.settings,e;d.onclick&&(e=function(c){b.isDisabled()||(d.onclick(b.value),a.cancel(c))},a.add(b.id+"_action","click",e),a.add(b.id,["click","keydown"],function(c){if((32===c.keyCode||13===c.keyCode||14===c.keyCode)&&!c.altKey&&!c.ctrlKey&&!c.metaKey)e(),
a.cancel(c);else if("click"===c.type||40===c.keyCode)b.showMenu(),a.cancel(c)}));a.add(b.id+"_open","click",function(c){b.showMenu();a.cancel(c)});a.add([b.id,b.id+"_open"],"focus",function(){b._focused=1});a.add([b.id,b.id+"_open"],"blur",function(){b._focused=0});if(f.isIE6||!c.boxModel)a.add(b.id,"mouseover",function(){c.hasClass(b.id,"mceSplitButtonDisabled")||c.addClass(b.id,"mceSplitButtonHover")}),a.add(b.id,"mouseout",function(){c.hasClass(b.id,"mceSplitButtonDisabled")||c.removeClass(b.id,
"mceSplitButtonHover")})},destroy:function(){this.parent();a.clear(this.id+"_action");a.clear(this.id+"_open");a.clear(this.id)}})})(tinymce);
(function(f){var c=f.DOM,a=f.dom.Event,b=f.is,d=f.each;f.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{ColorSplitButton:function(a,b,c){this.parent(a,b,c);this.settings=b=f.extend({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",grid_width:8,default_color:"#888888"},
this.settings);this.onShowMenu=new f.util.Dispatcher(this);this.onHideMenu=new f.util.Dispatcher(this);this.value=b.default_color},showMenu:function(){var b=this,d,f;if(!b.isDisabled()){b.isMenuRendered||(b.renderMenu(),b.isMenuRendered=!0);if(b.isMenuVisible)return b.hideMenu();d=c.get(b.id);c.show(b.id+"_menu");c.addClass(d,"mceSplitButtonSelected");f=c.getPos(d);c.setStyles(b.id+"_menu",{left:f.x,top:f.y+d.firstChild.clientHeight,zIndex:2E5});d=0;a.add(c.doc,"mousedown",b.hideMenu,b);b.onShowMenu.dispatch(b);
b._focused&&(b._keyHandler=a.add(b.id+"_menu","keydown",function(a){a.keyCode==27&&b.hideMenu()}),c.select("a",b.id+"_menu")[0].focus());b.isMenuVisible=1}},hideMenu:function(b){var d=this;if(d.isMenuVisible&&(!b||!("mousedown"==b.type&&c.getParent(b.target,function(a){return a.id===d.id+"_open"})))){if(!b||!c.getParent(b.target,".mceSplitButtonMenu"))c.removeClass(d.id,"mceSplitButtonSelected"),a.remove(c.doc,"mousedown",d.hideMenu,d),a.remove(d.id+"_menu","keydown",d._keyHandler),c.hide(d.id+"_menu");
d.isMenuVisible=0;d.onHideMenu.dispatch()}},renderMenu:function(){var e=this,g,h=0,k=e.settings,l,m,n,o,p;o=c.add(k.menu_container,"div",{role:"listbox",id:e.id+"_menu","class":k.menu_class+" "+k["class"],style:"position:absolute;left:0;top:-1000px;"});g=c.add(o,"div",{"class":k["class"]+" mceSplitButtonMenu"});c.add(g,"span",{"class":"mceMenuLine"});l=c.add(g,"table",{role:"presentation","class":"mceColorSplitMenu"});m=c.add(l,"tbody");h=0;d(b(k.colors,"array")?k.colors:k.colors.split(","),function(a){a=
a.replace(/^#/,"");h--||(n=c.add(m,"tr"),h=k.grid_width-1);l=c.add(n,"td");var b={href:"javascript:;",style:{backgroundColor:"#"+a},title:e.editor.getLang("colors."+a,a),"data-mce-color":"#"+a};f.isIE||(b.role="option");l=c.add(l,"a",b);e.editor.forcedHighContrastMode&&(l=c.add(l,"canvas",{width:16,height:16,"aria-hidden":"true"}),l.getContext&&(p=l.getContext("2d"))?(p.fillStyle="#"+a,p.fillRect(0,0,16,16)):c.remove(l))});k.more_colors_func&&(l=c.add(m,"tr"),l=c.add(l,"td",{colspan:k.grid_width,
"class":"mceMoreColors"}),l=c.add(l,"a",{role:"option",id:e.id+"_more",href:"javascript:;",onclick:"return false;","class":"mceMoreColors"},k.more_colors_title),a.add(l,"click",function(b){k.more_colors_func.call(k.more_colors_scope||this);return a.cancel(b)}));c.addClass(g,"mceColorSplitMenu");new f.ui.KeyboardNavigation({root:e.id+"_menu",items:c.select("a",e.id+"_menu"),onCancel:function(){e.hideMenu();e.focus()}});a.add(e.id+"_menu","mousedown",function(b){return a.cancel(b)});a.add(e.id+"_menu",
"click",function(a){var b;(a=c.getParent(a.target,"a",m))&&a.nodeName.toLowerCase()=="a"&&(b=a.getAttribute("data-mce-color"))&&e.setColor(b);return false});return o},setColor:function(a){this.displayColor(a);this.hideMenu();this.settings.onselect(a)},displayColor:function(a){c.setStyle(this.id+"_preview","backgroundColor",a);this.value=a},postRender:function(){var a=this.id;this.parent();c.add(a+"_action","div",{id:a+"_preview","class":"mceColorPreview"});c.setStyle(this.id+"_preview","backgroundColor",
this.value)},destroy:function(){this.parent();a.clear(this.id+"_menu");a.clear(this.id+"_more");c.remove(this.id+"_menu")}})})(tinymce);
(function(f){var c=f.DOM,a=f.each,b=f.dom.Event;f.create("tinymce.ui.ToolbarGroup:tinymce.ui.Container",{renderHTML:function(){var a=[],b=this.controls,g=f.each,h=this.settings;a.push('<div id="'+this.id+'" role="group" aria-labelledby="'+this.id+'_voice">');a.push("<span role='application'>");a.push('<span id="'+this.id+'_voice" class="mceVoiceLabel" style="display:none;">'+c.encode(h.name)+"</span>");g(b,function(b){a.push(b.renderHTML())});a.push("</span>");a.push("</div>");return a.join("")},
focus:function(){c.get(this.id).focus()},postRender:function(){var b=this,e=[];a(b.controls,function(b){a(b.controls,function(a){a.id&&e.push(a)})});b.keyNav=new f.ui.KeyboardNavigation({root:b.id,items:e,onCancel:function(){f.isWebKit&&c.get(b.editor.id+"_ifr").focus();b.editor.focus()},excludeFromTabOrder:!b.settings.tab_focus_toolbar})},destroy:function(){this.parent();this.keyNav.destroy();b.clear(this.id)}})})(tinymce);
(function(f){var c=f.DOM;f.create("tinymce.ui.Toolbar:tinymce.ui.Container",{renderHTML:function(){var a="",b,d,e=this.settings,g,f,k,l;l=this.controls;for(g=0;g<l.length;g++){d=l[g];f=l[g-1];k=l[g+1];0===g&&(b="mceToolbarStart",d.Button?b+=" mceToolbarStartButton":d.SplitButton?b+=" mceToolbarStartSplitButton":d.ListBox&&(b+=" mceToolbarStartListBox"),a+=c.createHTML("td",{"class":b},c.createHTML("span",null,"<\!-- IE --\>")));if(f&&d.ListBox&&(f.Button||f.SplitButton))a+=c.createHTML("td",{"class":"mceToolbarEnd"},
c.createHTML("span",null,"<\!-- IE --\>"));a=c.stdMode?a+('<td style="position: relative">'+d.renderHTML()+"</td>"):a+("<td>"+d.renderHTML()+"</td>");if(k&&d.ListBox&&(k.Button||k.SplitButton))a+=c.createHTML("td",{"class":"mceToolbarStart"},c.createHTML("span",null,"<\!-- IE --\>"))}b="mceToolbarEnd";d.Button?b+=" mceToolbarEndButton":d.SplitButton?b+=" mceToolbarEndSplitButton":d.ListBox&&(b+=" mceToolbarEndListBox");a+=c.createHTML("td",{"class":b},c.createHTML("span",null,"<\!-- IE --\>"));return c.createHTML("table",
{id:this.id,"class":"mceToolbar"+(e["class"]?" "+e["class"]:""),cellpadding:"0",cellspacing:"0",align:this.settings.align||"",role:"presentation",tabindex:"-1"},"<tbody><tr>"+a+"</tr></tbody>")}})})(tinymce);
(function(f){var c=f.util.Dispatcher;f.create("tinymce.AddOnManager",{AddOnManager:function(){this.items=[];this.urls={};this.lookup={};this.onAdd=new c(this)},get:function(a){if(this.lookup[a])return this.lookup[a].instance},dependencies:function(a){var b;this.lookup[a]&&(b=this.lookup[a].dependencies);return b||[]},requireLangPack:function(a){var b=f.settings;b&&b.language&&!1!==b.language_load&&f.ScriptLoader.add(this.urls[a]+"/langs/"+b.language+".js")},add:function(a,b,c){this.items.push(b);
this.lookup[a]={instance:b,dependencies:c};this.onAdd.dispatch(this,a,b);return b},createUrl:function(a,b){return"object"===typeof b?b:{prefix:a.prefix,resource:b,suffix:a.suffix}},addComponents:function(a,b){var c=this.urls[a];f.each(b,function(a){f.ScriptLoader.add(c+"/"+a)})},load:function(a,b,c,e){function g(){var g=h.dependencies(a);f.each(g,function(a){a=h.createUrl(b,a);h.load(a.resource,a,void 0,void 0)});c&&(e?c.call(e):c.call(f.ScriptLoader))}var h=this,k=b;h.urls[a]||("object"===typeof b&&
(k=b.prefix+b.resource+b.suffix),0!==k.indexOf("/")&&-1==k.indexOf("://")&&(k=f.baseURL+"/"+k),h.urls[a]=k.substring(0,k.lastIndexOf("/")),h.lookup[a]?g():f.ScriptLoader.add(k,g,e))}});f.PluginManager=new f.AddOnManager;f.ThemeManager=new f.AddOnManager})(tinymce);
(function(f){var c=f.each,a=f.extend,b=f.DOM,d=f.dom.Event,e=f.explode,g=f.util.Dispatcher,h=0;f.documentBaseURL=window.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");/[\/\\]$/.test(f.documentBaseURL)||(f.documentBaseURL+="/");f.baseURL=(new f.util.URI(f.documentBaseURL)).toAbsolute(f.baseURL);f.baseURI=new f.util.URI(f.baseURL);f.onBeforeUnload=new g(f);d.add(window,"beforeunload",function(a){f.onBeforeUnload.dispatch(f,a)});f.onAddEditor=new g(f);f.onRemoveEditor=new g(f);f.EditorManager=
a(f,{editors:[],i18n:{},activeEditor:null,init:function(a){function g(a){var c=a.id;if(!c){c=(c=a.name)&&!b.get(c)?a.name:b.uniqueId();a.setAttribute("id",c)}return c}function m(a,b,c){var d=a[b];if(d){if(f.is(d,"string")){c=(c=d.replace(/\.\w+$/,""))?f.resolve(c):0;d=f.resolve(d)}return d.apply(c||this,Array.prototype.slice.call(arguments,2))}}var n=[],o;this.settings=a;d.bind(window,"ready",function(){var d,q;m(a,"onpageload");switch(a.mode){case "exact":d=a.elements||"";d.length>0&&c(e(d),function(d){if(b.get(d)){o=
new f.Editor(d,a);n.push(o);o.render(1)}else c(document.forms,function(e){c(e.elements,function(c){if(c.name===d){d="mce_editor_"+h++;b.setAttrib(c,"id",d);o=new f.Editor(d,a);n.push(o);o.render(1)}})})});break;case "textareas":case "specific_textareas":c(b.select("textarea"),function(c){if(!a.editor_deselector||!(a.editor_deselector.constructor===RegExp?a.editor_deselector.test(c.className):b.hasClass(c,a.editor_deselector)))if(!a.editor_selector||(a.editor_selector.constructor===RegExp?a.editor_selector.test(c.className):
b.hasClass(c,a.editor_selector))){o=new f.Editor(g(c),a);n.push(o);o.render(1)}});break;default:a.types?c(a.types,function(d){c(b.select(d.selector),function(b){b=new f.Editor(g(b),f.extend({},a,d));n.push(b);b.render(1)})}):a.selector&&c(b.select(a.selector),function(b){b=new f.Editor(g(b),a);n.push(b);b.render(1)})}if(a.oninit){d=q=0;c(n,function(b){q++;b.initialized?d++:b.onInit.add(function(){d++;d==q&&m(a,"oninit")});d==q&&m(a,"oninit")})}})},get:function(a){return a===void 0?this.editors:this.editors[a]},
getInstanceById:function(a){return this.get(a)},add:function(a){var b=this.editors;b[a.id]=a;b.push(a);this._setActive(a);this.onAddEditor.dispatch(this,a);f.adapter&&f.adapter.patchEditor(a);return a},remove:function(a){var b,c=this.editors;if(!c[a.id])return null;delete c[a.id];for(b=0;b<c.length;b++)if(c[b]==a){c.splice(b,1);break}this.activeEditor==a&&this._setActive(c[0]);a.destroy();this.onRemoveEditor.dispatch(this,a);return a},execCommand:function(a,b,c){function d(){e.destroy();g.detachEvent("onunload",
d);g=g.tinyMCE=g.tinymce=null}var e=this.get(c),g;switch(a){case "mceFocus":e.focus();return true;case "mceAddEditor":case "mceAddControl":this.get(c)||(new f.Editor(c,this.settings)).render();return true;case "mceAddFrameControl":g=c.window;g.tinyMCE=tinyMCE;g.tinymce=f;f.DOM.doc=g.document;f.DOM.win=g;e=new f.Editor(c.element_id,c);e.render();f.isIE&&g.attachEvent("onunload",d);c.page_window=null;return true;case "mceRemoveEditor":case "mceRemoveControl":e&&e.remove();return true;case "mceToggleEditor":if(!e){this.execCommand("mceAddControl",
0,c);return true}e.isHidden()?e.show():e.hide();return true}return this.activeEditor?this.activeEditor.execCommand(a,b,c):false},execInstanceCommand:function(a,b,c,d){return(a=this.get(a))?a.execCommand(b,c,d):false},triggerSave:function(){c(this.editors,function(a){a.save()})},addI18n:function(a,b){var d=this.i18n;f.is(a,"string")?c(b,function(b,c){d[a+"."+c]=b}):c(a,function(a,b){c(a,function(a,e){c(a,function(a,c){e==="common"?d[b+"."+c]=a:d[b+"."+e+"."+c]=a})})})},_setActive:function(a){this.selectedInstance=
this.activeEditor=a}})})(tinymce);
(function(f){var c=f.DOM,a=f.dom.Event,b=f.extend,d=f.each,e=f.isGecko,g=f.isIE,h=f.is,k=f.ThemeManager,l=f.PluginManager,m=f.explode;f.create("tinymce.Editor",{Editor:function(a,c){this.settings=c=b({id:a,language:"en",theme:"advanced",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:f.documentBaseURL,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,table_inline_editing:!1,object_resizing:!0,
accessibility_focus:!0,doctype:f.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE>",visual:!0,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",apply_source_formatting:!0,directionality:"ltr",forced_root_block:"p",hidden_input:!0,padd_empty_editor:!0,render_ui:!0,indentation:"30px",fix_table_elements:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:"simple",
indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",validate:!0,entity_encoding:"named",url_converter:this.convertURL,url_converter_scope:this,ie7_compat:!0},c);this.id=this.editorId=a;this.isNotDirty=!1;
this.plugins={};this.documentBaseURI=new f.util.URI(c.document_base_url||f.documentBaseURL,{base_uri:tinyMCE.baseURI});this.baseURI=f.baseURI;this.contentCSS=[];this.contentStyles=[];this.setupEvents();this.execCommands={};this.queryStateCommands={};this.queryValueCommands={};this.execCallback("setup",this)},render:function(){var b=this,e=b.settings,g=b.id,h=f.ScriptLoader;if(a.domLoaded){if(tinyMCE.settings=e,b.getElement()&&(!f.isIDevice||f.isIOS5))!/TEXTAREA|INPUT/i.test(b.getElement().nodeName)&&
e.hidden_input&&c.getParent(g,"form")&&c.insertAfter(c.create("input",{type:"hidden",name:g}),g),e.content_editable||(b.orgVisibility=b.getElement().style.visibility,b.getElement().style.visibility="hidden"),f.WindowManager&&(b.windowManager=new f.WindowManager(b)),"xml"==e.encoding&&b.onGetContent.add(function(a,b){if(b.save)b.content=c.encode(b.content)}),e.add_form_submit_trigger&&b.onSubmit.addToTop(function(){if(b.initialized){b.save();b.isNotDirty=1}}),e.add_unload_trigger&&(b._beforeUnload=
tinyMCE.onBeforeUnload.add(function(){b.initialized&&!b.destroyed&&!b.isHidden()&&b.save({format:"raw",no_events:true})})),f.addUnload(b.destroy,b),e.submit_patch&&b.onBeforeRenderUI.add(function(){var a=b.getElement().form;if(a&&!a._mceOldSubmit){if(!a.submit.nodeType&&!a.submit.length){b.formElement=a;a._mceOldSubmit=a.submit;a.submit=function(){f.triggerSave();b.isNotDirty=1;return b.formElement._mceOldSubmit(b.formElement)}}a=null}}),function(){e.language&&e.language_load!==false&&h.add(f.baseURL+
"/langs/"+e.language+".js");e.theme&&typeof e.theme!="function"&&e.theme.charAt(0)!="-"&&!k.urls[e.theme]&&k.load(e.theme,"themes/"+e.theme+"/editor_template"+f.suffix+".js");d(m(e.plugins),function(a){if(a&&!l.urls[a])if(a.charAt(0)=="-"){a=a.substr(1,a.length);a=l.dependencies(a);d(a,function(a){a=l.createUrl({prefix:"plugins/",resource:a,suffix:"/editor_plugin"+f.suffix+".js"},a);l.load(a.resource,a)})}else a!="safari"&&l.load(a,{prefix:"plugins/",resource:a,suffix:"/editor_plugin"+f.suffix+".js"})});
h.loadQueue(function(){b.removed||b.init()})}()}else a.add(window,"ready",function(){b.render()})},init:function(){function a(c){var e=l.get(c),g=l.urls[c]||f.documentBaseURL.replace(/\/$/,"");e&&-1===f.inArray(A,c)&&(d(l.dependencies(c),function(b){a(b)}),e=new e(b,g),b.plugins[c]=e,e.init&&(e.init(b,g),A.push(c)))}var b=this,e=b.settings,h,s,t,r=b.getElement(),u,D,x,A=[];f.add(b);e.aria_label=e.aria_label||c.getAttrib(r,"aria-label",b.getLang("aria.rich_text_area"));e.theme&&("function"!=typeof e.theme?
(e.theme=e.theme.replace(/-/,""),u=k.get(e.theme),b.theme=new u,b.theme.init&&b.theme.init(b,k.urls[e.theme]||f.documentBaseURL.replace(/\/$/,""))):b.theme=e.theme);d(m(e.plugins.replace(/\-/g,"")),a);!1!==e.popup_css&&(e.popup_css=e.popup_css?b.documentBaseURI.toAbsolute(e.popup_css):b.baseURI.toAbsolute("themes/"+e.theme+"/skins/"+e.skin+"/dialog.css"));e.popup_css_add&&(e.popup_css+=","+b.documentBaseURI.toAbsolute(e.popup_css_add));b.controlManager=new f.ControlManager(b);b.onExecCommand.add(function(a,
c){/^(FontName|FontSize)$/.test(c)||b.nodeChanged()});b.onBeforeRenderUI.dispatch(b,b.controlManager);e.render_ui&&b.theme&&(b.orgDisplay=r.style.display,"function"!=typeof e.theme?(h=e.width||r.style.width||r.offsetWidth,s=e.height||r.style.height||r.offsetHeight,t=e.min_height||100,x=/^[0-9\.]+(|px)$/i,x.test(""+h)&&(h=Math.max(parseInt(h,10)+(u.deltaWidth||0),100)),x.test(""+s)&&(s=Math.max(parseInt(s,10)+(u.deltaHeight||0),t)),u=b.theme.renderUI({targetNode:r,width:h,height:s,deltaWidth:e.delta_width,
deltaHeight:e.delta_height}),c.setStyles(u.sizeContainer||u.editorContainer,{width:h,height:s}),s=(u.iframeHeight||s)+("number"==typeof s?u.deltaHeight||0:""),s<t&&(s=t)):(u=e.theme(b,r),u.editorContainer.nodeType&&(u.editorContainer=u.editorContainer.id=u.editorContainer.id||b.id+"_parent"),u.iframeContainer.nodeType&&(u.iframeContainer=u.iframeContainer.id=u.iframeContainer.id||b.id+"_iframecontainer"),s=u.iframeHeight||r.offsetHeight,g&&b.onInit.add(function(a){a.dom.bind(a.getBody(),"beforedeactivate keydown",
function(){a.lastIERng=a.selection.getRng()})})),b.editorContainer=u.editorContainer);e.content_css&&d(m(e.content_css),function(a){b.contentCSS.push(b.documentBaseURI.toAbsolute(a))});if(e.content_editable)return r=u=null,b.initContentBody();document.domain&&location.hostname!=document.domain&&(f.relaxedDomain=document.domain);b.iframeHTML=e.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">';e.document_base_url!=f.documentBaseURL&&(b.iframeHTML+='<base href="'+b.documentBaseURI.getURI()+
'" />');b.iframeHTML=e.ie7_compat?b.iframeHTML+'<meta http-equiv="X-UA-Compatible" content="IE=7" />':b.iframeHTML+'<meta http-equiv="X-UA-Compatible" content="IE=edge" />';b.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';for(h=0;h<b.contentCSS.length;h++)b.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+b.contentCSS[h]+'" />';b.contentCSS=[];h=e.body_id||"tinymce";-1!=h.indexOf("=")&&(h=b.getParam("body_id","","hash"),h=h[b.id]||h);t=e.body_class||
"";-1!=t.indexOf("=")&&(t=b.getParam("body_class","","hash"),t=t[b.id]||"");b.iframeHTML+='</head><body id="'+h+'" class="mceContentBody '+t+'" onload="window.parent.tinyMCE.get(\''+b.id+"').onLoad.dispatch();\"><br></body></html>";if(f.relaxedDomain&&(g||f.isOpera&&11>parseFloat(opera.version())))D='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+b.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody();})()';c.add(u.iframeContainer,
"iframe",{id:b.id+"_ifr",src:D||'javascript:""',frameBorder:"0",allowTransparency:"true",title:e.aria_label,style:{width:"100%",height:s,display:"block"}});b.contentAreaContainer=u.iframeContainer;u.editorContainer&&(c.get(u.editorContainer).style.display=b.orgDisplay);r.style.visibility=b.orgVisibility;c.get(b.id).style.display="none";c.setAttrib(b.id,"aria-hidden",!0);(!f.relaxedDomain||!D)&&b.initContentBody();r=u=null},initContentBody:function(){var a=this,b=a.settings,e=c.get(a.id),h=a.getDoc(),
k;if((!g||!f.relaxedDomain)&&!b.content_editable)h.open(),h.write(a.iframeHTML),h.close(),f.relaxedDomain&&(h.domain=f.relaxedDomain);b.content_editable&&(c.addClass(e,"mceContentBody"),a.contentDocument=h=b.content_document||document,a.contentWindow=b.content_window||window,a.bodyElement=e,b.content_document=b.content_window=null);e=a.getBody();e.disabled=!0;b.readonly||(e.contentEditable=a.getParam("content_editable_state",!0));e.disabled=!1;a.schema=new f.html.Schema(b);a.dom=new f.dom.DOMUtils(h,
{keep_values:!0,url_converter:a.convertURL,url_converter_scope:a,hex_colors:b.force_hex_style_colors,class_filter:b.class_filter,update_styles:!0,root_element:b.content_editable?a.id:null,schema:a.schema});a.parser=new f.html.DomParser(b,a.schema);a.parser.addAttributeFilter("src,href,style",function(b,c){for(var d=b.length,e,g=a.dom,f,h;d--;){e=b[d];f=e.attr(c);h="data-mce-"+c;e.attributes.map[h]||(c==="style"?e.attr(h,g.serializeStyle(g.parseStyle(f),e.name)):e.attr(h,a.convertURL(f,c,e.name)))}});
a.parser.addNodeFilter("script",function(a){for(var b=a.length,c;b--;){c=a[b];c.attr("type","mce-"+(c.attr("type")||"text/javascript"))}});a.parser.addNodeFilter("#cdata",function(a){for(var b=a.length,c;b--;){c=a[b];c.type=8;c.name="#comment";c.value="[CDATA["+c.value+"]]"}});a.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(b){for(var c=b.length,d,e=a.schema.getNonEmptyElements();c--;){d=b[c];if(d.isEmpty(e))d.empty().append(new f.html.Node("br",1)).shortEnded=true}});a.serializer=new f.dom.Serializer(b,
a.dom,a.schema);a.selection=new f.dom.Selection(a.dom,a.getWin(),a.serializer,a);a.formatter=new f.Formatter(a);a.undoManager=new f.UndoManager(a);a.forceBlocks=new f.ForceBlocks(a);a.enterKey=new f.EnterKey(a);a.editorCommands=new f.EditorCommands(a);a.serializer.onPreProcess.add(function(b,c){return a.onPreProcess.dispatch(a,c,b)});a.serializer.onPostProcess.add(function(b,c){return a.onPostProcess.dispatch(a,c,b)});a.onPreInit.dispatch(a);!b.browser_spellcheck&&!b.gecko_spellcheck&&(h.body.spellcheck=
!1);b.readonly||a.bindNativeEvents();a.controlManager.onPostRender.dispatch(a,a.controlManager);a.onPostRender.dispatch(a);a.quirks=f.util.Quirks(a);b.directionality&&(e.dir=b.directionality);b.nowrap&&(e.style.whiteSpace="nowrap");b.protect&&a.onBeforeSetContent.add(function(a,c){d(b.protect,function(a){c.content=c.content.replace(a,function(a){return"<\!--mce:protected "+escape(a)+"--\>"})})});a.onSetContent.add(function(){a.addVisual(a.getBody())});b.padd_empty_editor&&a.onPostProcess.add(function(a,
b){b.content=b.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")});a.load({initial:!0,format:"html"});a.startContent=a.getContent({format:"raw"});a.initialized=!0;a.onInit.dispatch(a);a.execCallback("setupcontent_callback",a.id,e,h);a.execCallback("init_instance_callback",a);a.focus(!0);a.nodeChanged({initial:!0});0<a.contentStyles.length&&(k="",d(a.contentStyles,function(a){k=k+(a+"\r\n")}),a.dom.addStyle(k));d(a.contentCSS,function(b){a.dom.loadCSS(b)});b.auto_focus&&
setTimeout(function(){var a=f.get(b.auto_focus);a.selection.select(a.getBody(),1);a.selection.collapse(1);a.getBody().focus();a.getWin().focus()},100);e=h=e=null},focus:function(a){var b,c=this.selection,d=this.settings.content_editable,e,g=this.getDoc();if(!a){this.lastIERng&&c.setRng(this.lastIERng);a=c.getRng();a.item&&(e=a.item(0));this._refreshContentEditable();d||this.getWin().focus();if(f.isGecko||d)a=this.getBody(),a.setActive?a.setActive():a.focus(),d&&c.normalize();e&&e.ownerDocument==g&&
(a=g.body.createControlRange(),a.addElement(e),a.select())}f.activeEditor!=this&&(null!=(b=f.activeEditor)&&b.onDeactivate.dispatch(b,this),this.onActivate.dispatch(this,b));f._setActive(this)},execCallback:function(a){var b=this.settings[a],c;if(b){if(this.callbackLookup&&(c=this.callbackLookup[a]))b=c.func,c=c.scope;h(b,"string")&&(c=(c=b.replace(/\.\w+$/,""))?f.resolve(c):0,b=f.resolve(b),this.callbackLookup=this.callbackLookup||{},this.callbackLookup[a]={func:b,scope:c});return b.apply(c||this,
Array.prototype.slice.call(arguments,1))}},translate:function(a){var b=this.settings.language||"en",c=f.i18n;return!a?"":c[b+"."+a]||a.replace(/\{\#([^\}]+)\}/g,function(a,d){return c[b+"."+d]||"{#"+d+"}"})},getLang:function(a,b){return f.i18n[(this.settings.language||"en")+"."+a]||(h(b)?b:"{#"+a+"}")},getParam:function(a,b,c){var e=f.trim,a=h(this.settings[a])?this.settings[a]:b,g;return"hash"===c?(g={},h(a,"string")?d(0<a.indexOf("=")?a.split(/[;,](?![^=;,]*(?:[;,]|$))/):a.split(","),function(a){a=
a.split("=");1<a.length?g[e(a[0])]=e(a[1]):g[e(a[0])]=e(a)}):g=a,g):a},nodeChanged:function(a){var b=this.selection,c;this.initialized&&(a=a||{},c=b.getStart()||this.getBody(),c=g&&c.ownerDocument!=this.getDoc()?this.getBody():c,a.parents=[],this.dom.getParent(c,function(b){if("BODY"==b.nodeName)return!0;a.parents.push(b)}),this.onNodeChange.dispatch(this,a?a.controlManager||this.controlManager:this.controlManager,c,b.isCollapsed(),a))},addButton:function(a,b){this.buttons=this.buttons||{};this.buttons[a]=
b},addCommand:function(a,b,c){this.execCommands[a]={func:b,scope:c||this}},addQueryStateHandler:function(a,b,c){this.queryStateCommands[a]={func:b,scope:c||this}},addQueryValueHandler:function(a,b,c){this.queryValueCommands[a]={func:b,scope:c||this}},addShortcut:function(a,b,c,e){var g=this,f;if(!1===g.settings.custom_shortcuts)return!1;g.shortcuts=g.shortcuts||{};h(c,"string")&&(f=c,c=function(){g.execCommand(f,!1,null)});h(c,"object")&&(f=c,c=function(){g.execCommand(f[0],f[1],f[2])});d(m(a),function(a){var f=
{func:c,scope:e||this,desc:g.translate(b),alt:false,ctrl:false,shift:false};d(m(a,"+"),function(a){switch(a){case "alt":case "ctrl":case "shift":f[a]=true;break;default:f.charCode=a.charCodeAt(0);f.keyCode=a.toUpperCase().charCodeAt(0)}});g.shortcuts[(f.ctrl?"ctrl":"")+","+(f.alt?"alt":"")+","+(f.shift?"shift":"")+","+f.keyCode]=f});return!0},execCommand:function(a,c,e,g){var f=this,h=0,k;!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(a)&&(!g||!g.skip_focus)&&f.focus();
g=b({},g);f.onBeforeExecCommand.dispatch(f,a,c,e,g);if(g.terminate)return!1;if(f.execCallback("execcommand_callback",f.id,f.selection.getNode(),a,c,e))return f.onExecCommand.dispatch(f,a,c,e,g),!0;if(k=f.execCommands[a])if(k=k.func.call(k.scope,c,e),!0!==k)return f.onExecCommand.dispatch(f,a,c,e,g),k;d(f.plugins,function(b){if(b.execCommand&&b.execCommand(a,c,e))return f.onExecCommand.dispatch(f,a,c,e,g),h=1,!1});if(h)return!0;if(f.theme&&f.theme.execCommand&&f.theme.execCommand(a,c,e)||f.editorCommands.execCommand(a,
c,e))return f.onExecCommand.dispatch(f,a,c,e,g),!0;f.getDoc().execCommand(a,c,e);f.onExecCommand.dispatch(f,a,c,e,g)},queryCommandState:function(a){var b;if(!this._isHidden()){if(b=this.queryStateCommands[a])if(b=b.func.call(b.scope),!0!==b)return b;b=this.editorCommands.queryCommandState(a);if(-1!==b)return b;try{return this.getDoc().queryCommandState(a)}catch(c){}}},queryCommandValue:function(a){var b;if(!this._isHidden()){if(b=this.queryValueCommands[a])if(b=b.func.call(b.scope),!0!==b)return b;
b=this.editorCommands.queryCommandValue(a);if(h(b))return b;try{return this.getDoc().queryCommandValue(a)}catch(c){}}},show:function(){c.show(this.getContainer());c.hide(this.id);this.load()},hide:function(){var a=this.getDoc();g&&a&&a.execCommand("SelectAll");this.save();c.hide(this.getContainer());c.setStyle(this.id,"display",this.orgDisplay)},isHidden:function(){return!c.isHidden(this.id)},setProgressState:function(a,b,c){this.onSetProgressState.dispatch(this,a,b,c);return a},load:function(a){var b=
this.getElement(),c;if(b)return a=a||{},a.load=!0,c=this.setContent(h(b.value)?b.value:b.innerHTML,a),a.element=b,a.no_events||this.onLoadContent.dispatch(this,a),a.element=null,c},save:function(a){var b=this,e=b.getElement(),g,f;if(e&&b.initialized)return a=a||{},a.save=!0,a.element=e,g=a.content=b.getContent(a),a.no_events||b.onSaveContent.dispatch(b,a),g=a.content,/TEXTAREA|INPUT/i.test(e.nodeName)?e.value=g:(e.innerHTML=g,(f=c.getParent(b.id,"form"))&&d(f.elements,function(a){if(a.name==b.id)return a.value=
g,!1})),a.element=e=null,g},setContent:function(a,b){var c=this.getBody(),d,b=b||{};b.format=b.format||"html";b.set=!0;b.content=a;b.no_events||this.onBeforeSetContent.dispatch(this,b);a=b.content;if(!f.isIE&&(0===a.length||/^\s+$/.test(a)))d=this.settings.forced_root_block,c.innerHTML=d?"<"+d+'><br data-mce-bogus="1"></'+d+">":'<br data-mce-bogus="1">',this.selection.select(c,!0),this.selection.collapse(!0);else return"raw"!==b.format&&(a=(new f.html.Serializer({},this.schema)).serialize(this.parser.parse(a))),
b.content=f.trim(a),this.dom.setHTML(c,b.content),b.no_events||this.onSetContent.dispatch(this,b),(!this.settings.content_editable||document.activeElement===this.getBody())&&this.selection.normalize(),b.content},getContent:function(a){var b,a=a||{};a.format=a.format||"html";a.get=!0;a.getInner=!0;a.no_events||this.onBeforeGetContent.dispatch(this,a);b="raw"==a.format?this.getBody().innerHTML:this.serializer.serialize(this.getBody(),a);a.content=f.trim(b);a.no_events||this.onGetContent.dispatch(this,
a);return a.content},isDirty:function(){return f.trim(this.startContent)!=f.trim(this.getContent({format:"raw",no_events:1}))&&!this.isNotDirty},getContainer:function(){this.container||(this.container=c.get(this.editorContainer||this.id+"_parent"));return this.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return c.get(this.settings.content_element||this.id)},getWin:function(){var a;if(!this.contentWindow&&(a=c.get(this.id+"_ifr")))this.contentWindow=
a.contentWindow;return this.contentWindow},getDoc:function(){var a;if(!this.contentDocument&&(a=this.getWin()))this.contentDocument=a.document;return this.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(a,b,c){var d=this.settings;return d.urlconverter_callback?this.execCallback("urlconverter_callback",a,c,!0,b):!d.convert_urls||c&&"LINK"==c.nodeName||0===a.indexOf("file:")?a:d.relative_urls?this.documentBaseURI.toRelative(a):a=this.documentBaseURI.toAbsolute(a,
d.remove_script_host)},addVisual:function(a){var b=this,c=b.settings,e=b.dom,g,a=a||b.getBody();h(b.hasVisual)||(b.hasVisual=c.visual);d(e.select("table,a",a),function(a){var d;switch(a.nodeName){case "TABLE":g=c.visual_table_class||"mceItemTable";d=e.getAttrib(a,"border");if(!d||d=="0")b.hasVisual?e.addClass(a,g):e.removeClass(a,g);break;case "A":if(!a.href){d=e.getAttrib(a,"name")||a.id;g="mceItemAnchor";d&&(b.hasVisual?e.addClass(a,g):e.removeClass(a,g))}}});b.onVisualAid.dispatch(b,a,b.hasVisual)},
remove:function(){var b=this.getContainer();this.removed||(this.removed=1,this.hide(),this.settings.content_editable||(a.clear(this.getWin()),a.clear(this.getDoc())),a.clear(this.getBody()),a.clear(this.formElement),a.unbind(b),this.execCallback("remove_instance_callback",this),this.onRemove.dispatch(this),this.onExecCommand.listeners=[],f.remove(this),c.remove(b))},destroy:function(b){this.destroyed||(e&&(a.unbind(this.getDoc()),a.unbind(this.getWin()),a.unbind(this.getBody())),b||(f.removeUnload(this.destroy),
tinyMCE.onBeforeUnload.remove(this._beforeUnload),this.theme&&this.theme.destroy&&this.theme.destroy(),this.controlManager.destroy(),this.selection.destroy(),this.dom.destroy()),this.formElement&&(this.formElement.submit=this.formElement._mceOldSubmit,this.formElement._mceOldSubmit=null),this.contentAreaContainer=this.formElement=this.container=this.settings.content_element=this.bodyElement=this.contentDocument=this.contentWindow=null,this.selection&&(this.selection=this.selection.win=this.selection.dom=
this.selection.dom.doc=null),this.destroyed=1)},_refreshContentEditable:function(){var a,b;this._isHidden()&&(a=this.getBody(),b=a.parentNode,b.removeChild(a),b.appendChild(a),a.focus())},_isHidden:function(){var a;if(!e)return 0;a=this.selection.getSel();return!a||!a.rangeCount||0===a.rangeCount}})})(tinymce);
(function(f){var c=f.each;f.Editor.prototype.setupEvents=function(){var a=this,b=a.settings;c("onPreInit,onBeforeRenderUI,onPostRender,onLoad,onInit,onRemove,onActivate,onDeactivate,onClick,onEvent,onMouseUp,onMouseDown,onDblClick,onKeyDown,onKeyUp,onKeyPress,onContextMenu,onSubmit,onReset,onPaste,onPreProcess,onPostProcess,onBeforeSetContent,onBeforeGetContent,onSetContent,onGetContent,onLoadContent,onSaveContent,onNodeChange,onChange,onBeforeExecCommand,onExecCommand,onUndo,onRedo,onVisualAid,onSetProgressState,onSetAttrib".split(","),function(b){a[b]=
new f.util.Dispatcher(a)});b.cleanup_callback&&(a.onBeforeSetContent.add(function(a,b){b.content=a.execCallback("cleanup_callback","insert_to_editor",b.content,b)}),a.onPreProcess.add(function(a,b){b.set&&a.execCallback("cleanup_callback","insert_to_editor_dom",b.node,b);b.get&&a.execCallback("cleanup_callback","get_from_editor_dom",b.node,b)}),a.onPostProcess.add(function(a,b){b.set&&(b.content=a.execCallback("cleanup_callback","insert_to_editor",b.content,b));b.get&&(b.content=a.execCallback("cleanup_callback",
"get_from_editor",b.content,b))}));b.save_callback&&a.onGetContent.add(function(a,b){if(b.save)b.content=a.execCallback("save_callback",a.id,b.content,a.getBody())});b.handle_event_callback&&a.onEvent.add(function(b,c,g){a.execCallback("handle_event_callback",c,b,g)===false&&Event.cancel(c)});b.handle_node_change_callback&&a.onNodeChange.add(function(a,b,c){a.execCallback("handle_node_change_callback",a.id,c,-1,-1,true,a.selection.isCollapsed())});b.save_callback&&a.onSaveContent.add(function(a,b){var c=
a.execCallback("save_callback",a.id,b.content,a.getBody());if(c)b.content=c});b.onchange_callback&&a.onChange.add(function(a,b){a.execCallback("onchange_callback",a,b)})};f.Editor.prototype.bindNativeEvents=function(){function a(a,b){g.removed||!1!==g.onEvent.dispatch(g,a,b)&&g[l[a.fakeType||a.type]].dispatch(g,a,b)}function b(){g.focus(!0)}function d(){g.selection.normalize();g.nodeChanged()}function e(a,b){(a.altKey||a.ctrlKey||a.metaKey)&&c(g.shortcuts,function(c){if(!(c.ctrl!=(f.isMac?a.metaKey:
a.ctrlKey)||c.alt!=a.altKey||c.shift!=a.shiftKey))if(a.keyCode==c.keyCode||a.charCode&&a.charCode==c.charCode)return a.preventDefault(),b&&c.func.call(c.scope),!0})}var g=this,h=g.settings,k=g.dom,l;l={mouseup:"onMouseUp",mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"};c(l,function(b,c){var d=h.content_editable?g.getBody():g.getDoc();switch(c){case "contextmenu":k.bind(d,
c,a);break;case "paste":k.bind(g.getBody(),c,a);break;case "submit":case "reset":k.bind(g.getElement().form||f.DOM.getParent(g.id,"form"),c,a);break;default:k.bind(d,c,a)}});k.bind(h.content_editable?g.getBody():f.isGecko?g.getDoc():g.getWin(),"focus",function(){g.focus(!0)});h.content_editable&&f.isOpera&&(k.bind(g.getBody(),"click",b),k.bind(g.getBody(),"keydown",b));g.onMouseUp.add(d);g.onKeyUp.add(function(a,b){var c=b.keyCode;(c>=33&&c<=36||c>=37&&c<=40||c==13||c==45||c==46||c==8||f.isMac&&(c==
91||c==93)||b.ctrlKey)&&d()});g.onReset.add(function(){g.setContent(g.startContent,{format:"raw"})});g.onKeyUp.add(function(a,b){e(b)});g.onKeyPress.add(function(a,b){e(b)});g.onKeyDown.add(function(a,b){e(b,true)});f.isOpera&&g.onClick.add(function(a,b){b.preventDefault()})}})(tinymce);
(function(f){var c=f.each,a=!0,b=!1;f.EditorCommands=function(d){function e(c,d,e){var g,c=c.toLowerCase();return(g=o.exec[c])?(g(c,d,e),a):b}function g(a){var b,a=a.toLowerCase();return(b=o.state[a])?b(a):-1}function h(a,b){b=b||"exec";c(a,function(a,d){c(d.toLowerCase().split(","),function(c){o[b][c]=a})})}function k(a,c,e){void 0===c&&(c=b);void 0===e&&(e=null);return d.getDoc().execCommand(a,c,e)}function l(a,b){q.toggle(a,b?{value:b}:void 0)}var m=d.dom,n=d.selection,o={state:{},exec:{},value:{}},
p=d.settings,q=d.formatter,s;f.extend(this,{execCommand:e,queryCommandState:g,queryCommandValue:function(a){var c,a=a.toLowerCase();return(c=o.value[a])?c(a):b},addCommands:h});h({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){d.undoManager.add()},"Cut,Copy,Paste":function(b){var c=d.getDoc(),e;try{k(b)}catch(g){e=a}if(e||!c.queryCommandSupported(b))f.isGecko?d.windowManager.confirm(d.getLang("clipboard_msg"),function(a){a&&open("http://www.mozilla.org/editor/midasdemo/securityprefs.html",
"_blank")}):d.windowManager.alert(d.getLang("clipboard_no_support"))},unlink:function(a){n.isCollapsed()&&n.select(n.getNode());k(a);n.collapse(b)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(a){var b=a.substring(7);c(["left","center","right","full"],function(a){b!=a&&q.remove("align"+a)});l("align"+b);e("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(a){var b;k(a);if(a=m.getParent(n.getNode(),"ol,ul"))b=a.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(b.nodeName)&&(s=
n.getBookmark(void 0),m.split(b,a),n.moveToBookmark(s))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(a){l(a)},"ForeColor,HiliteColor,FontName":function(a,b,c){l(a,c)},FontSize:function(a,b,c){var d;1<=c&&7>=c&&(d=f.explode(p.font_size_style_values),c=(b=f.explode(p.font_size_classes))?b[c-1]||c:d[c-1]||c);l(a,c)},RemoveFormat:function(a){q.remove(a)},mceBlockQuote:function(){l("blockquote")},FormatBlock:function(a,b,c){return l(c||"p")},mceCleanup:function(){var b=n.getBookmark();
d.setContent(d.getContent({cleanup:a}),{cleanup:a});n.moveToBookmark(b)},mceRemoveNode:function(b,c,e){b=e||n.getNode();b!=d.getBody()&&(s=n.getBookmark(void 0),d.dom.remove(b,a),n.moveToBookmark(s))},mceSelectNodeDepth:function(a,c,e){var g=0;m.getParent(n.getNode(),function(a){if(1==a.nodeType&&g++==e)return n.select(a),b},d.getBody())},mceSelectNode:function(a,b,c){n.select(c)},mceInsertContent:function(a,b,c){var e,g,h,k,l;e=d.parser;g=new f.html.Serializer({},d.schema);a={content:c,format:"html"};
n.onBeforeSetContent.dispatch(n,a);c=a.content;-1==c.indexOf("{$caret}")&&(c+="{$caret}");c=c.replace(/\{\$caret\}/,'<span id="mce_marker" data-mce-type="bookmark">\ufeff</span>');n.isCollapsed()||d.getDoc().execCommand("Delete",!1,null);h=n.getNode();a={context:h.nodeName.toLowerCase()};l=e.parse(c,a);b=l.lastChild;if("mce_marker"==b.attr("id")){c=b;for(b=b.prev;b;b=b.walk(!0))if(3==b.type||!m.isBlock(b.name)){b.parent.insert(c,b,"br"===b.name);break}}if(a.invalid){n.setContent('<span id="mce_marker" data-mce-type="bookmark">\ufeff</span>');
h=d.selection.getNode();k=d.getBody();for(9==h.nodeType?h=b=k:b=h;b!==k;)h=b,b=b.parentNode;c=h==k?k.innerHTML:m.getOuterHTML(h);c=g.serialize(e.parse(c.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return g.serialize(l)})));h==k?m.setHTML(k,c):m.setOuterHTML(h,c)}else c=g.serialize(l),b=h.firstChild,e=h.lastChild,!b||b===e&&"BR"===b.nodeName?m.setHTML(h,c):n.setContent(c);c=m.get("mce_marker");b=m.getRect(c);h=m.getViewPort(d.getWin());if(b.y+b.h>h.y+h.h||b.y<h.y||b.x>h.x+
h.w||b.x<h.x)e=f.isIE?d.getDoc().documentElement:d.getBody(),e.scrollLeft=b.x,e.scrollTop=b.y-h.h+25;h=m.createRng();(b=c.previousSibling)&&3==b.nodeType?h.setStart(b,b.nodeValue.length):(h.setStartBefore(c),h.setEndBefore(c));m.remove(c);n.setRng(h);n.onSetContent.dispatch(n,a);d.addVisual()},mceInsertRawHTML:function(a,b,c){n.setContent("tiny_mce_marker");d.setContent(d.getContent().replace(/tiny_mce_marker/g,function(){return c}))},mceSetContent:function(a,b,c){d.setContent(c)},"Indent,Outdent":function(a){var b,
d,e;b=p.indentation;d=/[a-z%]+$/i.exec(b);b=parseInt(b);!g("InsertUnorderedList")&&!g("InsertOrderedList")?(!p.forced_root_block&&!m.getParent(n.getNode(),m.isBlock)&&q.apply("div"),c(n.getSelectedBlocks(),function(c){"outdent"==a?(e=Math.max(0,parseInt(c.style.paddingLeft||0)-b),m.setStyle(c,"paddingLeft",e?e+d:"")):m.setStyle(c,"paddingLeft",parseInt(c.style.paddingLeft||0)+b+d)})):k(a)},mceRepaint:function(){if(f.isGecko)try{s=n.getBookmark(a),n.getSel()&&n.getSel().selectAllChildren(d.getBody()),
n.collapse(a),n.moveToBookmark(s)}catch(b){}},mceToggleFormat:function(a,b,c){q.toggle(c)},InsertHorizontalRule:function(){d.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){d.hasVisual=!d.hasVisual;d.addVisual()},mceReplaceContent:function(a,b,c){d.execCommand("mceInsertContent",!1,c.replace(/\{\$selection\}/g,n.getContent({format:"text"})))},mceInsertLink:function(a,b,c){"string"==typeof c&&(c={href:c});a=m.getParent(n.getNode(),"a");c.href=c.href.replace(" ","%20");(!a||
!c.href)&&q.remove("link");c.href&&q.apply("link",c,a)},selectAll:function(){var a=m.getRoot(),b=m.createRng();b.setStart(a,0);b.setEnd(a,a.childNodes.length);d.selection.setRng(b)}});h({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(b){var c="align"+b.substring(7),b=n.isCollapsed()?[m.getParent(n.getNode(),m.isBlock)]:n.getSelectedBlocks(),b=f.map(b,function(a){return!!q.matchNode(a,c)});return-1!==f.inArray(b,a)},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(a){return q.match(a)},
mceBlockQuote:function(){return q.match("blockquote")},Outdent:function(){var b;return p.inline_styles&&((b=m.getParent(n.getStart(),m.isBlock))&&0<parseInt(b.style.paddingLeft)||(b=m.getParent(n.getEnd(),m.isBlock))&&0<parseInt(b.style.paddingLeft))?a:g("InsertUnorderedList")||g("InsertOrderedList")||!p.inline_styles&&!!m.getParent(n.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(a){return m.getParent(n.getNode(),"insertunorderedlist"==a?"UL":"OL")}},"state");h({"FontSize,FontName":function(a){var b=
0,c;if(c=m.getParent(n.getNode(),"span"))b="fontsize"==a?c.style.fontSize:c.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase();return b}},"value");h({Undo:function(){d.undoManager.undo()},Redo:function(){d.undoManager.redo()}})}})(tinymce);
(function(f){var c=f.util.Dispatcher;f.UndoManager=function(a){function b(){d.typing=!1;d.add()}var d,e=0,g=[],h,k,l,m;onBeforeAdd=new c(d);k=new c(d);l=new c(d);m=new c(d);k.add(function(b,c){if(b.hasUndo())return a.onChange.dispatch(a,c,b)});l.add(function(b,c){return a.onUndo.dispatch(a,c,b)});m.add(function(b,c){return a.onRedo.dispatch(a,c,b)});a.onInit.add(function(){d.add()});a.onBeforeExecCommand.add(function(a,b,c,e,g){"Undo"!=b&&"Redo"!=b&&"mceRepaint"!=b&&(!g||!g.skip_undo)&&d.beforeChange()});
a.onExecCommand.add(function(a,b,c,e,g){"Undo"!=b&&"Redo"!=b&&"mceRepaint"!=b&&(!g||!g.skip_undo)&&d.add()});a.onSaveContent.add(b);a.dom.bind(a.dom.getRoot(),"dragend",b);a.dom.bind(a.getDoc(),f.isGecko?"blur":"focusout",function(){!a.removed&&d.typing&&b()});a.onKeyUp.add(function(a,c){var d=c.keyCode;(33<=d&&36>=d||37<=d&&40>=d||45==d||13==d||c.ctrlKey)&&b()});a.onKeyDown.add(function(a,c){var e=c.keyCode;if(33<=e&&36>=e||37<=e&&40>=e||45==e)d.typing&&b();else if((16>e||20<e)&&224!=e&&91!=e&&!d.typing)d.beforeChange(),
d.typing=!0,d.add()});a.onMouseDown.add(function(){d.typing&&b()});a.addShortcut("ctrl+z","undo_desc","Undo");a.addShortcut("ctrl+y","redo_desc","Redo");return d={data:g,typing:!1,onBeforeAdd:onBeforeAdd,onAdd:k,onUndo:l,onRedo:m,beforeChange:function(){h=a.selection.getBookmark(2,!0)},add:function(b){var c;c=a.settings;var k,b=b||{};b.content=f.trim(a.getContent({format:"raw",no_events:1}).replace(/<span[^>]+data-mce-bogus[^>]+>[\u200B\uFEFF]+<\/span>/g,""));d.onBeforeAdd.dispatch(d,b);if((k=g[e])&&
k.content==b.content)return null;g[e]&&(g[e].beforeBookmark=h);if(c.custom_undo_redo_levels&&g.length>c.custom_undo_redo_levels){for(c=0;c<g.length-1;c++)g[c]=g[c+1];g.length--;e=g.length}b.bookmark=a.selection.getBookmark(2,!0);e<g.length-1&&(g.length=e+1);g.push(b);e=g.length-1;d.onAdd.dispatch(d,b);a.isNotDirty=0;return b},undo:function(){var b;d.typing&&(d.add(),d.typing=!1);0<e&&(b=g[--e],a.setContent(b.content,{format:"raw"}),a.selection.moveToBookmark(b.beforeBookmark),d.onUndo.dispatch(d,
b));return b},redo:function(){var b;e<g.length-1&&(b=g[++e],a.setContent(b.content,{format:"raw"}),a.selection.moveToBookmark(b.bookmark),d.onRedo.dispatch(d,b));return b},clear:function(){g=[];e=0;d.typing=!1},hasUndo:function(){return 0<e||this.typing},hasRedo:function(){return e<g.length-1&&!this.typing}}}})(tinymce);
tinymce.ForceBlocks=function(f){function c(){var c=d.getStart(),h=f.getBody(),k,l,m,n,o,p,q,s,t;if(c&&1===c.nodeType&&a.forced_root_block){for(;c&&c!=h;){if(e[c.nodeName])return;c=c.parentNode}k=d.getRng();if(k.setStart)l=k.startContainer,m=k.startOffset,n=k.endContainer,o=k.endOffset;else if(k.item&&(c=k.item(0),k=f.getDoc().body.createTextRange(),k.moveToElementText(c)),t=k.parentElement().ownerDocument===f.getDoc(),tmpRng=k.duplicate(),tmpRng.collapse(!0),m=-1*tmpRng.move("character",-16777215),
!tmpRng.collapsed)tmpRng=k.duplicate(),tmpRng.collapse(!1),o=-1*tmpRng.move("character",-16777215)-m;for(c=h.firstChild;c;)3===c.nodeType||1==c.nodeType&&!e[c.nodeName]?(p||(p=b.create(a.forced_root_block),c.parentNode.insertBefore(p,c),s=!0),q=c,c=c.nextSibling,p.appendChild(q)):(p=null,c=c.nextSibling);if(s){if(k.setStart)k.setStart(l,m),k.setEnd(n,o),d.setRng(k);else if(t)try{k=f.getDoc().body.createTextRange(),k.moveToElementText(h),k.collapse(!0),k.moveStart("character",m),0<o&&k.moveEnd("character",
o),k.select()}catch(r){}f.nodeChanged()}}}var a=f.settings,b=f.dom,d=f.selection,e=f.schema.getBlockElements();a.forced_root_block&&(f.onKeyUp.add(c),f.onNodeChange.add(c))};
(function(f){var c=f.dom.Event,a=f.each,b=f.extend;f.create("tinymce.ControlManager",{ControlManager:function(b,c){var g=this,c=c||{};g.editor=b;g.controls={};g.onAdd=new f.util.Dispatcher(g);g.onPostRender=new f.util.Dispatcher(g);g.prefix=c.prefix||b.id+"_";g._cls={};g.onPostRender.add(function(){a(g.controls,function(a){a.postRender()})})},get:function(a){return this.controls[this.prefix+a]||this.controls[a]},setActive:function(a,b){var c=null;(c=this.get(a))&&c.setActive(b);return c},setDisabled:function(a,
b){var c=null;(c=this.get(a))&&c.setDisabled(b);return c},add:function(a){a&&(this.controls[a.id]=a,this.onAdd.dispatch(a,this));return a},createControl:function(b){var c,g,f,k=this,l=k.editor,m;k.controlFactories||(k.controlFactories=[],a(l.plugins,function(a){a.createControl&&k.controlFactories.push(a)}));m=k.controlFactories;g=0;for(f=m.length;g<f;g++)if(c=m[g].createControl(b,k))return k.add(c);return"|"===b||"separator"===b?k.createSeparator():l.buttons&&(c=l.buttons[b])?k.createButton(b,c):
k.add(c)},createDropMenu:function(a,c,g){var h=this.editor,k,l,m,c=b({"class":"mceDropDown",constrain:h.settings.constrain_menus},c);c["class"]=c["class"]+" "+h.getParam("skin")+"Skin";if(m=h.getParam("skin_variant"))c["class"]+=" "+h.getParam("skin")+"Skin"+m.substring(0,1).toUpperCase()+m.substring(1);c["class"]+="rtl"==h.settings.directionality?" mceRtl":"";a=this.prefix+a;k=this.controls[a]=new (g||this._cls.dropmenu||f.ui.DropMenu)(a,c);k.onAddItem.add(function(a,b){var c=b.settings;c.title=
h.getLang(c.title,c.title);c.onclick||(c.onclick=function(){c.cmd&&h.execCommand(c.cmd,c.ui||!1,c.value)})});h.onRemove.add(function(){k.destroy()});f.isIE&&(k.onShowMenu.add(function(){h.focus();l=h.selection.getBookmark(1)}),k.onHideMenu.add(function(){l&&(h.selection.moveToBookmark(l),l=0)}));return this.add(k)},createListBox:function(a,e,g){var h=this.editor;if(this.get(a))return null;e.title=h.translate(e.title);e.scope=e.scope||h;e.onselect||(e.onselect=function(a){h.execCommand(e.cmd,e.ui||
!1,a||e.value)});e=b({title:e.title,"class":"mce_"+a,scope:e.scope,control_manager:this},e);a=this.prefix+a;h.settings.use_native_selects||h.settings.use_accessible_selects&&!f.isGecko?g=new f.ui.NativeListBox(a,e):(g=g||this._cls.listbox||f.ui.ListBox,g=new g(a,e,h));this.controls[a]=g;f.isWebKit&&g.onPostRender.add(function(a,b){c.add(b,"mousedown",function(){h.bookmark=h.selection.getBookmark(1)});c.add(b,"focus",function(){h.selection.moveToBookmark(h.bookmark);h.bookmark=null})});g.hideMenu&&
h.onMouseDown.add(g.hideMenu,g);return this.add(g)},createButton:function(a,c,g){var h=this.editor;if(this.get(a))return null;c.title=h.translate(c.title);c.label=h.translate(c.label);c.scope=c.scope||h;!c.onclick&&!c.menu_button&&(c.onclick=function(){h.execCommand(c.cmd,c.ui||!1,c.value)});c=b({title:c.title,"class":"mce_"+a,unavailable_prefix:h.getLang("unavailable",""),scope:c.scope,control_manager:this},c);a=this.prefix+a;c.menu_button?(g=g||this._cls.menubutton||f.ui.MenuButton,a=new g(a,c,
h),h.onMouseDown.add(a.hideMenu,a)):(g=this._cls.button||f.ui.Button,a=new g(a,c,h));return this.add(a)},createMenuButton:function(a,b,c){b=b||{};b.menu_button=1;return this.createButton(a,b,c)},createSplitButton:function(a,c,g){var h=this.editor;if(this.get(a))return null;c.title=h.translate(c.title);c.scope=c.scope||h;c.onclick||(c.onclick=function(a){h.execCommand(c.cmd,c.ui||!1,a||c.value)});c.onselect||(c.onselect=function(a){h.execCommand(c.cmd,c.ui||false,a||c.value)});c=b({title:c.title,"class":"mce_"+
a,scope:c.scope,control_manager:this},c);a=this.prefix+a;a=this.add(new (g||this._cls.splitbutton||f.ui.SplitButton)(a,c,h));h.onMouseDown.add(a.hideMenu,a);return a},createColorSplitButton:function(a,c,g){var h=this.editor,k,l;if(this.get(a))return null;c.title=h.translate(c.title);c.scope=c.scope||h;c.onclick||(c.onclick=function(a){f.isIE&&(l=h.selection.getBookmark(1));h.execCommand(c.cmd,c.ui||!1,a||c.value)});c.onselect||(c.onselect=function(a){h.execCommand(c.cmd,c.ui||false,a||c.value)});
c=b({title:c.title,"class":"mce_"+a,menu_class:h.getParam("skin")+"Skin",scope:c.scope,more_colors_title:h.getLang("more_colors")},c);a=this.prefix+a;k=new (g||this._cls.colorsplitbutton||f.ui.ColorSplitButton)(a,c,h);h.onMouseDown.add(k.hideMenu,k);h.onRemove.add(function(){k.destroy()});f.isIE&&(k.onShowMenu.add(function(){h.focus();l=h.selection.getBookmark(1)}),k.onHideMenu.add(function(){if(l){h.selection.moveToBookmark(l);l=0}}));return this.add(k)},createToolbar:function(a,b,c){a=this.prefix+
a;b=new (c||this._cls.toolbar||f.ui.Toolbar)(a,b,this.editor);return this.get(a)?null:this.add(b)},createToolbarGroup:function(a,b,c){a=this.prefix+a;b=new (c||this._cls.toolbarGroup||f.ui.ToolbarGroup)(a,b,this.editor);return this.get(a)?null:this.add(b)},createSeparator:function(a){return new (a||this._cls.separator||f.ui.Separator)},setControlType:function(a,b){return this._cls[a.toLowerCase()]=b},destroy:function(){a(this.controls,function(a){a.destroy()});this.controls=null}})})(tinymce);
(function(f){var c=f.util.Dispatcher,a=f.each,b=f.isIE,d=f.isOpera;f.create("tinymce.WindowManager",{WindowManager:function(a){this.editor=a;this.onOpen=new c(this);this.onClose=new c(this);this.params={};this.features={}},open:function(c,g){var h="",k="modal"==this.editor.settings.dialog_type,l,m,n;n=f.DOM.getViewPort();c=c||{};g=g||{};m=d?n.w:screen.width;n=d?n.h:screen.height;c.name=c.name||"mc_"+(new Date).getTime();c.width=parseInt(c.width||320);c.height=parseInt(c.height||240);c.resizable=!0;
c.left=c.left||parseInt(m/2)-c.width/2;c.top=c.top||parseInt(n/2)-c.height/2;g.inline=!1;g.mce_width=c.width;g.mce_height=c.height;g.mce_auto_focus=c.auto_focus;k&&b&&(c.center=!0,c.help=!1,c.dialogWidth=c.width+"px",c.dialogHeight=c.height+"px",c.scroll=c.scrollbars||!1);a(c,function(a,c){f.is(a,"boolean")&&(a=a?"yes":"no");/^(name|url)$/.test(c)||(h=b&&k?h+((h?";":"")+c+":"+a):h+((h?",":"")+c+"="+a))});this.features=c;this.params=g;this.onOpen.dispatch(this,c,g);m=c.url||c.file;m=f._addVer(m);try{b&&
k?(l=1,window.showModalDialog(m,window,h)):l=window.open(m,c.name,h)}catch(o){}l||alert(this.editor.getLang("popup_blocked"))},close:function(a){a.close();this.onClose.dispatch(this)},createInstance:function(a,b,c,d,l,m){return new (f.resolve(a))(b,c,d,l,m)},confirm:function(a,b,c,d){b.call(c||this,(d||window).confirm(this._decode(this.editor.getLang(a,a))))},alert:function(a,b,c,d){(d||window).alert(this._decode(this.editor.getLang(a,a)));b&&b.call(c||this)},resizeBy:function(a,b,c){c.resizeBy(a,
b)},_decode:function(a){return f.DOM.decode(a).replace(/\\n/g,"\n")}})})(tinymce);
(function(f){f.Formatter=function(c){function a(a,b){return y.getParents(a,b,y.getRoot())}function b(a){return 1===a.nodeType&&"_mce_caret"===a.id}function d(a){return a?E[a]:E}function e(a,b){a&&("string"!==typeof a?C(a,function(a,b){e(b,a)}):(b=b.length?b:[b],C(b,function(a){a.deep===R&&(a.deep=!a.selector);a.split===R&&(a.split=!a.selector||a.inline);a.remove===R&&a.selector&&!a.inline&&(a.remove="none");a.selector&&a.inline&&(a.mixed=!0,a.block_expand=!0);"string"===typeof a.classes&&(a.classes=
a.classes.split(/\s+/))}),E[a]=b))}function g(a,e,h){function l(a,b){b=b||E;if(a){if(b.onformat)b.onformat(a,b,e,h);C(b.styles,function(b,c){y.setStyle(a,c,p(b,e))});C(b.attributes,function(b,c){y.setAttrib(a,c,p(b,e))});C(b.classes,function(b){b=p(b,e);y.hasClass(a,b)||y.addClass(a,b)})}}function o(){var a=c.selection.getRng(),b=a.startContainer,d=a.endContainer;if(b!=d&&0===a.endOffset){a:{d=new G(d);for(h=d.current();h;h=d.prev())if(1<h.childNodes.length||h==b||"BR"==h.tagName){b=h;break a}b=void 0}a.setEnd(b,
3==b.nodeType?b.length:b.childNodes.length)}return a}function s(a,b,c,d,e){var g=[],h=-1,k,l=-1,o=-1,m;C(a.childNodes,function(a,b){if("UL"===a.nodeName||"OL"===a.nodeName)return h=b,k=a,!1});C(a.childNodes,function(a,c){"SPAN"===a.nodeName&&"bookmark"==y.getAttrib(a,"data-mce-type")&&(a.id==b.id+"_start"?l=c:a.id==b.id+"_end"&&(o=c))});if(0>=h||l<h&&o>h)return C(f.grep(a.childNodes),e),0;m=y.clone(c,J);C(f.grep(a.childNodes),function(a,b){if(l<h&&b<h||l>h&&b>h)g.push(a),a.parentNode.removeChild(a)});
l<h?a.insertBefore(m,k):l>h&&a.insertBefore(m,k.nextSibling);d.push(m);C(g,function(a){m.appendChild(a)});return m}function u(c,d,g){var h=[],o,p,t=!0;o=E.inline||E.block;p=y.create(o);l(p);L.walk(c,function(c){function m(c){var q,u,x,A,D;D=t;q=c.nodeName.toLowerCase();u=c.parentNode.nodeName.toLowerCase();1===c.nodeType&&S(c)&&(D=t,t="true"===S(c),A=!0);if(n(q,"br"))r=0,E.block&&y.remove(c);else if(E.wrapper&&k(c,a,e))r=0;else if(t&&!A&&E.block&&!E.wrapper&&/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(q))c=
y.rename(c,o),l(c),h.push(c),r=0;else{if(E.selector&&(C(v,function(a){if(!("collapsed"in a&&a.collapsed!==W)&&y.is(c,a.selector)&&!b(c)){l(c,a);x=true}}),!E.inline||x)){r=0;return}t&&!A&&O(o,q)&&O(u,o)&&(g||!(3===c.nodeType&&1===c.nodeValue.length&&65279===c.nodeValue.charCodeAt(0)))&&!b(c)?(r||(r=y.clone(p,J),c.parentNode.insertBefore(r,c),h.push(r)),r.appendChild(c)):"li"==q&&d?r=s(c,d,p,h,m):(r=0,C(f.grep(c.childNodes),m),A&&(t=D),r=0)}}var r;C(c,m)});!1===E.wrap_links&&C(h,function(a){function b(a){var c,
d,e;if("A"===a.nodeName){d=y.clone(p,J);h.push(d);e=f.grep(a.childNodes);for(c=0;c<e.length;c++)d.appendChild(e[c]);a.appendChild(d)}C(f.grep(a.childNodes),b)}b(a)});C(h,function(c){function d(a){var c,e;C(a.childNodes,function(a){if(1==a.nodeType&&!x(a)&&!b(a))return c=a,J});c&&m(c,E)&&(e=y.clone(c,J),l(e),y.replace(e,a,I),y.remove(c,1));return e||a}var g;g=function(a){var b=0;C(a.childNodes,function(a){!q(a)&&!x(a)&&b++});return b}(c);if((1<h.length||!H(c))&&0===g)y.remove(c,1);else if(E.inline||
E.wrapper){!E.exact&&1===g&&(c=d(c));C(v,function(a){C(y.select(a.inline,c),function(b){var c;if(!1===a.wrap_links){c=b.parentNode;do if("A"===c.nodeName)return;while(c=c.parentNode)}r(a,e,b,a.exact?b:null)})});if(k(c.parentNode,a,e))return y.remove(c,1),c=0,I;E.merge_with_parents&&y.getParent(c.parentNode,function(b){if(k(b,a,e))return y.remove(c,1),c=0,I});c&&!1!==E.merge_siblings&&(c=A(D(c),c),c=A(c,D(c,I)))}})}var v=d(a),E=v[0],Q,W=F.isCollapsed();if(E)if(h)h.nodeType?(Q=y.createRng(),Q.setStartBefore(h),
Q.setEndAfter(h),u(t(Q,v),null,!0)):u(h,null,!0);else if(!W||!E.inline||y.select("td.mceSelected,th.mceSelected").length){var K=c.selection.getNode();!M&&v[0].defaultBlock&&!y.getParent(K,y.isBlock)&&g(v[0].defaultBlock);c.selection.setRng(o());Q=F.getBookmark();u(t(F.getRng(I),v),Q);if(E.styles&&(E.styles.color||E.styles.textDecoration))f.walk(K,V,"childNodes"),V(K);F.moveToBookmark(Q);B(F.getRng(I));c.nodeChanged()}else z("apply",a,e)}function h(b,e,g){function h(a){var b,c,d,g,k;1===a.nodeType&&
S(a)&&(g=D,D="true"===S(a),k=!0);b=f.grep(a.childNodes);if(D&&!k){c=0;for(d=q.length;c<d&&!r(q[c],e,a,a);c++);}if(u.deep&&b.length){c=0;for(d=b.length;c<d;c++)h(b[c]);k&&(D=g)}}function o(c){var d;C(a(c.parentNode).reverse(),function(a){var c;!d&&"_start"!=a.id&&"_end"!=a.id&&(c=k(a,b,e))&&!1!==c.split&&(d=a)});return d}function m(a,b,c,d){var g,f,h,k,l,o;if(a){o=a.parentNode;for(g=b.parentNode;g&&g!=o;g=g.parentNode){f=y.clone(g,J);for(l=0;l<q.length;l++)if(r(q[l],e,f,f)){f=0;break}f&&(h&&f.appendChild(h),
k||(k=f),h=f)}if(d&&(!u.mixed||!H(a)))b=y.split(a,b);h&&(c.parentNode.insertBefore(h,c),k.appendChild(c))}return b}function p(a){var b=y.get(a?"_start":"_end"),c=b[a?"firstChild":"lastChild"];x(c)&&(c=c[a?"firstChild":"lastChild"]);y.remove(b,!0);return c}function n(a){var b,d,a=t(a,q,I);u.split&&(b=v(a,I),d=v(a),b!=d?(/^(TR|TD)$/.test(b.nodeName)&&b.firstChild&&(b=("TD"==b.nodeName?b.firstChild:b.firstChild.firstChild)||b),b=s(b,"span",{id:"_start","data-mce-type":"bookmark"}),d=s(d,"span",{id:"_end",
"data-mce-type":"bookmark"}),m(o(b),b,b,!0),m(o(d),d,d,!0),b=p(I),d=p()):b=d=m(o(b),b,b,!0),a.startContainer=b.parentNode,a.startOffset=K(b),a.endContainer=d.parentNode,a.endOffset=K(d)+1);L.walk(a,function(a){C(a,function(a){h(a);a.nodeType===1&&c.dom.getStyle(a,"text-decoration")==="underline"&&a.parentNode&&U(a.parentNode)==="underline"&&r({deep:false,exact:true,inline:"span",styles:{textDecoration:"underline"}},null,a)})})}var q=d(b),u=q[0],A,D=!0;g?g.nodeType?(A=y.createRng(),A.setStartBefore(g),
A.setEndAfter(g),n(A)):n(g):!F.isCollapsed()||!u.inline||y.select("td.mceSelected,th.mceSelected").length?(g=F.getBookmark(),n(F.getRng(I)),F.moveToBookmark(g),u.inline&&l(b,e,F.getStart())&&B(F.getRng(!0)),c.nodeChanged()):z("remove",b,e)}function k(a,b,c,e){function g(a,b,d){var f,h,k=b[d];if(b.onmatch)return b.onmatch(a,b,d);if(k)if(k.length===R)for(f in k){if(k.hasOwnProperty(f)&&(h="attributes"===d?y.getAttrib(a,f):o(a,f),e&&!h&&!b.exact||(!e||b.exact)&&!n(h,p(k[f],c))))return}else for(f=0;f<
k.length&&!("attributes"===d?y.getAttrib(a,k[f]):o(a,k[f]));f++);return b}var f=d(b),h;if(f&&a)for(h=0;h<f.length;h++)if(b=f[h],m(a,b)&&g(a,b,"attributes")&&g(a,b,"styles")){if(f=b.classes)for(h=0;h<f.length;h++)if(!y.hasClass(a,f[h]))return;return b}}function l(a,b,c){function d(c){c=y.getParent(c,function(c){return!!k(c,a,b,!0)});return k(c,a,b)}var e;if(c)return d(c);c=F.getNode();if(d(c))return I;e=F.getStart();return e!=c&&d(e)?I:J}function m(a,b){if(n(a,b.inline)||n(a,b.block))return I;if(b.selector)return y.is(a,
b.selector)}function n(a,b){a=a||"";b=b||"";a=""+(a.nodeName||a);b=""+(b.nodeName||b);return a.toLowerCase()==b.toLowerCase()}function o(a,b){var c=y.getStyle(a,b);if("color"==b||"backgroundColor"==b)c=y.toHex(c);"fontWeight"==b&&700==c&&(c="bold");return""+c}function p(a,b){"string"!=typeof a?a=a(b):b&&(a=a.replace(/%(\w+)/g,function(a,c){return b[c]||a}));return a}function q(a){return a&&3===a.nodeType&&/^([\t \r\n]+|)$/.test(a.nodeValue)}function s(a,b,c){b=y.create(b,c);a.parentNode.insertBefore(b,
a);b.appendChild(a);return b}function t(b,d,e){function g(a){var b,c,e,f;b=c=a?p:s;e=a?"previousSibling":"nextSibling";f=y.getRoot();if(3==b.nodeType&&!q(b)&&(a?0<r:t<b.nodeValue.length))return b;for(;;){if(!d[0].block_expand&&H(c))return c;for(a=c[e];a;a=a[e])if(!x(a)&&!q(a))return c;if(c.parentNode==f){b=c;break}c=c.parentNode}return b}function f(a,b){for(b===R&&(b=3===a.nodeType?a.length:a.childNodes.length);a&&a.hasChildNodes();)(a=a.childNodes[b])&&(b=3===a.nodeType?a.length:a.childNodes.length);
return{node:a,offset:b}}function h(a){for(var b=a;b;){if(1===b.nodeType&&S(b))return"false"===S(b)?b:a;b=b.parentNode}return a}function k(a,b,d){function g(a,b){var c,f;f=a.nodeValue;"undefined"==typeof b&&(b=d?f.length:0);d?(c=f.lastIndexOf(" ",b),f=f.lastIndexOf("\u00a0",b),c=c>f?c:f,-1!==c&&!e&&c++):(c=f.indexOf(" ",b),f=f.indexOf("\u00a0",b),c=-1!==c&&(-1===f||c<f)?c:f);return c}var f,h;if(3===a.nodeType){b=g(a,b);if(-1!==b)return{container:a,offset:b};h=a}for(a=new G(a,y.getParent(a,H)||c.getBody());f=
a[d?"prev":"next"]();)if(3===f.nodeType){if(h=f,b=g(f),-1!==b)return{container:f,offset:b}}else if(H(f))break;if(h)return b=d?0:h.length,{container:h,offset:b}}function l(c,e){var g,f,h,k;3==c.nodeType&&0===c.nodeValue.length&&c[e]&&(c=c[e]);g=a(c);for(f=0;f<g.length;f++)for(h=0;h<d.length;h++)if(k=d[h],!("collapsed"in k&&k.collapsed!==b.collapsed)&&y.is(g[f],k.selector))return g[f];return c}function o(b,c){var e;d[0].wrapper||(e=y.getParent(b,d[0].block));e||(e=y.getParent(3==b.nodeType?b.parentNode:
b,H));e&&d[0].wrapper&&(e=a(e,"ul,ol").reverse()[0]||e);if(!e)for(e=b;e[c]&&!H(e[c])&&!(e=e[c],n(e,"br")););return e||b}var m,p=b.startContainer,r=b.startOffset,s=b.endContainer,t=b.endOffset;1==p.nodeType&&p.hasChildNodes()&&(m=p.childNodes.length-1,p=p.childNodes[r>m?m:r],3==p.nodeType&&(r=0));1==s.nodeType&&s.hasChildNodes()&&(m=s.childNodes.length-1,s=s.childNodes[t>m?m:t-1],3==s.nodeType&&(t=s.nodeValue.length));p=h(p);s=h(s);if(x(p.parentNode)||x(p))p=x(p)?p:p.parentNode,p=p.nextSibling||p,
3==p.nodeType&&(r=0);if(x(s.parentNode)||x(s))s=x(s)?s:s.parentNode,s=s.previousSibling||s,3==s.nodeType&&(t=s.length);if(d[0].inline){if(b.collapsed){if(m=k(p,r,!0))p=m.container,r=m.offset;if(m=k(s,t))s=m.container,t=m.offset}m=f(s,t);if(m.node){for(;m.node&&0===m.offset&&m.node.previousSibling;)m=f(m.node.previousSibling);m.node&&0<m.offset&&3===m.node.nodeType&&" "===m.node.nodeValue.charAt(m.offset-1)&&1<m.offset&&(s=m.node,s.splitText(m.offset-1))}}if(d[0].inline||d[0].block_expand){if(!d[0].inline||
3!=p.nodeType||0===r)p=g(!0);if(!d[0].inline||3!=s.nodeType||t===s.nodeValue.length)s=g()}d[0].selector&&d[0].expand!==J&&!d[0].inline&&(p=l(p,"previousSibling"),s=l(s,"nextSibling"));if(d[0].block||d[0].selector)p=o(p,"previousSibling"),s=o(s,"nextSibling"),d[0].block&&(H(p)||(p=g(!0)),H(s)||(s=g()));1==p.nodeType&&(r=K(p),p=p.parentNode);1==s.nodeType&&(t=K(s)+1,s=s.parentNode);return{startContainer:p,startOffset:r,endContainer:s,endOffset:t}}function r(a,b,c,d){var e,g,f;if(!m(c,a))return J;if("all"!=
a.remove){C(a.styles,function(a,e){a=p(a,b);"number"===typeof e&&(e=a,d=0);(!d||n(o(d,e),a))&&y.setStyle(c,e,"");f=1});f&&""==y.getAttrib(c,"style")&&(c.removeAttribute("style"),c.removeAttribute("data-mce-style"));C(a.attributes,function(a,e){var g,a=p(a,b);if(typeof e==="number"){e=a;d=0}if(!d||n(y.getAttrib(d,e),a)){if(e=="class")if(a=y.getAttrib(c,e)){g="";C(a.split(/\s+/),function(a){/mce\w+/.test(a)&&(g=g+((g?" ":"")+a))});if(g){y.setAttrib(c,e,g);return}}e=="class"&&c.removeAttribute("className");
T.test(e)&&c.removeAttribute("data-mce-"+e);c.removeAttribute(e)}});C(a.classes,function(a){a=p(a,b);(!d||y.hasClass(d,a))&&y.removeClass(c,a)});g=y.getAttribs(c);for(e=0;e<g.length;e++)if(0!==g[e].nodeName.indexOf("_"))return J}if("none"!=a.remove)return u(c,a),I}function u(a,b){function c(a,b,d){a=D(a,b,d);return!a||"BR"==a.nodeName||H(a)}var d=a.parentNode,e;b.block&&(M?d==y.getRoot()&&(!b.list_block||!n(a,b.list_block))&&C(f.grep(a.childNodes),function(a){O(M,a.nodeName.toLowerCase())?e?e.appendChild(a):
e=s(a,M):e=0}):H(a)&&!H(d)&&(!c(a,J)&&!c(a.firstChild,I,1)&&a.insertBefore(y.create("br"),a.firstChild),!c(a,I)&&!c(a.lastChild,J,1)&&a.appendChild(y.create("br"))));(!b.selector||!b.inline||n(b.inline,a))&&y.remove(a,1)}function D(a,b,c){if(a){b=b?"nextSibling":"previousSibling";for(a=c?a:a[b];a;a=a[b])if(1==a.nodeType||!q(a))return a}}function x(a){return a&&1==a.nodeType&&"bookmark"==a.getAttribute("data-mce-type")}function A(a,b){function c(a,b){function d(a){var b={};C(y.getAttribs(a),function(c){c=
c.nodeName.toLowerCase();0!==c.indexOf("_")&&"style"!==c&&(b[c]=y.getAttrib(a,c))});return b}function e(a,b){var c,d;for(d in a)if(a.hasOwnProperty(d)){c=b[d];if(c===R||a[d]!=c)return J;delete b[d]}for(d in b)if(b.hasOwnProperty(d))return J;return I}return a.nodeName!=b.nodeName||!e(d(a),d(b))||!e(y.parseStyle(y.getAttrib(a,"style")),y.parseStyle(y.getAttrib(b,"style")))?J:I}function d(a,b){for(e=a;e&&!(3==e.nodeType&&0!==e.nodeValue.length);e=e[b])if(1==e.nodeType&&!x(e))return e;return a}var e,
g;if(a&&b&&(a=d(a,"previousSibling"),b=d(b,"nextSibling"),c(a,b))){for(e=a.nextSibling;e&&e!=b;)g=e,e=e.nextSibling,a.appendChild(g);y.remove(b);C(f.grep(b.childNodes),function(b){a.appendChild(b)});return a}return b}function v(a,b){var d,e,g;d=a[b?"startContainer":"endContainer"];e=a[b?"startOffset":"endOffset"];1==d.nodeType&&(g=d.childNodes.length-1,!b&&e&&e--,d=d.childNodes[e>g?g:e]);3===d.nodeType&&b&&e>=d.nodeValue.length&&(d=(new G(d,c.getBody())).next()||d);3===d.nodeType&&!b&&0===e&&(d=(new G(d,
c.getBody())).prev()||d);return d}function z(a,b,e){function l(a){var b=y.create("span",{id:u,"data-mce-bogus":!0,style:x?"color:red":""});a&&b.appendChild(c.getDoc().createTextNode(N));return b}function o(a,b){for(;a;){if(3===a.nodeType&&a.nodeValue!==N||1<a.childNodes.length)return!1;b&&1===a.nodeType&&b.push(a);a=a.firstChild}return!0}function m(a){for(;a;){if(a.id===u)return a;a=a.parentNode}}function p(a){var b;if(a){b=new G(a,a);for(a=b.current();a;a=b.next())if(3===a.nodeType)return a}}function r(a,
b){var c,d;if(a)d=F.getRng(!0),o(a)?(!1!==b&&(d.setStartBefore(a),d.setEndBefore(a)),y.remove(a)):(c=p(a),c.nodeValue.charAt(0)===N&&c.deleteData(0,1),y.remove(a,1)),F.setRng(d);else if(a=m(F.getStart()),!a)for(;a=y.get(u);)r(a,!1)}function n(){var a,c,f,h,k;a=F.getRng(!0);h=a.startOffset;k=a.startContainer.nodeValue;(c=m(F.getStart()))&&(f=p(c));if(k&&0<h&&h<k.length&&/\w/.test(k.charAt(h))&&/\w/.test(k.charAt(h-1)))c=F.getBookmark(),a.collapse(!0),a=t(a,d(b)),a=L.split(a),g(b,e,a),F.moveToBookmark(c);
else{if(!c||f.nodeValue!==N)c=l(!0),f=c.firstChild,a.insertNode(c),h=1;g(b,e,c);F.setCursorLocation(f,h)}}function q(){var a=F.getRng(!0),c,g,f,o,m,p=[];c=a.startContainer;g=a.startOffset;f=c;if(3==c.nodeType){if(g!=c.nodeValue.length||c.nodeValue===N)o=!0;f=f.parentNode}for(;f;){if(k(f,b,e)){m=f;break}f.nextSibling&&(o=!0);p.push(f);f=f.parentNode}if(m)if(o)f=F.getBookmark(),a.collapse(!0),a=t(a,d(b),!0),a=L.split(a),h(b,e,a),F.moveToBookmark(f);else{f=c=l();for(a=p.length-1;0<=a;a--)f.appendChild(y.clone(p[a],
!1)),f=f.firstChild;f.appendChild(y.doc.createTextNode(N));f=f.firstChild;y.insertAfter(c,m);F.setCursorLocation(f,1)}}function s(){var a;(a=m(F.getStart()))&&!y.isEmpty(a)&&f.walk(a,function(a){1==a.nodeType&&a.id!==u&&!y.isEmpty(a)&&y.setAttrib(a,"data-mce-bogus",null)},"childNodes")}var u="_mce_caret",x=c.settings.caret_debug;self._hasCaretEvents||(c.onBeforeGetContent.addToTop(function(){var a=[],b;if(o(m(F.getStart()),a))for(b=a.length;b--;)y.setAttrib(a[b],"data-mce-bogus","1")}),f.each(["onMouseUp",
"onKeyUp"],function(a){c[a].addToTop(function(){r();s()})}),c.onKeyDown.addToTop(function(a,b){var c=b.keyCode;(8==c||37==c||39==c)&&r(m(F.getStart()));s()}),F.onSetContent.add(s),self._hasCaretEvents=!0);"apply"==a?n():q()}function B(a){var b=a.startContainer,c=a.startOffset,d,e;3==b.nodeType&&c>=b.nodeValue.length&&(c=K(b),b=b.parentNode,d=!0);if(1==b.nodeType){e=b.childNodes;b=e[Math.min(c,e.length-1)];b=new G(b,y.getParent(b,y.isBlock));(c>e.length-1||d)&&b.next();for(c=b.current();c;c=b.next())if(3==
c.nodeType&&!q(c)){d=y.create("a",null,N);c.parentNode.insertBefore(d,c);a.setStart(c,0);F.setRng(a);y.remove(d);break}}}var E={},C=f.each,y=c.dom,F=c.selection,G=f.dom.TreeWalker,L=new f.dom.RangeUtils(y),O=c.schema.isValidChild,H=y.isBlock,M=c.settings.forced_root_block,K=y.nodeIndex,N=f.isGecko?"\u200b":"\ufeff",T=/^(src|href|style)$/,J=!1,I=!0,P,R,S=y.getContentEditable,U=function(a){var b;c.dom.getParent(a,function(a){return(b=c.dom.getStyle(a,"text-decoration"))&&"none"!==b});return b},V=function(a){var b;
1===a.nodeType&&a.parentNode&&1===a.parentNode.nodeType&&(b=U(a.parentNode),c.dom.getStyle(a,"color")&&b?c.dom.setStyle(a,"text-decoration",b):c.dom.getStyle(a,"textdecoration")===b&&c.dom.setStyle(a,"text-decoration",null))};f.extend(this,{get:d,register:e,apply:g,remove:h,toggle:function(a,b,c){var e=d(a);l(a,b,c)&&(!("toggle"in e[0])||e[0].toggle)?h(a,b,c):g(a,b,c)},match:l,matchAll:function(a,b){var c,d=[],e={};c=F.getStart();y.getParent(c,function(c){var g,f;for(g=0;g<a.length;g++)f=a[g],!e[f]&&
k(c,f,b)&&(e[f]=!0,d.push(f))},y.getRoot());return d},matchNode:k,canApply:function(b){var b=d(b),c,e,g,f;if(b){c=F.getStart();c=a(c);for(g=b.length-1;0<=g;g--){f=b[g].selector;if(!f)return I;for(e=c.length-1;0<=e;e--)if(y.is(c[e],f))return I}}return J},formatChanged:function(b,d){var e;P||(P={},e={},c.onNodeChange.addToTop(function(b,c,d){var g=a(d),f={};C(P,function(a,b){C(g,function(c){if(k(c,b,{},!0))return e[b]||(C(a,function(a){a(!0,{node:c,format:b,parents:g})}),e[b]=a),f[b]=a,!1})});C(e,function(a,
b){f[b]||(delete e[b],C(a,function(a){a(!1,{node:d,format:b,parents:g})}))})}));C(b.split(","),function(a){P[a]||(P[a]=[]);P[a].push(d)});return this}});(function(){e({alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},{selector:"img",collapsed:!1,styles:{display:"block",
marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"right"}}],alignfull:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",
remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:!1},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:!1},fontname:{inline:"span",styles:{fontFamily:"%value"}},
fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(a,b,c){C(c,function(b,c){y.setAttrib(a,c,b)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",
attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]});C("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),function(a){e(a,{block:a,remove:"all"})});e(c.settings.formats)})();(function(){c.addShortcut("ctrl+b","bold_desc","Bold");c.addShortcut("ctrl+i","italic_desc","Italic");c.addShortcut("ctrl+u","underline_desc","Underline");for(var a=1;6>=a;a++)c.addShortcut("ctrl+"+a,"",["FormatBlock",
!1,"h"+a]);c.addShortcut("ctrl+7","",["FormatBlock",!1,"p"]);c.addShortcut("ctrl+8","",["FormatBlock",!1,"div"]);c.addShortcut("ctrl+9","",["FormatBlock",!1,"address"])})()}})(tinymce);
tinymce.onAddEditor.add(function(f,c){function a(a,b){f.each(b,function(b,c){b&&g.setStyle(a,c,b)});g.rename(a,"span")}function b(a,b){g=a.dom;h.convert_fonts_to_spans&&f.each(g.select("font,u,strike",b.node),function(a){d[a.nodeName.toLowerCase()](c.dom,a)})}var d,e,g,h=c.settings;h.inline_styles&&(e=f.explode(h.font_size_legacy_values),d={font:function(b,c){a(c,{backgroundColor:c.style.backgroundColor,color:c.color,fontFamily:c.face,fontSize:e[parseInt(c.size,10)-1]})},u:function(b,c){a(c,{textDecoration:"underline"})},
strike:function(b,c){a(c,{textDecoration:"line-through"})}},c.onPreProcess.add(b),c.onSetContent.add(b),c.onInit.add(function(){c.selection.onSetContent.add(b)}))});
(function(f){var c=f.dom.TreeWalker;f.EnterKey=function(a){function b(b){function l(a){return a&&d.isBlock(a)&&!/^(TD|TH|CAPTION)$/.test(a.nodeName)&&!/^(fixed|absolute)/i.test(a.style.position)&&"true"!==d.getContentEditable(a)}function m(b){var g,f,h,k=b,l;h=d.createRng();if(b.hasChildNodes()){for(g=new c(b,b);f=g.current();){if(3==f.nodeType){h.setStart(f,0);h.setEnd(f,0);break}if(/^(BR|IMG)$/.test(f.nodeName)){h.setStartBefore(f);h.setEndBefore(f);break}k=f;g.next()}f||(h.setStart(k,0),h.setEnd(k,
0))}else if("BR"==b.nodeName)if(b.nextSibling&&d.isBlock(b.nextSibling)){if(!z||9>z)l=d.create("br"),b.parentNode.insertBefore(l,b);h.setStartBefore(b);h.setEndBefore(b)}else h.setStartAfter(b),h.setEndAfter(b);else h.setStart(b,0),h.setEnd(b,0);e.setRng(h);d.remove(l);g=d.getViewPort(a.getWin());b=d.getPos(b).y;if(b<g.y||b+25>g.y+g.h)a.getWin().scrollTo(0,b<g.y?b:b-g.h+25)}function n(a){var b=x,c,e;e=a=a||"TABLE"==y?d.create(a||G):v.cloneNode(!1);if(!1!==g.keep_styles){do/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(b.nodeName)&&
(c=b.cloneNode(!1),d.setAttrib(c,"id",""),a.hasChildNodes()?c.appendChild(a.firstChild):e=c,a.appendChild(c));while(b=b.parentNode)}f.isIE||(e.innerHTML="<br>");return a}function o(a){var b,d;if(3==x.nodeType&&(a?0<A:A<x.nodeValue.length))return!1;if(x.parentNode==v&&L&&!a)return!0;if("TABLE"===x.nodeName||x.previousSibling&&"TABLE"==x.previousSibling.nodeName)return L&&!a||!L&&a;for(b=new c(x,v);d=a?b.prev():b.next();)if(1===d.nodeType){if(!d.getAttribute("data-mce-bogus")&&(d=d.nodeName.toLowerCase(),
"IMG"===d))return!1}else if(3===d.nodeType&&!/^[ \t\r\n]*$/.test(d.nodeValue))return!1;return!0}function p(a,b){var c,e,g,f;c=G||"P";e=d.getParent(a,d.isBlock);if(!e||!l(e)){e=e||D;if(!e.hasChildNodes())return c=d.create(c),e.appendChild(c),r.setStart(c,0),r.setEnd(c,0),c;for(f=a;f.parentNode!=e;)f=f.parentNode;for(;f&&!d.isBlock(f);)g=f,f=f.previousSibling;if(g){c=d.create(c);g.parentNode.insertBefore(c,g);for(f=g;f&&!d.isBlock(f);)e=f.nextSibling,c.appendChild(f),f=e;r.setStart(a,b);r.setEnd(a,
b)}}return a}function q(){function a(b){for(var c=C[b?"firstChild":"lastChild"];c&&1!=c.nodeType;)c=c[b?"nextSibling":"previousSibling"];return c===v}B=G?n(G):d.create("BR");a(!0)&&a()?d.replace(B,C):a(!0)?C.parentNode.insertBefore(B,C):(a()||(u=r.cloneRange(),u.setStartAfter(v),u.setEndAfter(C),E=u.extractContents(),d.insertAfter(E,C)),d.insertAfter(B,C));d.remove(v);m(B);h.add()}function s(){var a,b,g;if(g=x&&3==x.nodeType&&A>=x.nodeValue.length)if(g=!f.isIE){a:{g=new c(x,v);for(var k;k=g.current();){if("BR"==
k.nodeName){a=!0;break a}g.next()}}g=!a}g&&(a=d.create("br"),r.insertNode(a),r.setStartAfter(a),r.setEndAfter(a),b=!0);a=d.create("br");r.insertNode(a);f.isIE&&"PRE"==y&&(!z||8>z)&&a.parentNode.insertBefore(d.doc.createTextNode("\r"),a);b?(r.setStartBefore(a),r.setEndBefore(a)):(r.setStartAfter(a),r.setEndAfter(a));e.setRng(r);h.add()}function t(a){do 3===a.nodeType&&(a.nodeValue=a.nodeValue.replace(/^[\r\n]+/,"")),a=a.firstChild;while(a)}var r=e.getRng(!0),u,D,x,A,v,z,B,E,C,y,F,G,L;if(r.collapsed){if(!b.isDefaultPrevented()&&
(x=r.startContainer,A=r.startOffset,G=(G=g.forced_root_block)?G.toUpperCase():"",z=d.doc.documentMode,1==x.nodeType&&x.hasChildNodes()&&(L=A>x.childNodes.length-1,x=x.childNodes[Math.min(A,x.childNodes.length-1)]||x,A=0),D=function(a){for(var b=d.getRoot(),c;a!==b&&d.getContentEditable(a)!=="false";){d.getContentEditable(a)==="true"&&(c=a);a=a.parentNode}return a!==b?c:b}(x)))if(h.beforeChange(),!d.isBlock(D)&&D!=d.getRoot())(!G||b.shiftKey)&&s();else{if(G&&!b.shiftKey||!G&&b.shiftKey)x=p(x,A);C=
(v=d.getParent(x,d.isBlock))?d.getParent(v.parentNode,d.isBlock):null;y=v?v.nodeName.toUpperCase():"";F=C?C.nodeName.toUpperCase():"";if("LI"==y&&d.isEmpty(v)){if(/^(UL|OL|LI)$/.test(C.parentNode.nodeName))return!1;q()}else{if("PRE"==y&&!1!==g.br_in_pre){if(!b.shiftKey){s();return}}else if(!G&&!b.shiftKey&&"LI"!=y||G&&b.shiftKey){s();return}G=G||"P";o()?(B=/^(H[1-6]|PRE)$/.test(y)&&"HGROUP"!=F?n(G):n(),g.end_container_on_empty_block&&l(C)&&d.isEmpty(v)?B=d.split(C,v):d.insertAfter(B,v)):o(!0)?B=v.parentNode.insertBefore(n(),
v):(u=r.cloneRange(),u.setEndAfter(v),E=u.extractContents(),t(E),B=E.firstChild,d.insertAfter(E,v));d.setAttrib(B,"id","");m(B);h.add()}}}else a.execCommand("Delete")}var d=a.dom,e=a.selection,g=a.settings,h=a.undoManager;a.onKeyDown.add(function(a,c){13==c.keyCode&&!1!==b(c)&&c.preventDefault()})}})(tinymce);
(function(){function f(b,c){return b.getParam(c,a[c])}var c=tinymce.each,a={paste_auto_cleanup_on_paste:!0,paste_enable_default_filters:!0,paste_block_drop:!1,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_word_images:!0,paste_remove_spans:!1,paste_remove_styles:!1,paste_remove_styles_if_webkit:!0,paste_convert_middot_lists:!0,paste_convert_headers_to_strong:!1,paste_dialog_width:"450",paste_dialog_height:"400",paste_text_use_dialog:!1,paste_text_sticky:!1,paste_text_sticky_default:!1,
paste_text_notifyalways:!1,paste_text_linebreaktype:"combined",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};tinymce.create("tinymce.plugins.PastePlugin",{init:function(a,d){function e(c,d){var e=a.dom,g;h.onPreProcess.dispatch(h,c);c.node=e.create("div",0,c.content);tinymce.isGecko&&(g=a.selection.getRng(!0),g.startContainer==g.endContainer&&3==g.startContainer.nodeType&&1===c.node.childNodes.length&&/^(p|h[1-6]|pre)$/i.test(c.node.firstChild.nodeName)&&
-1===c.content.indexOf("__MCE_ITEM__")&&e.remove(c.node.firstChild,!0));h.onPostProcess.dispatch(h,c);c.content=a.serializer.serialize(c.node,{getInner:1,forced_root_block:""});!d&&a.pasteAsPlainText?(h._insertPlainText(c.content),f(a,"paste_text_sticky")||(a.pasteAsPlainText=!1,a.controlManager.setActive("pastetext",!1))):h._insert(c.content)}function g(d){var g,f,h,o,p=a.selection,q=a.dom;h=a.getBody();var s;if(d.clipboardData||q.doc.dataTransfer)if(s=(d.clipboardData||q.doc.dataTransfer).getData("Text"),
a.pasteAsPlainText){d.preventDefault();e({content:q.encode(s).replace(/\r?\n/g,"<br />")});return}if(!q.get("_mcePaste")){g=q.add(h,"div",{id:"_mcePaste","class":"mcePaste","data-mce-bogus":"1"},"\ufeff\ufeff");h!=a.getDoc().body?h=q.getPos(a.selection.getStart(),h).y:(h=q.getViewPort(a.getWin()),h=h.y+h.h/2);q.setStyles(g,{position:"absolute",left:tinymce.isGecko?-40:0,top:h-25,width:1,height:1,overflow:"hidden"});if(tinymce.isIE){o=p.getRng();h=q.doc.body.createTextRange();h.moveToElementText(g);
h.execCommand("Paste");q.remove(g);if("\ufeff\ufeff"===g.innerHTML){a.execCommand("mcePasteWord");d.preventDefault();return}p.setRng(o);p.setContent("");setTimeout(function(){e({content:g.innerHTML})},0);return tinymce.dom.Event.cancel(d)}var t=function(a){a.preventDefault()};q.bind(a.getDoc(),"mousedown",t);q.bind(a.getDoc(),"keydown",t);f=a.selection.getRng();g=g.firstChild;h=a.getDoc().createRange();h.setStart(g,0);h.setEnd(g,2);p.setRng(h);window.setTimeout(function(){var d="",g;if(q.select("div.mcePaste > div.mcePaste").length)d=
"<p>"+q.encode(s).replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br />")+"</p>";else{g=q.select("div.mcePaste");c(g,function(a){var b=a.firstChild;b&&b.nodeName=="DIV"&&b.style.marginTop&&b.style.backgroundColor&&q.remove(b,1);c(q.select("span.Apple-style-span",a),function(a){q.remove(a,1)});c(q.select("br[data-mce-bogus]",a),function(a){q.remove(a)});a.parentNode.className!="mcePaste"&&(d=d+a.innerHTML)})}c(q.select("div.mcePaste"),function(a){q.remove(a)});f&&p.setRng(f);e({content:d});q.unbind(a.getDoc(),
"mousedown",t);q.unbind(a.getDoc(),"keydown",t)},0)}}var h=this;h.editor=a;h.url=d;h.onPreProcess=new tinymce.util.Dispatcher(h);h.onPostProcess=new tinymce.util.Dispatcher(h);h.onPreProcess.add(h._preProcess);h.onPostProcess.add(h._postProcess);h.onPreProcess.add(function(c,d){a.execCallback("paste_preprocess",c,d)});h.onPostProcess.add(function(c,d){a.execCallback("paste_postprocess",c,d)});a.onKeyDown.addToTop(function(a,b){if((tinymce.isMac?b.metaKey:b.ctrlKey)&&86==b.keyCode||b.shiftKey&&45==
b.keyCode)return!1});a.pasteAsPlainText=f(a,"paste_text_sticky_default");a.addCommand("mceInsertClipboardContent",function(a,b){e(b,!0)});f(a,"paste_text_use_dialog")||a.addCommand("mcePasteText",function(){var c=tinymce.util.Cookie;a.pasteAsPlainText=!a.pasteAsPlainText;a.controlManager.setActive("pastetext",a.pasteAsPlainText);a.pasteAsPlainText&&!c.get("tinymcePasteText")&&(f(a,"paste_text_sticky")?a.windowManager.alert(a.translate("paste.plaintext_mode_sticky")):a.windowManager.alert(a.translate("paste.plaintext_mode")),
f(a,"paste_text_notifyalways")||c.set("tinymcePasteText","1",new Date((new Date).getFullYear()+1,12,31)))});a.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"});a.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"});f(a,"paste_auto_cleanup_on_paste")&&(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)?a.onKeyDown.addToTop(function(a,b){((tinymce.isMac?b.metaKey:b.ctrlKey)&&86==b.keyCode||b.shiftKey&&45==b.keyCode)&&g(b)}):a.onPaste.addToTop(function(a,
b){return g(b)}));a.onInit.add(function(){a.controlManager.setActive("pastetext",a.pasteAsPlainText);f(a,"paste_block_drop")&&a.dom.bind(a.getBody(),"dragend,dragover,draggesture,dragdrop,drop,drag".split(","),function(a){a.preventDefault();a.stopPropagation();return false})});h._legacySupport()},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+
"."+tinymce.minorVersion}},_preProcess:function(a,d){function e(a){c(a,function(a){h=a.constructor==RegExp?h.replace(a,""):h.replace(a[0],a[1])})}var g=this.editor,h=d.content,k=tinymce.grep,l=tinymce.explode,m=tinymce.trim,n,o;if(!1!=g.settings.paste_enable_default_filters){tinymce.isIE&&9<=document.documentMode&&/<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(d.content)&&(e([[/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,
"$1"]]),e([[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]));if(/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(h)||d.wordContent){d.wordContent=!0;e([/^\s*(&nbsp;)+/gi,/(&nbsp;|<br[^>]*>)+\s*$/gi]);f(g,"paste_convert_headers_to_strong")&&(h=h.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>"));f(g,"paste_convert_middot_lists")&&e([[/<\!--\[if !supportLists\]--\>/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"],
[/(<p[^>]+(?:MsoListParagraph)[^>]+>)/gi,"$1__MCE_ITEM__"]]);f(g,"paste_remove_word_images")&&e([/<img[^>]*>/gi]);e([/<\!--[\s\S]+?--\>/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"]]);do n=h.length,h=h.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1");while(n!=h.length);0==f(g,"paste_retain_style_properties").replace(/^none$/i,"").length?h=h.replace(/<\/?span[^>]*>/gi,
""):e([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,b){return b.length>0?b.replace(/./," ").slice(Math.floor(b.length/2)).split("").join("\u00a0"):""}],[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(a,b,d){var e=[],g=0,a=l(m(d).replace(/&quot;/gi,"'"),";");c(a,function(a){function b(a){return a+(a!=="0"&&/\d$/.test(a))?"px":""}var c,d=l(a,":");if(d.length==2){a=d[0].toLowerCase();c=d[1].toLowerCase();switch(a){case "mso-padding-alt":case "mso-padding-top-alt":case "mso-padding-right-alt":case "mso-padding-bottom-alt":case "mso-padding-left-alt":case "mso-margin-alt":case "mso-margin-top-alt":case "mso-margin-right-alt":case "mso-margin-bottom-alt":case "mso-margin-left-alt":case "mso-table-layout-alt":case "mso-height":case "mso-width":case "mso-vertical-align-alt":e[g++]=
a.replace(/^mso-|-alt$/g,"")+":"+b(c);return;case "horiz-align":e[g++]="text-align:"+c;return;case "vert-align":e[g++]="vertical-align:"+c;return;case "font-color":case "mso-foreground":e[g++]="color:"+c;return;case "mso-background":case "mso-highlight":e[g++]="background:"+c;return;case "mso-default-height":e[g++]="min-height:"+b(c);return;case "mso-default-width":e[g++]="min-width:"+b(c);return;case "mso-padding-between-alt":e[g++]="border-collapse:separate;border-spacing:"+b(c);return;case "text-line-through":if(c==
"single"||c=="double")e[g++]="text-decoration:line-through";return;case "mso-zero-height":c=="yes"&&(e[g++]="display:none");return}/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(a)||(e[g++]=a+":"+d[1])}});return g>0?b+' style="'+e.join(";")+'"':b}]])}f(g,"paste_convert_headers_to_strong")&&e([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]]);
e([[/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""]]);o=f(g,"paste_strip_class_attributes");"none"!==o&&(n=function(a,b){if(o==="all")return"";var c=k(l(b.replace(/^(["'])(.*)\1$/,"$2")," "),function(a){return/^(?!mso)/i.test(a)});return c.length?' class="'+c.join(" ")+'"':""},h=h.replace(/ class="([^"]+)"/gi,n),h=h.replace(/ class=([\-\w]+)/gi,n));f(g,"paste_remove_spans")&&(h=h.replace(/<\/?span[^>]*>/gi,""));d.content=h}},_postProcess:function(a,d){var e=
this.editor,g=e.dom,h;!1!=e.settings.paste_enable_default_filters&&(d.wordContent&&(c(g.select("a",d.node),function(a){(!a.href||-1!=a.href.indexOf("#_Toc"))&&g.remove(a,1)}),f(e,"paste_convert_middot_lists")&&this._convertLists(a,d),h=f(e,"paste_retain_style_properties"),tinymce.is(h,"string")&&"all"!==h&&"*"!==h&&(h=tinymce.explode(h.replace(/^none$/i,"")),c(g.select("*",d.node),function(a){var b={},c=0,d,e,f;if(h)for(d=0;d<h.length;d++)if(e=h[d],f=g.getStyle(a,e))b[e]=f,c++;g.setAttrib(a,"style",
"");h&&0<c?g.setStyles(a,b):"SPAN"==a.nodeName&&!a.className&&g.remove(a,!0)}))),f(e,"paste_remove_styles")||f(e,"paste_remove_styles_if_webkit")&&tinymce.isWebKit?c(g.select("*[style]",d.node),function(a){a.removeAttribute("style");a.removeAttribute("data-mce-style")}):tinymce.isWebKit&&c(g.select("*",d.node),function(a){a.removeAttribute("data-mce-style")}))},_convertLists:function(a,d){var e=a.editor.dom,g,f,k=-1,l,m=[],n,o;c(e.select("p",d.node),function(a){var b,d="",o;for(b=a.firstChild;b&&
3==b.nodeType;b=b.nextSibling)d+=b.nodeValue;d=a.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g,"\u00a0");/^(__MCE_ITEM__)+[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*\u00a0*/.test(d)&&(o="ul");/^__MCE_ITEM__\s*\w+\.\s*\u00a0+/.test(d)&&(o="ol");o?(l=parseFloat(a.style.marginLeft||0),l>k&&m.push(l),!g||o!=n?(g=e.create(o),e.insertAfter(g,a)):l>k?g=f.appendChild(e.create(o)):l<k&&(b=tinymce.inArray(m,l),d=e.getParents(g.parentNode,o),g=d[d.length-1-b]||g),c(e.select("span",a),function(a){var b=
a.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");o=="ul"&&/^__MCE_ITEM__[\u2022\u00b7\u00a7\u00d8o\u25CF]/.test(b)?e.remove(a):/^__MCE_ITEM__[\s\S]*\w+\.(&nbsp;|\u00a0)*\s*/.test(b)&&e.remove(a)}),b=a.innerHTML,b="ul"==o?a.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*(&nbsp;|\u00a0)+\s*/,""):a.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^\s*\w+\.(&nbsp;|\u00a0)+\s*/,""),f=g.appendChild(e.create("li",0,b)),e.remove(a),k=l,n=o):g=k=0});o=d.node.innerHTML;-1!=o.indexOf("__MCE_ITEM__")&&
(d.node.innerHTML=o.replace(/__MCE_ITEM__/g,""))},_insert:function(a,c){var e=this.editor,g=e.selection.getRng();!e.selection.isCollapsed()&&g.startContainer!=g.endContainer&&e.getDoc().execCommand("Delete",!1,null);e.execCommand("mceInsertContent",!1,a,{skip_undo:c})},_insertPlainText:function(a){function d(d){c(d,function(c){a=c.constructor==RegExp?a.replace(c,""):a.replace(c[0],c[1])})}var e=this.editor,g=f(e,"paste_text_linebreaktype"),h=f(e,"paste_text_replacements"),k=tinymce.is;"string"===
typeof a&&0<a.length&&(/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(a)?d([/[\n\r]+/g]):d([/\r+/g]),d([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"],[/\n{3,}/g,"\n\n"]]),a=e.dom.decode(tinymce.html.Entities.encodeRaw(a)),k(h,"array")?d(h):k(h,"string")&&d(RegExp(h,
"gi")),"none"==g?d([[/\n+/g," "]]):"br"==g?d([[/\n/g,"<br />"]]):"p"==g?d([[/\n+/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"]]):d([[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]]),e.execCommand("mceInsertContent",!1,a))},_legacySupport:function(){var a=this,c=a.editor;c.addCommand("mcePasteWord",function(){c.windowManager.open({file:a.url+"/pasteword.htm",width:parseInt(f(c,"paste_dialog_width")),height:parseInt(f(c,"paste_dialog_height")),inline:1})});f(c,"paste_text_use_dialog")&&
c.addCommand("mcePasteText",function(){c.windowManager.open({file:a.url+"/pastetext.htm",width:parseInt(f(c,"paste_dialog_width")),height:parseInt(f(c,"paste_dialog_height")),inline:1})});c.addButton("pasteword",{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}});tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)})();
(function(f){f.fn.farbtastic=function(c){f.farbtastic(this,c);return this};f.farbtastic=function(c,a){c=f(c).get(0);return c.farbtastic||(c.farbtastic=new f._farbtastic(c,a))};f._farbtastic=function(c,a){var b=this;f(c).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');var d=f(".farbtastic",c);b.wheel=f(".wheel",c).get(0);b.radius=84;b.square=100;b.width=194;b.firstClick=
!0;navigator.appVersion.match(/MSIE [0-6]\./)&&f("*",d).each(function(){if("none"!=this.currentStyle.backgroundImage){var a=this.currentStyle.backgroundImage,a=this.currentStyle.backgroundImage.substring(5,a.length-2);f(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+a+"')"})}});b.linkTo=function(a){"object"==typeof b.callback&&f(b.callback).unbind("keyup",b.updateValue);b.color=null;if("function"==typeof a)b.callback=
a;else if("object"==typeof a||"string"==typeof a)b.callback=f(a),b.callback.bind("keyup",b.updateValue),b.callback.get(0).value&&b.setColor(b.callback.get(0).value);return this};b.updateValue=function(){this.value&&this.value!=b.color&&b.setColor(this.value)};b.setColor=function(a){var c=b.unpack(a);b.color!=a&&c&&(b.color=a,b.rgb=c,b.hsl=b.RGBToHSL(b.rgb),b.updateDisplay());return this};b.setHSL=function(a){b.hsl=a;b.rgb=b.HSLToRGB(a);b.color=b.pack(b.rgb);b.updateDisplay();return this};b.widgetCoords=
function(a){var c=f(b.wheel).offset();return{x:a.pageX-c.left-b.width/2,y:a.pageY-c.top-b.width/2}};b.mousedown=function(a){document.dragging||(f(document).bind("mousemove",b.mousemove).bind("mouseup",b.mouseup),document.dragging=!0);var c=b.widgetCoords(a);b.circleDrag=2*Math.max(Math.abs(c.x),Math.abs(c.y))>b.square;b.mousemove(a);return!1};b.mousemove=function(a){var c=b.widgetCoords(a);b.circleDrag?(a=Math.atan2(c.x,-c.y)/6.28,0>a&&(a+=1),b.firstClick&&(0==b.hsl[2]||1==b.hsl[2])?(b.firstClick=
!1,b.setHSL([a,1,0.5])):b.setHSL([a,b.hsl[1],b.hsl[2]])):(a=Math.max(0,Math.min(1,-(c.x/b.square)+0.5)),c=Math.max(0,Math.min(1,-(c.y/b.square)+0.5)),b.setHSL([b.hsl[0],a,c]));return!1};b.mouseup=function(){f(document).unbind("mousemove",b.mousemove);f(document).unbind("mouseup",b.mouseup);document.dragging=!1};b.updateDisplay=function(){var a=6.28*b.hsl[0];f(".h-marker",d).css({left:Math.round(Math.sin(a)*b.radius+b.width/2)+"px",top:Math.round(-Math.cos(a)*b.radius+b.width/2)+"px"});f(".sl-marker",
d).css({left:Math.round(b.square*(0.5-b.hsl[1])+b.width/2)+"px",top:Math.round(b.square*(0.5-b.hsl[2])+b.width/2)+"px"});f(".color",d).css("backgroundColor",b.pack(b.HSLToRGB([b.hsl[0],1,0.5])));"object"==typeof b.callback?(f(b.callback).css({backgroundColor:b.color,color:0.5<b.hsl[2]?"#000":"#fff"}),f(b.callback).each(function(){this.value&&this.value!=b.color&&(this.value=b.color)})):"function"==typeof b.callback&&b.callback.call(b,b.color)};b.pack=function(a){var b=Math.round(255*a[0]),c=Math.round(255*
a[1]),a=Math.round(255*a[2]);return"#"+(16>b?"0":"")+b.toString(16)+(16>c?"0":"")+c.toString(16)+(16>a?"0":"")+a.toString(16)};b.unpack=function(a){if(7==a.length)return[parseInt("0x"+a.substring(1,3))/255,parseInt("0x"+a.substring(3,5))/255,parseInt("0x"+a.substring(5,7))/255];if(4==a.length)return[parseInt("0x"+a.substring(1,2))/15,parseInt("0x"+a.substring(2,3))/15,parseInt("0x"+a.substring(3,4))/15]};b.HSLToRGB=function(a){var b,c=a[0];b=a[1];a=a[2];b=0.5>=a?a*(b+1):a+b-a*b;a=2*a-b;return[this.hueToRGB(a,
b,c+0.33333),this.hueToRGB(a,b,c),this.hueToRGB(a,b,c-0.33333)]};b.hueToRGB=function(a,b,c){c=0>c?c+1:1<c?c-1:c;return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(0.66666-c):a};b.RGBToHSL=function(a){var b,c,d,f,m=a[0],n=a[1],o=a[2];b=Math.min(m,Math.min(n,o));a=Math.max(m,Math.max(n,o));c=a-b;f=(b+a)/2;d=0;0<f&&1>f&&(d=c/(0.5>f?2*f:2-2*f));b=0;0<c&&(a==m&&a!=n&&(b+=(n-o)/c),a==n&&a!=o&&(b+=2+(o-m)/c),a==o&&a!=m&&(b+=4+(m-n)/c),b/=6);return[b,d,f]};f("*",d).mousedown(b.mousedown);b.setColor("#000000");
a&&b.linkTo(a)}})(jQuery);
(function(){function f(){this.returnValue=!1}function c(){this.cancelBubble=!0}var a=0,b=[],d={},e={},g={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},h=/[<>&\"\']/g,k=window.setTimeout,l={},m;(function(a){var a=a.split(/,/),b,c,d;for(b=0;b<a.length;b+=2){d=a[b+1].split(/ /);for(c=0;c<d.length;c++)e[d[c]]=a[b]}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");var n=
{VERSION:"@@version@@",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:e,ua:function(){var a=navigator,b=a.userAgent,c=a.vendor,d,e;e=(d=/WebKit/.test(b))&&-1!==c.indexOf("Apple");c=window.opera&&window.opera.buildNumber;return{windows:-1!==navigator.platform.indexOf("Win"),
ie:!d&&!c&&/MSIE/gi.test(b)&&/Explorer/gi.test(a.appName),webkit:d,gecko:!d&&/Gecko/.test(b),safari:e,opera:!!c}}(),typeOf:function(a){return{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},extend:function(a){n.each(arguments,function(b,c){0<c&&n.each(b,function(b,c){a[c]=b})});return a},cleanName:function(a){var b,c;c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,
"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<c.length;b+=2)a=a.replace(c[b],c[b+1]);a=a.replace(/\s+/g,"_");return a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},addRuntime:function(a,c){c.name=a;b[a]=c;b.push(c);return c},guid:function(){var b=(new Date).getTime().toString(32),c;for(c=0;5>c;c++)b+=Math.floor(65535*Math.random()).toString(32);return(n.guidPrefix||"p")+b+(a++).toString(32)},buildUrl:function(a,b){var c="";n.each(b,function(a,b){c+=(c?"&":"")+encodeURIComponent(b)+
"="+encodeURIComponent(a)});c&&(a+=(0<a.indexOf("?")?"&":"?")+c);return a},each:function(a,b){var c,d;if(a)if(c=a.length,void 0===c)for(d in a){if(a.hasOwnProperty(d)&&!1===b(a[d],d))break}else for(d=0;d<c&&!1!==b(a[d],d);d++);},formatSize:function(a){return void 0===a||/\D/.test(a)?n.translate("N/A"):1073741824<a?Math.round(a/1073741824,1)+" GB":1048576<a?Math.round(a/1048576,1)+" MB":1024<a?Math.round(a/1024,1)+" KB":a+" b"},getPos:function(a,b){function c(a){var b,d=0;b=0;a&&(b=a.getBoundingClientRect(),
a="CSS1Compat"===f.compatMode?f.documentElement:f.body,d=b.left+a.scrollLeft,b=b.top+a.scrollTop);return{x:d,y:b}}var d=0,e=0,g,f=document,b=b||f.body;if(a&&a.getBoundingClientRect&&0<navigator.userAgent.indexOf("MSIE")&&8!==f.documentMode)return d=c(a),e=c(b),{x:d.x-e.x,y:d.y-e.y};for(g=a;g&&g!=b&&g.nodeType;)d+=g.offsetLeft||0,e+=g.offsetTop||0,g=g.offsetParent;for(g=a.parentNode;g&&g!=b&&g.nodeType;)d-=g.scrollLeft||0,e-=g.scrollTop||0,g=g.parentNode;return{x:d,y:e}},getSize:function(a){return{w:a.offsetWidth||
a.clientWidth,h:a.offsetHeight||a.clientHeight}},parseSize:function(a){var b;"string"==typeof a&&(a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,"")),b=a[2],a=+a[1],"g"==b&&(a*=1073741824),"m"==b&&(a*=1048576),"k"==b&&(a*=1024));return a},xmlEncode:function(a){return a?(""+a).replace(h,function(a){return g[a]?"&"+g[a]+";":a}):a},toArray:function(a){var b,c=[];for(b=0;b<a.length;b++)c[b]=a[b];return c},inArray:function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,
a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c}return-1},addI18n:function(a){return n.extend(d,a)},translate:function(a){return d[a]||a},isEmptyObj:function(a){if(void 0===a)return!0;for(var b in a)return!1;return!0},hasClass:function(a,b){return""==a.className?!1:RegExp("(^|\\s+)"+b+"(\\s+|$)").test(a.className)},addClass:function(a,b){n.hasClass(a,b)||(a.className=""==a.className?b:a.className.replace(/\s+$/,"")+" "+b)},removeClass:function(a,b){a.className=a.className.replace(RegExp("(^|\\s+)"+
b+"(\\s+|$)"),function(a,b,c){return" "===b&&" "===c?" ":""})},getStyle:function(a,b){if(a.currentStyle)return a.currentStyle[b];if(window.getComputedStyle){var c=window.getComputedStyle(a,null);return c?c[b]:void 0}},addEvent:function(a,b,d,e){var g,b=b.toLowerCase();void 0===m&&(m="Plupload_"+n.guid());a.addEventListener?(g=d,a.addEventListener(b,g,!1)):a.attachEvent&&(g=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=f;a.stopPropagation=c;d(a)},a.attachEvent("on"+
b,g));void 0===a[m]&&(a[m]=n.guid());l.hasOwnProperty(a[m])||(l[a[m]]={});a=l[a[m]];a.hasOwnProperty(b)||(a[b]=[]);a[b].push({func:g,orig:d,key:e})},removeEvent:function(a,b,c){var d,e;"function"==typeof c?d=c:e=c;b=b.toLowerCase();if(a[m]&&l[a[m]]&&l[a[m]][b]){for(var c=l[a[m]][b],g=c.length-1;0<=g;g--)if(c[g].key===e||c[g].orig===d)if(a.detachEvent?a.detachEvent("on"+b,c[g].func):a.removeEventListener&&a.removeEventListener(b,c[g].func,!1),c[g].orig=null,c[g].func=null,c.splice(g,1),void 0!==d)break;
c.length||delete l[a[m]][b];if(n.isEmptyObj(l[a[m]])){delete l[a[m]];try{delete a[m]}catch(f){a[m]=void 0}}}},removeAllEvents:function(a,b){void 0!==a[m]&&a[m]&&n.each(l[a[m]],function(c,d){n.removeEvent(a,d,b)})},Uploader:function(a){function c(){var a,b=0,d;if(this.state==n.STARTED){for(d=0;d<f.length;d++)!a&&f[d].status==n.QUEUED?(a=f[d],a.status=n.UPLOADING,this.trigger("BeforeUpload",a)&&this.trigger("UploadFile",a)):b++;b==f.length&&(this.stop(),this.trigger("UploadComplete",f))}}function d(){var a,
b;g.reset();for(a=0;a<f.length;a++)b=f[a],void 0!==b.size?(g.size+=b.size,g.loaded+=b.loaded):g.size=void 0,b.status==n.DONE?g.uploaded++:b.status==n.FAILED?g.failed++:g.queued++;void 0===g.size?g.percent=0<f.length?Math.ceil(100*(g.uploaded/f.length)):0:(g.bytesPerSec=Math.ceil(g.loaded/((+new Date-h||1)/1E3)),g.percent=0<g.size?Math.ceil(100*(g.loaded/g.size)):0)}var e={},g,f=[],h,l=!1;g=new n.QueueProgress;a=n.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},
a);n.extend(this,{state:n.STOPPED,runtime:"",features:{},files:f,settings:a,total:g,id:n.guid(),init:function(){function e(){var a=m[s++],b,c,d;if(a){b=a.getFeatures();if(c=g.settings.required_features){c=c.split(",");for(d=0;d<c.length;d++)if(!b[c[d]]){e();return}}a.init(g,function(c){c&&c.success?(g.features=b,g.runtime=a.name,g.trigger("Init",{runtime:a.name}),g.trigger("PostInit"),g.refresh()):e()})}else g.trigger("Error",{code:n.INIT_ERROR,message:n.translate("Init error.")})}var g=this,l,m,
s=0,t;"function"==typeof a.preinit?a.preinit(g):n.each(a.preinit,function(a,b){g.bind(b,a)});a.page_url=a.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");/^(\w+:\/\/|\/)/.test(a.url)||(a.url=a.page_url+a.url);a.chunk_size=n.parseSize(a.chunk_size);a.max_file_size=n.parseSize(a.max_file_size);g.bind("FilesAdded",function(b,c){var d,e,h=0,l;if((d=a.filters)&&d.length){l=[];n.each(d,function(a){n.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?l.push("\\.*"):l.push("\\."+
a.replace(RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})});l=RegExp(l.join("|")+"$","i")}for(d=0;d<c.length;d++){e=c[d];e.loaded=0;e.percent=0;e.status=n.QUEUED;if(l&&!l.test(e.name))b.trigger("Error",{code:n.FILE_EXTENSION_ERROR,message:n.translate("File extension error."),file:e});else if(e.size!==void 0&&e.size>a.max_file_size)b.trigger("Error",{code:n.FILE_SIZE_ERROR,message:n.translate("File size error."),file:e});else{f.push(e);h++}}if(h)k(function(){g.trigger("QueueChanged");
g.refresh()},1);else return false});a.unique_names&&g.bind("UploadFile",function(a,b){var c=b.name.match(/\.([^.]+)$/),d="tmp";c&&(d=c[1]);b.target_name=b.id+"."+d});g.bind("UploadProgress",function(a,b){b.percent=b.size>0?Math.ceil(b.loaded/b.size*100):100;d()});g.bind("StateChanged",function(a){if(a.state==n.STARTED)h=+new Date;else if(a.state==n.STOPPED)for(l=a.files.length-1;l>=0;l--)if(a.files[l].status==n.UPLOADING){a.files[l].status=n.QUEUED;d()}});g.bind("QueueChanged",d);g.bind("Error",function(a,
b){if(b.file){b.file.status=n.FAILED;d();a.state==n.STARTED&&k(function(){c.call(g)},1)}});g.bind("FileUploaded",function(a,b){b.status=n.DONE;b.loaded=b.size;a.trigger("UploadProgress",b);k(function(){c.call(g)},1)});if(a.runtimes){m=[];t=a.runtimes.split(/\s?,\s?/);for(l=0;l<t.length;l++)b[t[l]]&&m.push(b[t[l]])}else m=b;e();"function"==typeof a.init?a.init(g):n.each(a.init,function(a,b){g.bind(b,a)})},refresh:function(){this.trigger("Refresh")},start:function(){this.state!=n.STARTED&&(this.state=
n.STARTED,this.trigger("StateChanged"),c.call(this))},stop:function(){this.state!=n.STOPPED&&(this.state=n.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},disableBrowse:function(a){l=void 0!==a?a:!0;this.trigger("DisableBrowse",l)},getFile:function(a){var b;for(b=f.length-1;0<=b;b--)if(f[b].id===a)return f[b]},removeFile:function(a){var b;for(b=f.length-1;0<=b;b--)if(f[b].id===a.id)return this.splice(b,1)[0]},splice:function(a,b){var c;c=f.splice(void 0===a?0:a,void 0===b?f.length:
b);this.trigger("FilesRemoved",c);this.trigger("QueueChanged");return c},trigger:function(a){var b=e[a.toLowerCase()],c,d;if(b){d=Array.prototype.slice.call(arguments);d[0]=this;for(c=0;c<b.length;c++)if(!1===b[c].func.apply(b[c].scope,d))return!1}return!0},hasEventListener:function(a){return!!e[a.toLowerCase()]},bind:function(a,b,c){var d,a=a.toLowerCase();d=e[a]||[];d.push({func:b,scope:c||this});e[a]=d},unbind:function(a,b){var a=a.toLowerCase(),c=e[a],d;if(c){if(void 0!==b)for(d=c.length-1;0<=
d;d--){if(c[d].func===b){c.splice(d,1);break}}else c=[];c.length||delete e[a]}},unbindAll:function(){var a=this;n.each(e,function(b,c){a.unbind(c)})},destroy:function(){this.stop();this.trigger("Destroy");this.unbindAll()}})},File:function(a,b,c){this.id=a;this.name=b;this.size=c;this.status=this.percent=this.loaded=0},Runtime:function(){this.getFeatures=function(){};this.init=function(){}},QueueProgress:function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=
0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}},runtimes:{}};window.plupload=n})();
(function(f,c,a,b){function d(a){var c,e=typeof a,g;if(a===b||null===a)return"null";if("string"===e)return c="\u0008b\tt\nn\u000cf\rr\"\"''\\\\",'"'+a.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(a,b){var d=c.indexOf(b);if(d+1)return"\\"+c.charAt(d+1);a=b.charCodeAt().toString(16);return"\\u"+"0000".substring(a.length)+a})+'"';if("object"==e){e=a.length!==b;c="";if(e){for(g=0;g<a.length;g++)c&&(c+=","),c+=d(a[g]);c="["+c+"]"}else{for(g in a)a.hasOwnProperty(g)&&(c&&(c+=","),c+=d(g)+":"+d(a[g]));
c="{"+c+"}"}return c}return""+a}function e(a){var b=!1,c=null,d,e,g,f,h,t=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(r){var u=navigator.plugins["Silverlight Plug-In"];if(u){d=u.description;"1.0.30226.2"===d&&(d="2.0.30226.2");for(e=d.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(g=a.split(".");4<g.length;)g.pop();do f=parseInt(g[t],10),h=parseInt(e[t],10),t++;while(t<g.length&&f===h);f<=h&&!isNaN(f)&&(b=!0)}}}catch(D){b=!1}return b}var g=
{},h={};a.silverlight={trigger:function(b,c){var d=g[b],e;d&&(e=a.toArray(arguments).slice(1),e[0]="Silverlight:"+c,setTimeout(function(){d.trigger.apply(d,e)},0))}};a.runtimes.Silverlight=a.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(b,l){function m(){return c.getElementById(b.id+"_silverlight").content.Upload}var n,o="",p=b.settings.filters,q,s=c.body;if(!e("2.0.31005.0")||f.opera&&f.opera.buildNumber)l({success:!1});
else{h[b.id]=!1;g[b.id]=b;n=c.createElement("div");n.id=b.id+"_silverlight_container";a.extend(n.style,{position:"absolute",top:"0px",background:b.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:b.settings.shim_bgcolor||8<c.documentMode?"":0.01});n.className="plupload silverlight";b.settings.container&&(s=c.getElementById(b.settings.container),"static"===a.getStyle(s,"position")&&(s.style.position="relative"));s.appendChild(n);for(q=0;q<p.length;q++)o+=
(""!=o?"|":"")+p[q].title+" | *."+p[q].extensions.replace(/,/g,";*.");n.innerHTML='<object id="'+b.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+b.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+b.id+",filter="+o+",multiselect="+
b.settings.multi_selection+'"/></object>';b.bind("Silverlight:Init",function(){var e,f={};if(!h[b.id]){h[b.id]=true;b.bind("Silverlight:StartSelectFiles",function(){e=[]});b.bind("Silverlight:SelectFile",function(b,c,d,g){b=a.guid();f[b]=c;f[c]=b;e.push(new a.File(b,d,g))});b.bind("Silverlight:SelectSuccessful",function(){e.length&&b.trigger("FilesAdded",e)});b.bind("Silverlight:UploadChunkError",function(c,d,e,g,h){b.trigger("Error",{code:a.IO_ERROR,message:"IO Error.",details:h,file:c.getFile(f[d])})});
b.bind("Silverlight:UploadFileProgress",function(b,c,d,e){c=b.getFile(f[c]);if(c.status!=a.FAILED){c.size=e;c.loaded=d;b.trigger("UploadProgress",c)}});b.bind("Refresh",function(b){var d,e;if(d=c.getElementById(b.settings.browse_button)){e=a.getPos(d,c.getElementById(b.settings.container));d=a.getSize(d);a.extend(c.getElementById(b.id+"_silverlight_container").style,{top:e.y+"px",left:e.x+"px",width:d.w+"px",height:d.h+"px"})}});b.bind("Silverlight:UploadChunkSuccessful",function(b,c,d,e,g){c=b.getFile(f[c]);
b.trigger("ChunkUploaded",c,{chunk:d,chunks:e,response:g});c.status!=a.FAILED&&b.state!==a.STOPPED&&m().UploadNextChunk();if(d==e-1){c.status=a.DONE;b.trigger("FileUploaded",c,{response:g})}});b.bind("Silverlight:UploadSuccessful",function(b,c,d){c=b.getFile(f[c]);c.status=a.DONE;b.trigger("FileUploaded",c,{response:d})});b.bind("FilesRemoved",function(a,b){var c;for(c=0;c<b.length;c++)m().RemoveFile(f[b[c].id])});b.bind("UploadFile",function(b,c){var e=b.settings,g=e.resize||{};m().UploadFile(f[c.id],
b.settings.url,d({name:c.target_name||c.name,mime:a.mimeTypes[c.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:e.chunk_size,image_width:g.width,image_height:g.height,image_quality:g.quality||90,multipart:!!e.multipart,multipart_params:e.multipart_params||{},file_data_name:e.file_data_name,headers:e.headers}))});b.bind("CancelUpload",function(){m().CancelUpload()});b.bind("Silverlight:MouseEnter",function(d){var e;e=c.getElementById(b.settings.browse_button);
d=d.settings.browse_button_hover;e&&d&&a.addClass(e,d)});b.bind("Silverlight:MouseLeave",function(d){var e;e=c.getElementById(b.settings.browse_button);d=d.settings.browse_button_hover;e&&d&&a.removeClass(e,d)});b.bind("Silverlight:MouseLeftButtonDown",function(d){var e,g;e=c.getElementById(b.settings.browse_button);g=d.settings.browse_button_active;if(e&&g){a.addClass(e,g);a.addEvent(c.body,"mouseup",function(){a.removeClass(e,g)})}});b.bind("Sliverlight:StartSelectFiles",function(d){var e;e=c.getElementById(b.settings.browse_button);
d=d.settings.browse_button_active;e&&d&&a.removeClass(e,d)});b.bind("DisableBrowse",function(a,b){m().DisableBrowse(b)});b.bind("Destroy",function(b){a.removeAllEvents(c.body,b.id);delete h[b.id];delete g[b.id];(b=c.getElementById(b.id+"_silverlight_container"))&&s.removeChild(b)});l({success:true})}})}}})})(window,document,plupload);
(function(f,c,a){function b(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}a=a.match(/\d+/g);return parseFloat(a[0]+"."+a[1])}var d={},e={};a.flash={trigger:function(a,b,c){setTimeout(function(){var e=d[a];e&&e.trigger("Flash:"+b,c)},0)}};a.runtimes.Flash=a.addRuntime("flash",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,maxWidth:8091,maxHeight:8091,chunks:!0,
progress:!0,multipart:!0,multi_selection:!0}},init:function(g,f){function k(){return c.getElementById(g.id+"_flash")}function l(){5E3<n++?f({success:!1}):e[g.id]||setTimeout(l,1)}var m,n=0,o=c.body;10>b()?f({success:!1}):(e[g.id]=!1,d[g.id]=g,c.getElementById(g.settings.browse_button),m=c.createElement("div"),m.id=g.id+"_flash_container",a.extend(m.style,{position:"absolute",top:"0px",background:g.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"}),m.className="plupload flash",
g.settings.container&&(o=c.getElementById(g.settings.container),"static"===a.getStyle(o,"position")&&(o.style.position="relative")),o.appendChild(m),function(){var b,d;b='<object id="'+g.id+'_flash" type="application/x-shockwave-flash" data="'+g.settings.flash_swf_url+'" ';a.ua.ie&&(b=b+'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');b=b+('width="100%" height="100%" style="outline:0"><param name="movie" value="'+g.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(g.id)+
'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>');if(a.ua.ie){d=c.createElement("div");m.appendChild(d);d.outerHTML=b}else m.innerHTML=b}(),l(),m=null,g.bind("Flash:Init",function(){var b={};k().setFileFilters(g.settings.filters,g.settings.multi_selection);if(!e[g.id]){e[g.id]=true;g.bind("UploadFile",function(c,d){var e=c.settings,f=g.settings.resize||{};k().uploadFile(b[d.id],e.url,{name:d.target_name||d.name,mime:a.mimeTypes[d.name.replace(/^.+\.([^.]+)/,
"$1").toLowerCase()]||"application/octet-stream",chunk_size:e.chunk_size,width:f.width,height:f.height,quality:f.quality,multipart:e.multipart,multipart_params:e.multipart_params||{},file_data_name:e.file_data_name,format:/\.(jpg|jpeg)$/i.test(d.name)?"jpg":"png",headers:e.headers,urlstream_upload:e.urlstream_upload})});g.bind("CancelUpload",function(){k().cancelUpload()});g.bind("Flash:UploadProcess",function(c,d){var e=c.getFile(b[d.id]);if(e.status!=a.FAILED){e.loaded=d.loaded;e.size=d.size;c.trigger("UploadProgress",
e)}});g.bind("Flash:UploadChunkComplete",function(c,d){var e=c.getFile(b[d.id]);c.trigger("ChunkUploaded",e,{chunk:d.chunk,chunks:d.chunks,response:d.text});e.status!==a.FAILED&&c.state!==a.STOPPED&&k().uploadNextChunk();if(d.chunk==d.chunks-1){e.status=a.DONE;c.trigger("FileUploaded",e,{response:d.text})}});g.bind("Flash:SelectFiles",function(c,d){var e,f,h=[],k;for(f=0;f<d.length;f++){e=d[f];k=a.guid();b[k]=e.id;b[e.id]=k;h.push(new a.File(k,e.name,e.size))}h.length&&g.trigger("FilesAdded",h)});
g.bind("Flash:SecurityError",function(c,d){g.trigger("Error",{code:a.SECURITY_ERROR,message:a.translate("Security error."),details:d.message,file:g.getFile(b[d.id])})});g.bind("Flash:GenericError",function(c,d){g.trigger("Error",{code:a.GENERIC_ERROR,message:a.translate("Generic error."),details:d.message,file:g.getFile(b[d.id])})});g.bind("Flash:IOError",function(c,d){g.trigger("Error",{code:a.IO_ERROR,message:a.translate("IO error."),details:d.message,file:g.getFile(b[d.id])})});g.bind("Flash:ImageError",
function(c,d){g.trigger("Error",{code:parseInt(d.code,10),message:a.translate("Image error."),file:g.getFile(b[d.id])})});g.bind("Flash:StageEvent:rollOver",function(b){var d;d=c.getElementById(g.settings.browse_button);b=b.settings.browse_button_hover;d&&b&&a.addClass(d,b)});g.bind("Flash:StageEvent:rollOut",function(b){var d;d=c.getElementById(g.settings.browse_button);b=b.settings.browse_button_hover;d&&b&&a.removeClass(d,b)});g.bind("Flash:StageEvent:mouseDown",function(b){var d,e;d=c.getElementById(g.settings.browse_button);
e=b.settings.browse_button_active;if(d&&e){a.addClass(d,e);a.addEvent(c.body,"mouseup",function(){a.removeClass(d,e)},b.id)}});g.bind("Flash:StageEvent:mouseUp",function(b){var d;d=c.getElementById(g.settings.browse_button);b=b.settings.browse_button_active;d&&b&&a.removeClass(d,b)});g.bind("Flash:ExifData",function(a,c){g.trigger("ExifData",g.getFile(b[c.id]),c.data)});g.bind("Flash:GpsData",function(a,c){g.trigger("GpsData",g.getFile(b[c.id]),c.data)});g.bind("QueueChanged",function(){g.refresh()});
g.bind("FilesRemoved",function(a,c){var d;for(d=0;d<c.length;d++)k().removeFile(b[c[d].id])});g.bind("StateChanged",function(){g.refresh()});g.bind("Refresh",function(b){var d,e;k().setFileFilters(g.settings.filters,g.settings.multi_selection);if(d=c.getElementById(b.settings.browse_button)){e=a.getPos(d,c.getElementById(b.settings.container));d=a.getSize(d);a.extend(c.getElementById(b.id+"_flash_container").style,{top:e.y+"px",left:e.x+"px",width:d.w+"px",height:d.h+"px"})}});g.bind("DisableBrowse",
function(a,b){k().disableBrowse(b)});g.bind("Destroy",function(b){a.removeAllEvents(c.body,b.id);delete e[b.id];delete d[b.id];(b=c.getElementById(b.id+"_flash_container"))&&o.removeChild(b)});f({success:true})}}))}})})(window,document,plupload);
(function(f,c,a,b){function d(a,b){var c;if("FileReader"in f)c=new FileReader,c.readAsDataURL(a),c.onload=function(){b(c.result)};else return b(a.getAsDataURL())}function e(a,b){var c;if("FileReader"in f)c=new FileReader,c.readAsBinaryString(a),c.onload=function(){b(c.result)};else return b(a.getAsBinary())}function g(a,b,e,g){var f,h,n,D,x=this;d(m[a.id],function(d){f=c.createElement("canvas");f.style.display="none";c.body.appendChild(f);h=f.getContext("2d");n=new Image;n.onerror=n.onabort=function(){g({success:!1})};
n.onload=function(){var c,m,B,E;b.width||(b.width=n.width);b.height||(b.height=n.height);D=Math.min(b.width/n.width,b.height/n.height);if(1>D||1===D&&"image/jpeg"===e){c=Math.round(n.width*D);m=Math.round(n.height*D);f.width=c;f.height=m;h.drawImage(n,0,0,c,m);if("image/jpeg"===e){if(B=new k(atob(d.substring(d.indexOf("base64,")+7))),B.headers&&B.headers.length&&(E=new l,E.init(B.get("exif")[0])&&(E.setExif("PixelXDimension",c),E.setExif("PixelYDimension",m),B.set("exif",E.getBinary()),x.hasEventListener("ExifData")&&
x.trigger("ExifData",a,E.EXIF()),x.hasEventListener("GpsData")&&x.trigger("GpsData",a,E.GPS()))),b.quality)try{d=f.toDataURL(e,b.quality/100)}catch(C){d=f.toDataURL(e)}}else d=f.toDataURL(e);d=d.substring(d.indexOf("base64,")+7);d=atob(d);B&&B.headers&&B.headers.length&&(d=B.restore(d),B.purge());f.parentNode.removeChild(f);g({success:!0,data:d})}else g({success:!1})};n.src=d})}function h(){function a(b,c){var g=d?0:-8*(c-1),f=0,h;for(h=0;h<c;h++)f|=e.charCodeAt(b+h)<<Math.abs(g+8*h);return f}function c(a,
b,d){d=3===arguments.length?d:e.length-b-1;e=e.substr(0,b)+a+e.substr(d+b)}var d=!1,e;return{II:function(a){if(a===b)return d;d=a},init:function(a){d=!1;e=a},SEGMENT:function(a,b,d){switch(arguments.length){case 1:return e.substr(a,e.length-a-1);case 2:return e.substr(a,b);case 3:c(d,a,b);break;default:return e}},BYTE:function(b){return a(b,1)},SHORT:function(b){return a(b,2)},LONG:function(e,g){if(g===b)return a(e,4);var f="",h=d?0:-24,k;for(k=0;4>k;k++)f+=String.fromCharCode(g>>Math.abs(h+8*k)&
255);c(f,e,4)},SLONG:function(b){b=a(b,4);return 2147483647<b?b-4294967296:b},STRING:function(b,c){for(var d="",c=c+b;b<c;b++)d+=String.fromCharCode(a(b,1));return d}}}function k(a){var c={65505:{app:"EXIF",name:"APP1",signature:"Exif\x00"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\x00"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\x00"}},d=[],e,g,f=b,l=0;e=new h;e.init(a);if(65496===e.SHORT(0)){g=2;for(a=Math.min(1048576,a.length);g<=a;)if(f=e.SHORT(g),65488<=f&&65495>=f)g+=
2;else{if(65498===f||65497===f)break;l=e.SHORT(g+2)+2;c[f]&&e.STRING(g+4,c[f].signature.length)===c[f].signature&&d.push({hex:f,app:c[f].app.toUpperCase(),name:c[f].name.toUpperCase(),start:g,length:l,segment:e.SEGMENT(g,l)});g+=l}e.init(null);return{headers:d,restore:function(a){e.init(a);var b=new k(a);if(!b.headers)return!1;for(a=b.headers.length;0<a;a--){var c=b.headers[a-1];e.SEGMENT(c.start,c.length,"")}b.purge();g=65504==e.SHORT(2)?4+e.SHORT(4):2;a=0;for(b=d.length;a<b;a++)e.SEGMENT(g,0,d[a].segment),
g+=d[a].length;return e.SEGMENT()},get:function(a){for(var b=[],c=0,e=d.length;c<e;c++)d[c].app===a.toUpperCase()&&b.push(d[c].segment);return b},set:function(a,b){var c=[];"string"===typeof b?c.push(b):c=b;for(var e=ii=0,g=d.length;e<g&&!(d[e].app===a.toUpperCase()&&(d[e].segment=c[ii],d[e].length=c[ii].length,ii++),ii>=c.length);e++);},purge:function(){d=[];e.init(null)}}}}function l(){function c(a,e){var h=d.SHORT(a),k,l,m,n,o,q=[],C={};for(k=0;k<h;k++)if(o=a+12*k+2,m=e[d.SHORT(o)],m!==b){l=d.SHORT(o+=
2);n=d.LONG(o+=2);o+=4;q=[];switch(l){case 1:case 7:4<n&&(o=d.LONG(o)+g.tiffHeader);for(l=0;l<n;l++)q[l]=d.BYTE(o+l);break;case 2:4<n&&(o=d.LONG(o)+g.tiffHeader);C[m]=d.STRING(o,n-1);continue;case 3:2<n&&(o=d.LONG(o)+g.tiffHeader);for(l=0;l<n;l++)q[l]=d.SHORT(o+2*l);break;case 4:1<n&&(o=d.LONG(o)+g.tiffHeader);for(l=0;l<n;l++)q[l]=d.LONG(o+4*l);break;case 5:o=d.LONG(o)+g.tiffHeader;for(l=0;l<n;l++)q[l]=d.LONG(o+4*l)/d.LONG(o+4*l+4);break;case 9:o=d.LONG(o)+g.tiffHeader;for(l=0;l<n;l++)q[l]=d.SLONG(o+
4*l);break;case 10:o=d.LONG(o)+g.tiffHeader;for(l=0;l<n;l++)q[l]=d.SLONG(o+4*l)/d.SLONG(o+4*l+4);break;default:continue}n=1==n?q[0]:q;C[m]=f.hasOwnProperty(m)&&"object"!=typeof n?f[m][n]:n}return C}var d,e,g={},f;d=new h;e={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",
37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{"0":"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};f={ColorSpace:{1:"sRGB","0":"Uncalibrated"},MeteringMode:{"0":"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",
2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{"0":"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",
9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",
71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},
ExposureMode:{"0":"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{"0":"Auto white balance",1:"Manual white balance"},SceneCaptureType:{"0":"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{"0":"Normal",1:"Soft",2:"Hard"},Saturation:{"0":"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{"0":"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};return{init:function(a){g=
{tiffHeader:10};if(a===b||!a.length)return!1;d.init(a);65505===d.SHORT(0)&&"EXIF\x00"===d.STRING(4,5).toUpperCase()?(a=b,a=g.tiffHeader,d.II(18761==d.SHORT(a)),42!==d.SHORT(a+=2)?a=!1:(g.IFD0=g.tiffHeader+d.LONG(a+2),a=c(g.IFD0,e.tiff),g.exifIFD="ExifIFDPointer"in a?g.tiffHeader+a.ExifIFDPointer:b,g.gpsIFD="GPSInfoIFDPointer"in a?g.tiffHeader+a.GPSInfoIFDPointer:b,a=!0)):a=!1;return a},EXIF:function(){var b;b=c(g.exifIFD,e.exif);if(b.ExifVersion&&"array"===a.typeOf(b.ExifVersion)){for(var d=0,f="";d<
b.ExifVersion.length;d++)f+=String.fromCharCode(b.ExifVersion[d]);b.ExifVersion=f}return b},GPS:function(){var a;a=c(g.gpsIFD,e.gps);a.GPSVersionID&&(a.GPSVersionID=a.GPSVersionID.join("."));return a},setExif:function(a,b){var c;if("PixelXDimension"!==a&&"PixelYDimension"!==a)c=!1;else{c=a;var f,h,k,l=0;if("string"===typeof c)for(hex in f=e.exif,f)if(f[hex]===c){c=hex;break}f=g.exifIFD;h=d.SHORT(f);for(i=0;i<h;i++)if(k=f+12*i+2,d.SHORT(k)==c){l=k+8;break}l?(d.LONG(l,b),c=!0):c=!1}return c},getBinary:function(){return d.SEGMENT()}}}
var m={},n;a.runtimes.Html5=a.addRuntime("html5",{getFeatures:function(){var b,d,e,g,h,k;d=e=h=k=!1;f.XMLHttpRequest&&(b=new XMLHttpRequest,e=!!b.upload,d=!(!b.sendAsBinary&&!b.upload));d&&(g=!!(b.sendAsBinary||f.Uint8Array&&f.ArrayBuffer),h=!(!File||!File.prototype.getAsDataURL&&!f.FileReader||!g),k=!(!File||!File.prototype.mozSlice&&!File.prototype.webkitSlice&&!File.prototype.slice));n=a.ua.safari&&a.ua.windows;b=d;d=c.createElement("div");return{html5:b,dragdrop:"draggable"in d||"ondragstart"in
d&&"ondrop"in d,jpgresize:h,pngresize:h,multipart:h||!!f.FileReader||!!f.FormData,canSendBinary:g,cantSendBlobInFormData:!(!a.ua.gecko||!f.FormData||!f.FileReader||FileReader.prototype.readAsArrayBuffer),progress:e,chunks:k,multi_selection:!(a.ua.safari&&a.ua.windows),triggerDialog:a.ua.gecko&&f.FormData||a.ua.webkit}},init:function(b,d){function h(c){var d,e,g=[],f,k={};for(e=0;e<c.length;e++)d=c[e],k[d.name]||(k[d.name]=!0,f=a.guid(),m[f]=d,g.push(new a.File(f,d.fileName||d.name,d.fileSize||d.size)));
g.length&&b.trigger("FilesAdded",g)}var k,l;k=this.getFeatures();k.html5?(b.bind("Init",function(d){var e,g,f=[],k,l,m=d.settings.filters,n,p;k=c.body;e=c.createElement("div");e.id=d.id+"_html5_container";a.extend(e.style,{position:"absolute",background:b.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:b.settings.shim_bgcolor?"":0});e.className="plupload html5";b.settings.container&&(k=c.getElementById(b.settings.container),"static"===a.getStyle(k,
"position")&&(k.style.position="relative"));k.appendChild(e);k=0;a:for(;k<m.length;k++){n=m[k].extensions.split(/,/);for(l=0;l<n.length;l++){if("*"===n[l]){f=[];break a}(p=a.mimeTypes[n[l]])&&-1===a.inArray(p,f)&&f.push(p)}}e.innerHTML='<input id="'+b.id+'_html5"  style="font-size:999px" type="file" accept="'+f.join(",")+'" '+(b.settings.multi_selection&&b.features.multi_selection?'multiple="multiple"':"")+" />";e.scrollTop=100;f=c.getElementById(b.id+"_html5");d.features.triggerDialog?a.extend(f.style,
{position:"absolute",width:"100%",height:"100%"}):a.extend(f.style,{cssFloat:"right",styleFloat:"right"});f.onchange=function(){h(this.files);this.value=""};if(g=c.getElementById(d.settings.browse_button)){var s=d.settings.browse_button_hover,t=d.settings.browse_button_active;e=d.features.triggerDialog?g:e;s&&(a.addEvent(e,"mouseover",function(){a.addClass(g,s)},d.id),a.addEvent(e,"mouseout",function(){a.removeClass(g,s)},d.id));t&&(a.addEvent(e,"mousedown",function(){a.addClass(g,t)},d.id),a.addEvent(c.body,
"mouseup",function(){a.removeClass(g,t)},d.id));d.features.triggerDialog&&a.addEvent(g,"click",function(a){var b=c.getElementById(d.id+"_html5");b&&!b.disabled&&b.click();a.preventDefault()},d.id)}}),b.bind("PostInit",function(){var d=c.getElementById(b.settings.drop_element);d&&(n?a.addEvent(d,"dragenter",function(){var e,g;e=c.getElementById(b.id+"_drop");e||(e=c.createElement("input"),e.setAttribute("type","file"),e.setAttribute("id",b.id+"_drop"),e.setAttribute("multiple","multiple"),a.addEvent(e,
"change",function(){h(this.files);a.removeEvent(e,"change",b.id);e.parentNode.removeChild(e)},b.id),d.appendChild(e));a.getPos(d,c.getElementById(b.settings.container));g=a.getSize(d);"static"===a.getStyle(d,"position")&&a.extend(d.style,{position:"relative"});a.extend(e.style,{position:"absolute",display:"block",top:0,left:0,width:g.w+"px",height:g.h+"px",opacity:0})},b.id):(a.addEvent(d,"dragover",function(a){a.preventDefault()},b.id),a.addEvent(d,"drop",function(a){var b=a.dataTransfer;b&&b.files&&
h(b.files);a.preventDefault()},b.id)))}),b.bind("Refresh",function(d){var e,g,f;if(e=c.getElementById(b.settings.browse_button))g=a.getPos(e,c.getElementById(d.settings.container)),f=a.getSize(e),d=c.getElementById(b.id+"_html5_container"),a.extend(d.style,{top:g.y+"px",left:g.x+"px",width:f.w+"px",height:f.h+"px"}),b.features.triggerDialog&&("static"===a.getStyle(e,"position")&&a.extend(e.style,{position:"relative"}),g=parseInt(a.getStyle(e,"z-index"),10),isNaN(g)&&(g=0),a.extend(e.style,{zIndex:g}),
a.extend(d.style,{zIndex:g-1}))}),b.bind("DisableBrowse",function(a,b){var d=c.getElementById(a.id+"_html5");d&&(d.disabled=b)}),b.bind("CancelUpload",function(){l.abort&&l.abort()}),b.bind("UploadFile",function(b,c){function d(a,b,c){var e;if(File.prototype.slice)try{return a.slice(),a.slice(b,c)}catch(g){return a.slice(b,c-b)}else return(e=File.prototype.webkitSlice||File.prototype.mozSlice)?e.call(a,b,c):null}function h(e){function g(){function h(d){var e=0,n="----pluploadboundary"+a.guid(),p,
z="";l=new XMLHttpRequest;l.upload&&(l.upload.onprogress=function(a){c.loaded=Math.min(c.size,o+a.loaded-e);b.trigger("UploadProgress",c)});l.onreadystatechange=function(){var e,f;if(l.readyState==4&&b.state!==a.STOPPED){try{e=l.status}catch(h){e=0}if(e>=400)b.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:c,status:e});else{if(v){f={chunk:m,chunks:v,response:l.responseText,status:e};b.trigger("ChunkUploaded",c,f);o=o+M;if(f.cancelled){c.status=a.FAILED;return}c.loaded=
Math.min(c.size,(m+1)*H)}else c.loaded=c.size;b.trigger("UploadProgress",c);d=q=p=z=null;if(!v||++m>=v){c.status=a.DONE;b.trigger("FileUploaded",c,{response:l.responseText,status:e})}else g()}}};if(b.settings.multipart&&k.multipart){x.name=c.target_name||c.name;l.open("post",N,!0);a.each(b.settings.headers,function(a,b){l.setRequestHeader(b,a)});if("string"!==typeof d&&f.FormData){p=new FormData;a.each(a.extend(x,b.settings.multipart_params),function(a,b){p.append(b,a)});p.append(b.settings.file_data_name,
d);l.send(p);return}if("string"===typeof d){l.setRequestHeader("Content-Type","multipart/form-data; boundary="+n);a.each(a.extend(x,b.settings.multipart_params),function(a,b){z=z+("--"+n+'\r\nContent-Disposition: form-data; name="'+b+'"\r\n\r\n');z=z+(unescape(encodeURIComponent(a))+"\r\n")});K=a.mimeTypes[c.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";z+="--"+n+'\r\nContent-Disposition: form-data; name="'+b.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(c.name))+
'"\r\nContent-Type: '+K+"\r\n\r\n"+d+"\r\n--"+n+"--\r\n";e=z.length-d.length;d=z;if(l.sendAsBinary)l.sendAsBinary(d);else if(k.canSendBinary){for(var y=new Uint8Array(d.length),A=0;A<d.length;A++)y[A]=d.charCodeAt(A)&255;l.send(y.buffer)}return}}N=a.buildUrl(b.settings.url,a.extend(x,b.settings.multipart_params));l.open("post",N,!0);l.setRequestHeader("Content-Type","application/octet-stream");a.each(b.settings.headers,function(a,b){l.setRequestHeader(b,a)});l.send(d)}var q,v,x,H,M,K,N=b.settings.url;
c.status==a.DONE||c.status==a.FAILED||b.state==a.STOPPED||((x={name:c.target_name||c.name},n.chunk_size&&c.size>n.chunk_size&&(k.chunks||"string"==typeof e)?(H=n.chunk_size,v=Math.ceil(c.size/H),M=Math.min(H,c.size-m*H),q="string"==typeof e?e.substring(m*H,m*H+M):d(e,m*H,m*H+M),x.chunk=m,x.chunks=v):(M=c.size,q=e),b.settings.multipart&&k.multipart&&"string"!==typeof q&&p&&k.cantSendBlobInFormData&&k.chunks&&b.settings.chunk_size)?(p.onload=function(){h(p.result)},p.readAsBinaryString(q)):h(q))}var m=
0,o=0,p="FileReader"in f?new FileReader:null;g()}var n=b.settings,o;o=m[c.id];k.jpgresize&&b.settings.resize&&/\.(png|jpg|jpeg)$/i.test(c.name)?g.call(b,c,b.settings.resize,/\.png$/i.test(c.name)?"image/png":"image/jpeg",function(a){a.success?(c.size=a.data.length,h(a.data)):k.chunks?h(o):e(o,h)}):!k.chunks&&k.jpgresize?e(o,h):h(o)}),b.bind("Destroy",function(b){var d,e,g=c.body,f={inputContainer:b.id+"_html5_container",inputFile:b.id+"_html5",browseButton:b.settings.browse_button,dropElm:b.settings.drop_element};
for(d in f)(e=c.getElementById(f[d]))&&a.removeAllEvents(e,b.id);a.removeAllEvents(c.body,b.id);b.settings.container&&(g=c.getElementById(b.settings.container));g.removeChild(c.getElementById(f.inputContainer))}),d({success:!0})):d({success:!1})}})})(window,document,plupload);
(function(f,c,a){function b(a){return c.getElementById(a)}a.runtimes.Html4=a.addRuntime("html4",{getFeatures:function(){return{multipart:!0,triggerDialog:a.ua.gecko&&f.FormData||a.ua.webkit}},init:function(d,e){d.bind("Init",function(e){function h(){var f,k,m,n;p=a.guid();q.push(p);f=c.createElement("form");f.setAttribute("id","form_"+p);f.setAttribute("method","post");f.setAttribute("enctype","multipart/form-data");f.setAttribute("encoding","multipart/form-data");f.setAttribute("target",e.id+"_iframe");
f.style.position="absolute";k=c.createElement("input");k.setAttribute("id","input_"+p);k.setAttribute("type","file");k.setAttribute("accept",t);k.setAttribute("size",1);n=b(e.settings.browse_button);e.features.triggerDialog&&n&&a.addEvent(b(e.settings.browse_button),"click",function(a){k.disabled||k.click();a.preventDefault()},e.id);a.extend(k.style,{width:"100%",height:"100%",opacity:0,fontSize:"99px"});a.extend(f.style,{overflow:"hidden"});if(m=e.settings.shim_bgcolor)f.style.background=m;s&&a.extend(k.style,
{filter:"alpha(opacity=0)"});a.addEvent(k,"change",function(c){var l=c.target,c=[];l.value&&(b("form_"+p).style.top="-1048575px",l=l.value.replace(/\\/g,"/"),l=l.substring(l.length,l.lastIndexOf("/")+1),c.push(new a.File(p,l)),e.features.triggerDialog?a.removeEvent(n,"click",e.id):a.removeAllEvents(f,e.id),a.removeEvent(k,"change",e.id),h(),c.length&&d.trigger("FilesAdded",c))},e.id);f.appendChild(k);l.appendChild(f);e.refresh()}function k(){var b=c.createElement("div");b.innerHTML='<iframe id="'+
e.id+'_iframe" name="'+e.id+'_iframe" src="'+n+':&quot;&quot;" style="display:none"></iframe>';m=b.firstChild;l.appendChild(m);a.addEvent(m,"load",function(b){var b=b.target,c;if(o){try{c=b.contentWindow.document||b.contentDocument||f.frames[b.id].document}catch(d){e.trigger("Error",{code:a.SECURITY_ERROR,message:a.translate("Security error."),file:o});return}c=c.body.innerHTML;c.match(/success/)?(o.status=a.DONE,o.loaded=1025,o.percent=100,e.trigger("UploadProgress",o),e.trigger("FileUploaded",o,
{response:c})):e.trigger("Error",{code:a.GENERIC_ERROR,message:c,file:o})}},e.id)}var l=c.body,m,n="javascript",o,p,q=[],s=/MSIE/.test(navigator.userAgent),t=[],r=e.settings.filters,u,D,x,A;u=0;a:for(;u<r.length;u++){D=r[u].extensions.split(/,/);for(A=0;A<D.length;A++){if("*"===D[A]){t=[];break a}(x=a.mimeTypes[D[A]])&&-1===a.inArray(x,t)&&t.push(x)}}t=t.join(",");e.settings.container&&(l=b(e.settings.container),"static"===a.getStyle(l,"position")&&(l.style.position="relative"));e.bind("UploadFile",
function(d,e){var g;if(!(e.status==a.DONE||e.status==a.FAILED||d.state==a.STOPPED)){g=b("form_"+e.id);b("input_"+e.id).setAttribute("name",d.settings.file_data_name);g.setAttribute("action",d.settings.url);a.each(a.extend({name:e.target_name||e.name},d.settings.multipart_params),function(b,d){var e=c.createElement("input");a.extend(e,{type:"hidden",name:d,value:b});g.insertBefore(e,g.firstChild)});o=e;b("form_"+p).style.top="-1048575px";g.submit();g.parentNode.removeChild(g)}});e.bind("FileUploaded",
function(a){a.refresh()});e.bind("StateChanged",function(b){b.state==a.STARTED&&k();b.state==a.STOPPED&&f.setTimeout(function(){a.removeEvent(m,"load",b.id);m.parentNode&&m.parentNode.removeChild(m)},0)});e.bind("Refresh",function(d){var e,g,f,h,k,l;if(e=b(d.settings.browse_button)){k=a.getPos(e,b(d.settings.container));l=a.getSize(e);g=b("form_"+p);b("input_"+p);a.extend(g.style,{top:k.y+"px",left:k.x+"px",width:l.w+"px",height:l.h+"px"});if(d.features.triggerDialog){a.getStyle(e,"position")==="static"&&
a.extend(e.style,{position:"relative"});k=parseInt(e.style.zIndex,10);isNaN(k)&&(k=0);a.extend(e.style,{zIndex:k});a.extend(g.style,{zIndex:k-1})}f=d.settings.browse_button_hover;h=d.settings.browse_button_active;g=d.features.triggerDialog?e:g;if(f){a.addEvent(g,"mouseover",function(){a.addClass(e,f)},d.id);a.addEvent(g,"mouseout",function(){a.removeClass(e,f)},d.id)}if(h){a.addEvent(g,"mousedown",function(){a.addClass(e,h)},d.id);a.addEvent(c.body,"mouseup",function(){a.removeClass(e,h)},d.id)}}});
d.bind("FilesRemoved",function(a,c){var d,e;for(d=0;d<c.length;d++)(e=b("form_"+c[d].id))&&e.parentNode.removeChild(e)});d.bind("DisableBrowse",function(a,b){var d=c.getElementById("input_"+p);if(d)d.disabled=b});d.bind("Destroy",function(d){var e,g,f,h={inputContainer:"form_"+p,inputFile:"input_"+p,browseButton:d.settings.browse_button};for(e in h)(g=b(h[e]))&&a.removeAllEvents(g,d.id);a.removeAllEvents(c.body,d.id);a.each(q,function(a){(f=b("form_"+a))&&l.removeChild(f)})});h()});e({success:!0})}})})(window,
document,plupload);
(function(f,c){f.create("wikispaces.plugins.ImageOverlay",{init:function(a,b){var c=this;a.onInit.add(function(a){var b=function(a){a.onClick.add(function(a,b){a.plugins.wsimage.isFilePlaceholder(b.target)?c.show(a,b.target):c.hide()})};a.onInitSubEditor.add(b);b(a)});this.overlayInit(a,b)},overlayInit:function(a){var b=this;a.onModeSwitch.add(function(a){"plain"==a&&b.hide()});a.onKeyDown.add(function(a,c){if(b.img&&(8==c.keyCode||46==c.keyCode))return b.removeImage(),!1});c(window).resize(function(){b.img&&c(b.img).is(":visible")&&
b.repositionAndShow()})},getInfo:function(){return{longname:"Wikispaces image overlay",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},overlayContent:function(){return ws.editor.content.loadContent("imageProperties")},show:function(a,b){var d=this;this.editor=a;this.img!=b&&(this.img=b,null==this.overlay&&(this.overlay=c("<div>").addClass("WikiOverlay overlayLayer").css({position:"absolute"}).html(this.overlayContent()).hide().appendTo("#pageEditor"),
this.setup()),f.mainEditor.plugins.wstableoverlay.unselectTableCell(),this.refreshLinkStatus(!0),this.refreshAlignment(),this.setCaption(c(this.img).attr("alt"),!0),c(this.img).hasClass("WikiMediaFile")?(c("#imageAttributes").hide(),c("#imageAppearance").show(),c("#fileRemove").show(),c("#docRemove").hide()):c(this.img).hasClass("WikiFile")?(c("#imageAttributes").hide(),c("#imageAppearance").hide(),c("#fileRemove").show(),c("#docRemove").hide()):c(this.img).hasClass("GoogleDoc")?(c("#imageAttributes").hide(),
c("#imageAppearance").hide(),c("#fileRemove").hide(),c("#docRemove").show()):(c("#imageAttributes").show(),c("#imageAppearance").show(),c("#fileRemove").show(),c("#docRemove").hide()),0<c(this.img).height()?this.toggleFitImage():c(this.img).load(function(){d.toggleFitImage(b)}),this.repositionAndShow())},hide:function(){c(this.img).closest("td,th").length&&f.mainEditor.plugins.wstableoverlay.selectTableCell(c(this.img).closest("td,th").get(0));this.img=null;this.overlay&&this.overlay.hide()},repositionAndShow:function(){this.overlay.css({left:"-10000px",
top:"-10000px"}).show();this.overlay.css(this.editor.plugins.wscommon.positionBelow(this.overlay,this.img))},refreshLinkStatus:function(a){null!=this.img&&(this.findParentLinkElement(this.img)?this.setImageLink(this.findParentLinkElement(this.img).href,a):this.unsetImageLink(a))},currentAlignment:function(){if(null==this.img)return null;var a=c(this.img).parent("div");return a.length&&"center"==a.css("text-align")?"center":c(this.img).attr("align")},refreshAlignment:function(){c("#imageAlign a").removeClass("buttonSelected");
switch(this.currentAlignment()){case "left":c("#imageAlignLeft").addClass("buttonSelected");break;case "center":c("#imageAlignCenter").addClass("buttonSelected");break;case "right":c("#imageAlignRight").addClass("buttonSelected")}},setCaption:function(a,b){c("#captionText").html(ws.common.truncify(a,80));c("#imageCaptionInput").val(a);c(this.img).attr("alt",a);c("#captionEditor").hide();c("#existingCaption").show();a?(c("#addImageCaption").hide(),c("#imageCaptionControls").show()):(c("#addImageCaption").show(),
c("#imageCaptionControls").hide());b||this.repositionAndShow()},editCaption:function(){c("#imageCaptionControls").show();c("#existingCaption").hide();c("#captionEditor").show();c("#imageCaptionInput").focus()},setup:function(){var a=this;c("#imageAlignLeft").click(function(){a.setImageAlignment("left");return!1});c("#imageAlignCenter").click(function(){a.setImageAlignment("center");return!1});c("#imageAlignRight").click(function(){a.setImageAlignment("right");return!1});c("#imageAlignNone").click(function(){a.setImageAlignment("");
return!1});c("#imageSizeDown").click(function(){a.adjustImageSize(-0.1);return!1});c("#imageSizeUp").click(function(){a.adjustImageSize(0.1);return!1});c("#imageSizeOriginal").click(function(){a.adjustImageSize(0,!0);return!1});c("#imageSizeFit").click(function(){a.adjustImageSize(0,!1,!0);return!1});c("#addImageCaption, #editCaption").click(function(){a.editCaption();return!1});c("#saveImageCaption").click(function(){a.setCaption(c("#imageCaptionInput").val());return!1});c("#cancelCaption").click(function(){a.setCaption(c(a.img).attr("alt"));
return!1});c("#removeCaption").click(function(){a.setCaption(null);return!1});c("#addImageLink, #editImageLink").click(function(){a.editor.selection.select(a.img);a.editor.execCommand("wslink");return!1});c("#removeImageLink").click(function(){c(a.img).parent("a").replaceWith(c(a.img).parent("a").contents());a.unsetImageLink();a.editor.wsselection.updateBookmarkToNode(a.img);return!1});c("#visitImageLink").click(function(){window.open(c(a.img).parent("a").attr("href"));return!1});c(".imageRemoveLink").click(function(){a.removeImage();
return!1})},removeImage:function(){this.editor.undoManager.begin();var a=c(this.img);this.findCenteringElement(this.img)?a=c(this.findCenteringElement(this.img)):this.findParentLinkElement(this.img)&&(a=c(this.findParentLinkElement(this.img)));var b=c("<span>",this.editor.getDoc()).insertBefore(a);a.remove();this.editor.plugins.wscommon.cursorToAndRemoveElement(b);this.editor.undoManager.end();this.hide()},toggleFitImage:function(){800<c(this.img).width()?c("#imageSizeFit").show():c("#imageSizeFit").hide()},
setImageLink:function(a,b){c("#imageLinkText").html(ws.common.truncify(a,60)).attr("title",a);c("#imageLinkControls").show();c("#addImageLink").hide();b||this.repositionAndShow()},unsetImageLink:function(a){c("#imageLinkControls").hide();c("#addImageLink").show();a||this.repositionAndShow()},updateImageCaption:function(a,b){c(this.img).attr("alt",a);b||this.repositionAndShow()},setImageAlignment:function(a,b){if("center"==a){if(this.findCenteringElement(this.img))return;this.img.align="";var d=c("<div>",
this.img.ownerDocument).css("text-align","center"),e=c(this.img);e.parent().is("a")&&(e=e.parent());e.replaceWith(d).appendTo(d)}else(d=this.findCenteringElement(this.img))&&c(d).replaceWith(d.childNodes),this.img.align=a;this.refreshAlignment();b||this.repositionAndShow()},findCenteringElement:function(a){for(;a;){if(a.tagName&&("CENTER"==a.tagName.toUpperCase()||"DIV"==a.tagName.toUpperCase()&&("center"==a.style.textAlign||"center"==a.align)))return a;if(a.parentNode)a=a.parentNode;else break}return null},
findParentLinkElement:function(a){return c(a).parent("a[href]").get(0)},adjustImageSize:function(a,b,d){var e=this,g=c(this.img);this.starting_width&&this.starting_height?this.adjustImageSizeCallback(a,b,d):0<g.width()&&0<g.height()?(this.starting_width=g.width(),this.starting_height=g.height(),this.adjustImageSizeCallback(a,b,d)):g.load(function(){this.starting_width=g.width();this.starting_height=g.height();e.adjustImageSizeCallback(a,b,d)})},adjustImageSizeCallback:function(a,b,d){var e=c(this.img);
if(b)e.removeAttr("height").removeAttr("width").css({height:"auto",width:"auto"}),this.repositionAndShow();else{var g,f;d?800<this.starting_width?(f=800,g=Math.round(800/this.starting_width*this.starting_height)):(f=this.starting_width,g=this.starting_height):0!=a&&(g=e.height()/this.starting_height,b=e.width()/this.starting_width,g=Math.floor(this.starting_height*(g+a)),f=Math.floor(this.starting_width*(b+a)));0<g&&0<f&&g>=Math.floor(0.05*this.starting_height)&&f>=Math.floor(0.05*this.starting_width)&&
(e.height(g),e.width(f));this.repositionAndShow();this.toggleFitImage();this.editor.plugins.autoresize&&this.editor.plugins.autoresize.fitEditor();this.editor.onNeedsResize&&this.editor.onNeedsResize.dispatch()}}});f.PluginManager.add("wsimageoverlay",wikispaces.plugins.ImageOverlay)})(tinymce,jQuery);
(function(f){var c=f.util.Dispatcher;f.UndoManager=function(a){function b(){return f.trim(a.getContent({format:"raw",no_events:1}))}var d;return d={typing:0,onAdd:new c(d),onUndo:new c(d),onRedo:new c(d),undoData:[],currentLevel:null,redoData:[],nestLevel:0,getLevels:function(){var a=[],b=[];jQuery.each(this.undoData,function(){a.push(this.content)});jQuery.each(this.redoData,function(){b.push(this.content)});return[a,this.currentLevel.content,b]},begin:function(){this.add();++this.nestLevel},end:function(){--this.nestLevel;
this.add()},add:function(b){return f.mainEditor.plugins.wsundomain.add(a,b)},remove:function(){return f.mainEditor.plugins.wsundomain.remove(a)},undo:function(){a.onChange.dispatch();return f.mainEditor.plugins.wsundomain.undo()},redo:function(){a.onChange.dispatch();return f.mainEditor.plugins.wsundomain.redo()},clear:function(){return f.mainEditor.plugins.wsundomain.clear()},hasUndo:function(){return f.mainEditor.plugins.wsundomain.hasUndo()},hasRedo:function(){return f.mainEditor.plugins.wsundomain.hasRedo()},
updateButtonState:function(){return f.mainEditor.plugins.wsundomain.updateButtonState()},subAdd:function(c){if(0<this.nestLevel)return null;var g=a.settings,c=c||{};c.content=b();if(d.currentLevel&&d.currentLevel.content==c.content)return null;g.custom_undo_redo_levels&&d.redoData.length+d.undoData.length>g.custom_undo_redo_levels+1&&d.dropOldestUndo();c.bookmark=a.selection.getBookmark(2,!0);d.clearRedo();d.undoData.push(d.currentLevel);d.currentLevel=c;d.onAdd.dispatch(d,c);a.isNotDirty=0;return c},
subRemove:function(){return 0<this.nestLevel?null:d.undoData.pop()},beforeChange:function(){d.currentLevel&&(d.currentLevel.beforeBookmark=a.selection.getBookmark(2,!0))},clearRedo:function(){d.redoData=[]},dropOldestUndo:function(){return d.undoData.shift()},subUndo:function(){d.typing&&(d.add(),d.typing=0);if(!d.subHasUndo())return null;d.redoData.push(d.currentLevel);d.currentLevel=d.undoData.pop();a.setContent(d.currentLevel.content,{format:"raw",no_events:!0});a.selection.moveToBookmark(d.currentLevel.beforeBookmark);
d.onUndo.dispatch(d,d.currentLevel);return d.currentLevel},subRedo:function(){if(!d.subHasRedo())return null;d.undoData.push(d.currentLevel);d.currentLevel=d.redoData.pop();a.setContent(d.currentLevel.content,{format:"raw",no_events:!0});a.selection.moveToBookmark(d.currentLevel.bookmark);d.onRedo.dispatch(d,d.currentLevel);return d.currentLevel},subClear:function(){d.undoData=[];d.currentLevel={content:b(),bookmark:a.selection.getBookmark(2,!0)};d.redoData=[];d.typing=0},subHasUndo:function(){return 0<
d.undoData.length||d.typing},subHasRedo:function(){return 0<d.redoData.length}}};f.create("wikispaces.plugins.UndoPlugin",{init:function(a){a.onNodeChange.add(function(a){a.undoManager.updateButtonState()});a.onDeactivate.add(function(a){a.initialized&&a.undoManager.typing&&(a.undoManager.add(),a.undoManager.typing=0)});a.onInit.add(function(a){a.undoManager.subClear();f.mainEditor.plugins.wsundomain.removeEditor(a)});a.onKeyDown.add(function(a,c){16==c.keyCode||17==c.keyCode||18==c.keyCode||a.undoManager.updateButtonState()})}});
f.PluginManager.add("wsundo",wikispaces.plugins.UndoPlugin)})(tinymce);
(function(f,c){f.create("wikispaces.plugins.TableOverlay",{selectedTableCell:null,init:function(a){var b=this;a.onModeSwitch.add(function(a){"plain"==a&&b.hide()});c(window).resize(function(){b.selectedTableCell&&c(b.selectedTableCell).is(":visible")&&b.show(a,b.selectedTableCell)});this.emptyCellContents=f.isIE?"&nbsp;":"<br/>"},show:function(a,b){this.editor=a;this.cell=b;this.menuHandleLoaded||(c("#pageEditor").append(ws.editor.content.loadContent("tableMenu")),this.setupMenu(),this.menuHandleLoaded=
!0);c("#tablePropertiesMenuHandle").css({position:"absolute",left:"-10000px",top:"-10000px"}).addClass("overlayLayer").show();c("#tableProperties").hide();var d=this.editor.plugins.wscommon.getPositionWith(c("#tablePropertiesMenuHandle").get(0),c(this.cell).get(0),2);c("#tablePropertiesMenuHandle").css(d);this.updateMenu(b)},showProperties:function(){c("#tableProperties").css({position:"absolute",left:"-10000px",top:"-10000px"}).addClass("overlayLayer").show();c("#tablePropertiesMenuHandle").hide();
var a=this.editor.plugins.wscommon.getPositionWith(c("#tableProperties").get(0),c(this.cell).get(0),2);c("#tableProperties").css(a)},hide:function(){c("#tablePropertiesMenuHandle").hide();c("#tableProperties").hide()},updateMenu:function(a){c(a).is("td")?(c("#tablePropertiesList .headerToggleLabel").text("Make Header"),c("#tablePropertiesList .alignmentMenu").not(".tableAlignmentMenu").removeClass("disabledMenu")):(c("#tablePropertiesList .headerToggleLabel").text("Remove Header"),c("#tablePropertiesList .alignmentMenu").not(".tableAlignmentMenu").addClass("disabledMenu"));
1<c(a).attr("colspan")?c("#tablePropertiesList .mergeSplit").removeClass("disabledMenu"):c("#tablePropertiesList .mergeSplit").addClass("disabledMenu");0<c(a).prev("td,th").length?c("#tablePropertiesList .mergeLeft").removeClass("disabledMenu"):c("#tablePropertiesList .mergeLeft").addClass("disabledMenu");0<c(a).next("td,th").length?c("#tablePropertiesList .mergeRight").removeClass("disabledMenu"):c("#tablePropertiesList .mergeRight").addClass("disabledMenu")},tablePropertiesShow:function(a,b){a.is("ul")&&
a.is(":visible")&&a.slideUp("fast");a.is("ul")&&!a.is(":visible")&&(c(b).slideUp("fast"),a.slideDown("fast"))},getScope:function(a){var b,a=c(a);if(a.is("#cellItem")||a.parents("#cellItem").length)b="Cell";else if(a.is("#rowItem")||a.parents("#rowItem").length)b="Row";else if(a.is("#colItem")||a.parents("#colItem").length)b="Col";else if(a.is("#tableItem")||a.parents("#tableItem").length)b="Table";return b},setupMenu:function(){var a=this;c("#tablePropertiesMenuHandle").click(function(b){b.stopPropagation();
c("#tablePropertiesList ul").hide();a.showProperties();return!1});c("#tablePropertiesList ul").hide();c("#tablePropertiesList .topmenu").click(function(b){b.stopPropagation();a.tablePropertiesShow(c(this).next(),"#tablePropertiesList li ul:visible");return!1});c("#tablePropertiesList .submenu").click(function(b){b.stopPropagation();a.tablePropertiesShow(c(this).next(),"#tablePropertiesList li ul li ul:visible");return!1});c("#cellItem, #rowItem, #colItem, #tableItem").mouseover(function(){var b="highlight"+
a.getScope(this);a[b]("highlightTableCell");return!0});c("#cellItem, #rowItem, #colItem, #tableItem").mouseout(function(){a.removeHighlight();return!0});c("#tableProperties .mergeMenu li").mouseover(function(){var b,d;switch(c(this).attr("class")){case "mergeLeft":d=!0;b="highlight"+a.getScope(this)+"ForMerge";break;case "mergeRight":d=!1;b="highlight"+a.getScope(this)+"ForMerge";break;case "mergeUp":d=!0;b="highlight"+a.getScope(this)+"ForRowMerge";break;case "mergeDown":d=!1,b="highlight"+a.getScope(this)+
"ForRowMerge"}if(b)a[b](d);return!0});c("#tableProperties .mergeMenu li").mouseout(function(){a.removeHighlight("highlightTableCellForMerge");return!0});c("#tableProperties .mergeMenu li").click(function(){var b,d;switch(c(this).attr("class")){case "mergeLeft":d=!0;b="merge"+a.getScope(this);break;case "mergeRight":d=!1;b="merge"+a.getScope(this);break;case "mergeUp":d=!0;b="mergeRow"+a.getScope(this);break;case "mergeDown":d=!1;b="mergeRow"+a.getScope(this);break;case "mergeSplit":d=a.selectTableCell,
b="splitCell"}a[b](d);return!1});c("#tableProperties .headerMenu").click(function(){var b="convert"+a.getScope(this)+"Type";a[b]();return!1});c("#tableProperties .addMenu li").mouseover(function(){var b,d;switch(c(this).attr("class")){case "addPre":ws.common.log("pre");d=!0;b="addNew"+a.getScope(this);break;case "addPost":ws.common.log("post"),d=!1,b="addNew"+a.getScope(this)}a[b](!0,d);return!0});c("#tableProperties .addMenu li").mouseout(function(){a.removePreviews();return!0});c("#tableProperties .addMenu li").click(function(){var b,
d;switch(c(this).attr("class")){case "addPre":d=!0;b="addNew"+a.getScope(this);break;case "addPost":d=!1,b="addNew"+a.getScope(this)}a[b](!1,d);return!1});c("#tableProperties .alignmentMenu li").click(function(){var b="align"+a.getScope(this),d=c(this).attr("class");a[b](d);return!0});c("#tableProperties .removeMenu").mouseover(function(){var b="highlight"+a.getScope(this)+"ForRemoval";a[b]();return!0});c("#tableProperties .removeMenu").mouseout(function(){a.removeHighlight("highlightTableCellForRemoval");
return!0});c("#tableProperties .removeMenu").click(function(){var b="remove"+a.getScope(this);a[b]();return!1})},$table:function(){return c(this.selectedTableCell).closest("table.wiki_table")},selectTableCell:function(a){ws.common.log("selectTableCell",a);this.selectedTableCell=a;this.show(f.activeEditor,a)},unselectTableCell:function(){this.selectedTableCell&&(this.removeHighlight(),this.selectedTableCell=null);this.hide()},highlightCell:function(a){this.selectedTableCell&&c(this.selectedTableCell).addClass(a)},
highlightCellForMerge:function(a){this.selectedTableCell&&(a?c(this.selectedTableCell).prev("td,th").addClass("highlightTableCellForMerge"):c(this.selectedTableCell).next("td,th").addClass("highlightTableCellForMerge"))},highlightCellForRowMerge:function(a){if(this.selectedTableCell){var b=this.getColumnNumber(this.selectedTableCell);a?this.getColumnInPosition(c(this.selectedTableCell).parent().prev("tr").children("td,th"),b).addClass("highlightTableCellForMerge"):this.getColumnInPosition(c(this.selectedTableCell).parent().next("tr").children("td,th"),
b).addClass("highlightTableCellForMerge")}},convertCells:function(a,b){var d=this.editor.getDoc();this.removeHighlight();this.editor.undoManager.begin();c(a).each(function(){var a=parseInt(c(this).attr("colspan")),g=d.createElement(b);c(g).attr("colspan",a);c(g).html(c(this).html());c(this).replaceWith(g);this==this.selectedTableCell&&this.selectTableCell(g)});this.editor.undoManager.end();this.unselectTableCell()},convertCellType:function(){this.convertCells(this.selectedTableCell,c(this.selectedTableCell).is("td")?
"th":"td")},convertColType:function(){var a=this.getColCells(this.getColumnNumber(this.selectedTableCell),!1),b=c(this.selectedTableCell).is("td")?"th":"td";this.convertCells(a,b)},convertRowType:function(){var a=c(this.selectedTableCell).parent("tr").find("td,th"),b=c(this.selectedTableCell).is("td")?"th":"td";this.convertCells(a,b)},mergeCell:function(a){if(this.selectedTableCell){var b=this.editor.getDoc();this.removeHighlight();this.removePreviews();this.editor.undoManager.begin();var d=parseInt(1<
c(this.selectedTableCell).attr("colspan")?c(this.selectedTableCell).attr("colspan"):1);a?c(this.selectedTableCell).prev("td,th").remove():c(this.selectedTableCell).next("td,th").remove();a="td";c(this.selectedTableCell).is("th")&&(a="th");a=b.createElement(a);c(a).html(c(this.selectedTableCell).html());c(a).attr("colspan",d+1);c(this.selectedTableCell).replaceWith(a);this.editor.undoManager.end();d=c(a).parent("tr").eq(0);b=b.createElement("tr");c(b).html(c(d).html());c(d).after(b);c(d).remove();
this.unselectTableCell()}},splitCell:function(){if(this.selectedTableCell&&1<c(this.selectedTableCell).attr("colspan")){var a="td";c(this.selectedTableCell).is("th")&&(a="th");for(var a="<"+a+">"+c(this.selectedTableCell).html()+"</"+a+">",b=parseInt(c(this.selectedTableCell).attr("colspan"))-1,d=0;d<b;d++)a+="<td>"+this.emptyCellContents+"</td>";this.removeHighlight();this.removePreviews();this.editor.undoManager.begin();c(this.selectedTableCell).replaceWith(a);this.editor.undoManager.end();this.unselectTableCell()}},
highlightTable:function(a){this.selectedTableCell&&this.$table().find("td,th").each(function(){c(this).addClass(a)})},highlightSelectedTable:function(){this.highlightTable("highlightTableCell")},highlightTableForRemoval:function(){this.highlightTable("highlightTableCellForRemoval")},highlightSelectedRow:function(){this.highlightRow("highlightTableCell")},highlightRowForRemoval:function(){this.highlightRow("highlightTableCellForRemoval")},highlightRow:function(a){this.selectedTableCell&&c(this.selectedTableCell).parent("tr").eq(0).find("td,th").each(function(){c(this).addClass(a)})},
getColumnNumber:function(a){for(var b=0,a=c(a).prevAll("td,th"),d=0;d<a.length;d++)b+=parseInt(1<c(a[d]).attr("colspan")?c(a[d]).attr("colspan"):1);return b},getColumnInPosition:function(a,b){for(var c=0;c<a.length;c++)if(this.getColumnNumber(a[c])>=b)return a[c]},highlightSelectedCol:function(){this.highlightCol("highlightTableCell")},highlightColForRemoval:function(){this.highlightCol("highlightTableCellForRemoval")},highlightCol:function(a){if(this.selectedTableCell){var b=this.getColCells(this.getColumnNumber(this.selectedTableCell),
!1);c(b).each(function(){c(this).addClass(a)})}},removeHighlight:function(a){a?this.$table().find("."+a).each(function(){c(this).removeClass(a)}):this.$table().find(".highlightTableCell,.highlightTableCellForRemoval,.highlightTableCellForMerge").each(function(){c(this).removeClass("highlightTableCell").removeClass("highlightTableCellForRemoval").removeClass("highlightTableCellForMerge")})},addNewRow:function(a,b){if(this.selectedTableCell){for(var d=0,e=c(this.selectedTableCell).parent("tr").eq(0).find("td,th"),
g=0;g<e.length;g++)d+=parseInt(1<c(e[g]).attr("colspan")?c(e[g]).attr("colspan"):1);if(a)e='<tr class="tablePreview"><td colspan="'+d+'">'+this.emptyCellContents+"</td></tr>";else{e="<tr>";for(g=0;g<d;g++)e+="<td>"+this.emptyCellContents+"</td>";e+="</tr>";this.removeHighlight();this.removePreviews();this.editor.undoManager.begin()}b?c(this.selectedTableCell).parent("tr").eq(0).before(e):c(this.selectedTableCell).parent("tr").eq(0).after(e);a||(this.editor.undoManager.end(),this.unselectTableCell())}},
addNewCol:function(a,b){if(this.selectedTableCell){if(a)var d='<td class="tablePreview">&nbsp;&nbsp;&nbsp;&nbsp;</td>',e='<th class="tablePreview">&nbsp;&nbsp;&nbsp;&nbsp;</th>';else d="<td>"+this.emptyCellContents+"</td>",e="<th>"+this.emptyCellContents+"</th>",this.removeHighlight(),this.removePreviews(),this.editor.undoManager.begin();var g=this.getColumnNumber(this.selectedTableCell);if(!b)var f=parseInt(1<c(this.selectedTableCell).attr("colspan")?c(this.selectedTableCell).attr("colspan"):1),
g=g+f-1;var g=this.getColCells(g,!0),k=this;c(g).each(function(a){a=k.isHeaderRow(a)?e:d;b?c(this).before(a):c(this).after(a)});a||(this.editor.undoManager.end(),this.unselectTableCell())}},removeTable:function(){this.selectedTableCell&&(this.removeHighlight(),this.editor.undoManager.begin(),this.$table().remove(),this.editor.undoManager.end(),this.unselectTableCell())},removeCol:function(){if(this.selectedTableCell){var a=this.getColCells(this.getColumnNumber(this.selectedTableCell),!1);this.removeHighlight();
this.editor.undoManager.begin();c(a).each(function(){c(this).remove()});this.editor.undoManager.end();this.unselectTableCell()}},removeRow:function(){this.selectedTableCell&&(this.removeHighlight(),this.editor.undoManager.begin(),c(this.selectedTableCell).parent("tr").eq(0).remove(),this.editor.undoManager.end(),this.unselectTableCell())},alignCell:function(a){c(this.selectedTableCell).is("td")&&(this.removeHighlight(),this.editor.undoManager.begin(),c(this.selectedTableCell).css("text-align",a),
this.editor.undoManager.end(),this.unselectTableCell())},alignRow:function(a){var b=c(this.selectedTableCell).parent("tr").eq(0).find("td,th");this.removeHighlight();this.editor.undoManager.begin();c(b).each(function(){c(this).is("td")&&c(this).css("text-align",a)});this.editor.undoManager.end();this.unselectTableCell()},alignCol:function(a){var b=this.getColCells(this.getColumnNumber(this.selectedTableCell),!1);this.removeHighlight();this.editor.undoManager.begin();c(b).each(function(){c(this).is("td")&&
c(this).css("text-align",a)});this.editor.undoManager.end();this.unselectTableCell()},alignTable:function(a){var b=this.$table().find("td,th");this.removeHighlight();this.editor.undoManager.begin();c(b).each(function(){c(this).is("td")&&c(this).css("text-align",a)});this.editor.undoManager.end();this.unselectTableCell()},getColCells:function(a,b){if(this.selectedTableCell){for(var d=this.$table().find("tr"),e=[],g=0;g<d.length;g++)for(var f=c(d[g]).children(),k=0,l=0;l<f.length;l++)if(k+=parseInt(1<
c(f[l]).attr("colspan")?c(f[l]).attr("colspan"):1),k>a){e[e.length]=f[l];break}else if(k>a&&b){e[e.length]=f[l-1];break}return e}},removePreviews:function(){this.$table().find(".tablePreview").each(function(){c(this).remove()})},isHeaderRow:function(a){return _(this.$table().find("tr").eq(a).children()).all(function(a){return c(a).is("th")})}});f.PluginManager.add("wstableoverlay",wikispaces.plugins.TableOverlay)})(tinymce,jQuery);
(function(f){f.create("wikispaces.popups.Cleanup",{init:function(c){c.plugins.wspopup.register({wsname:"cleanupPopupContents",title:"Optimize Page",width:340,height:160})}});f.PluginManager.add("wscleanuppopup",wikispaces.popups.Cleanup)})(tinymce);
(function(f,c){f.create("wikispaces.popups.DraftRecovered",{editor:null,init:function(a){var b=this;b.editor=a;a.plugins.wspopup.register({wsname:"draftRecovered",title:"Draft Recovered",width:440,height:130,uiSetup:function(a){b.uiSetup(a)}})},uiSetup:function(a){var b=this.editor,d=b.plugins.wsautoload;c("#recoverDraft").click(function(c){ws.common.track("Editor","Autosave","Load");d.loadVersion(d.autosaveContent,d.autosavePageComments,d.autosaveVersion,d.autosaveCleanup);a.close();b.undoManager.clear();
b.plugins.wsautosave.autosave(!1,d.autosaveContent);c.preventDefault();return!1});c("#discardDraft").click(function(b){ws.common.track("Editor","Autosave","Discard");a.close();c.ajax({url:ws.common.pathFor("page","discardautosave",wikispaces_page),type:"GET",cache:!1,global:!1});b.preventDefault();return!1})}});f.PluginManager.add("wsdraftrecoveredpopup",wikispaces.popups.DraftRecovered)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.BrToP",{init:function(a){var b=this;b.editor=a;a.onBeforeSetContent.add(function(a,c){"raw"!=c.format&&"visual"==a.plugins.wscommon.getOption("mode")&&(c.content=b.processContent(c.content))});a.plugins.paste&&a.plugins.paste.onPostProcess.add(function(a,e){c.browser.msie&&(c("span[style]",e.node).each(function(){var a=c(this);"left"==a.css("text-align")&&a.css("text-align","")}),c("span:empty",e.node).remove(),c("p br",e.node).remove(),c("li br",e.node).remove());
var g=c(e.node).html();c(e.node).html(b.processContent(g))});a.onKeyDown.add(function(a,b){if(b.shiftKey&&13==b.keyCode){var g=c(a.selection.getNode()).closest("li,td,th,p,pre,code");if(!g.is("pre,code")){b.stopPropagation();b.preventDefault();a.undoManager.begin();a.selection.setContent('<span id="wsTemp">\ufeff</span>');g.is("p")||(g.wrapInner('<p id="wsHolder">'),g=c(g).find("#wsHolder").removeAttr("id"));g.children().last().is("br")&&g.children().last().remove();var f=!0,k=!0,l=!1;c(g).contents().each(function(b,
e){if(l&&(e.nodeType==1||!a.plugins.wscommon.isTextEmpty(e.nodeValue)))k=false;c(e).is("#wsTemp")&&(l=true);if(!l&&(e.nodeType==1||!a.plugins.wscommon.isTextEmpty(e.nodeValue)))f=false});if(!l){for(var f=!1,m=c(g).contents().get(0);!l&&m;){for(var n=1;m&&3==m.nodeType&&a.plugins.wscommon.isTextEmpty(m.nodeValue);)m=c(m).parent().contents().get(n++);c(m).is("#wsTemp")?f=l=!0:m=c(m).contents().get(0)}k=!1;for(m=c(g).contents().last().get(0);!l&&m;){for(n=c(m).parent().contents().length-2;m&&3==m.nodeType&&
a.plugins.wscommon.isTextEmpty(m.nodeValue);)m=c(m).parent().contents().get(n--);c(m).is("#wsTemp")?k=l=!0:m=c(m).contents().last().get(0)}}!f&&!k?(a.dom.split(g.get(0),c("#wsTemp",a.getDoc()).get(0)),a.selection.select(c("#wsTemp",a.getDoc()).next("p").get(0),!0),a.selection.collapse(!0)):k?(c("#wsTemp",a.getDoc()).closest("p").after("<p><br/></p>"),a.plugins.wscommon.isNodeEmpty(c("#wsTemp",a.getDoc()).closest("p"))&&0==c("#wsTemp",a.getDoc()).closest("p").children().not("#wsTemp").length&&c("#wsTemp",
a.getDoc()).after("<br/>"),a.selection.select(c("#wsTemp",a.getDoc()).closest("p").next("p").get(0),!0),a.selection.collapse(!0)):f&&(c("#wsTemp",a.getDoc()).closest("p").before("<p><br/></p>"),a.selection.select(c("#wsTemp",a.getDoc()).closest("p").get(0),!0),a.selection.collapse(!0));c("#wsTemp",a.getDoc()).remove();a.undoManager.end();return!1}}})},processContent:function(a){a=c("<div>",this.editor.getDoc()).html(a);this.convertDisplayBlockToDiv(a);this.convertBrToP(a);return a.html()},convertDisplayBlockToDiv:function(a){var b=
this.editor;c("span",a).each(function(a,e){var g=c(e),f=g.css("text-align"),k=g.attr("style");if("block"==g.css("display")||k&&k.match(/text-align/i)&&("left"==f||"right"==f||"center"==f||"justify"==f))g.css("display",""),f=c("<div>",b.getDoc()).html(g.html()),g.attr("style")&&f.attr("style",g.attr("style")),g.replaceWith(f)})},convertBrToP:function(a){var b=this;this.splitOnBr(a);this.convertBrToPElements(a);var d=c.browser.msie?"<BR>":"<br>\n";c(a).find("th,td").each(function(a,g){g.innerHTML==
d?g.innerHTML="&nbsp;":b.convertBrToPElements(c(g))})},splitOnBr:function(a){var b=this.editor;c(a).find("br").each(function(a,e){for(;!c(e).parent().is("td,th,li,pre,code,div,body");)b.dom.split(e.parentNode,e)})},convertBrToPElements:function(a){var b=this.editor,d=null;c(a).contents().each(function(a,g){if(1==g.nodeType&&"br"==g.nodeName.toLowerCase())d||(d=c("<p>",b.getDoc()).insertBefore(g)),d=null,c(g).remove();else if(3==g.nodeType||1==g.nodeType&&!b.dom.isBlock(g)){if(!d){if(3==g.nodeType&&
b.plugins.wscommon.isTextEmpty(g.nodeValue))return;d=c("<p>",b.getDoc()).insertBefore(g)}d.append(g)}else 1==g.nodeType&&b.dom.isBlock(g)&&(d=null)})}});f.PluginManager.add("wsbrtop",wikispaces.plugins.BrToP)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.popups.ExpiredDraft",{editor:null,init:function(a){var b=this;b.editor=a;a.plugins.wspopup.register({wsname:"expiredDraft",title:"Expired Draft Recovered",width:600,height:350,uiSetup:function(a){b.uiSetup(a)}})},uiSetup:function(a){c("#expireDraft").click(function(b){ws.common.track("Editor","Autosave","Forced Discard");a.close();c.ajax({url:ws.common.pathFor("page","discardautosave",wikispaces_page),type:"GET",cache:!1,global:!1});b.preventDefault();return!1})}});
f.PluginManager.add("wsexpireddraftpopup",wikispaces.popups.ExpiredDraft)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.util.TimeTracker",{TimeTracker:function(a){this.bucket_=a?a.sort(this.sortNumber):this.DEFAULT_BUCKET},startTime_:null,stopTime_:null,bucket_:null,DEFAULT_BUCKET:[100,500,1500,2500,5E3],_getTimeDiff:function(){return this.stopTime_-this.startTime_},sortNumber:function(a,b){return a-b},_recordStartTime:function(a){this.startTime_=void 0!=a?a:(new Date).getTime()},_recordEndTime:function(a){this.stopTime_=void 0!=a?a:(new Date).getTime()},_track:function(a,b,c){for(var a=
void 0!=b&&0!=b.length?a._createEventTracker(b):a._createEventTracker("TimeTracker"),e,b=0;b<this.bucket_.length;b++)if(this._getTimeDiff()<this.bucket_[b]){e=0==b?"0-"+this.bucket_[0]:this.bucket_[b-1]+"-"+(this.bucket_[b]-1);break}e||(e=this.bucket_[b-1]+"+");try{a._trackEvent(e,c,this._getTimeDiff())}catch(g){}},_setHistogramBuckets:function(a){this.bucket_=a.sort(this.sortNumber)}});f.create("wikispaces.plugins.SavePlugin",{timeTracker:null,init:function(a){this.editor=a;this.noDirtyCheck=!1;
this.timeTracker=new wikispaces.util.TimeTracker;this.timeTracker._setHistogramBuckets([6E4,12E4,3E5,6E5,12E5,18E5,36E5]);this.timeTracker._recordStartTime();var b=this;a.addCommand("wsSave",function(){b.save()});a.addCommand("wsSaveAndContinue",function(){b.saveAndContinue()});a.onSaveContent.add(function(){b.editor.plugins.wsautosave.autosave(!1)});a.onInit.add(function(){window.onbeforeunload=function(){if(!b.noDirtyCheck&&b.isContentDirty())return f.mainEditor.plugins.wsautosave.autosave(!1),
"You have not saved your changes."}})},createControl:function(a,b){var d=this;if("wssave"==a){var e=b.createSplitButton("wssave",{title:"Save",label:"Save","class":"btn",onclick:function(){d.editor.wsExecCommand("wsSave")}}),g,h,k,l;e.onRenderMenu.add(function(a,b){l=b.add({title:"Preview",icon:"menuPreview",onclick:function(){d.editor.wsExecCommand("preview",!1,!1,{skip_undo:!0});ws.common.track("Editor","Preview")}});g=b.add({title:"Save with Comment",icon:"saveWithComment",onclick:function(){f.mainEditor.plugins.wspopup.show("saveWithComment");
c("#saveWithCommentComment").focus()}});g.setDisabled(!0);k=b.add({title:"Save and Continue",icon:"saveContinue",onclick:function(){a.setDisabled(!0);d.editor.wsExecCommand("wsSaveAndContinue")}});k.setDisabled(!0);h=b.add({id:"switchEditorModes",title:"visual"==d.editor.plugins.wscommon.getOption("mode")?"Wikitext Editor":"Visual Editor",icon:"saveTextEditor",onclick:function(){d.editor.execCommand("wstext")}})});e.originalShow=e.showMenu;e.showMenu=function(){var a=c(window).scrollTop();e.originalShow();
c(window).scrollTop(a);c("#menu_wsMainEditor_wsMainEditor_wssave_menu").css({borderBottom:"1px solid #d4d0c9",borderRight:"1px solid #d4d0c9"}).appendTo(document.body);d.editor.plugins.wstoolbarscroll.moveScroller();ws.editor.content.isLoaded&&(g.setDisabled(!1),k.setDisabled(!1));d.editor.plugins.wscommon.reloadFailed&&h.setDisabled(!0);l.setDisabled(0<c("#previewBox").length);d.editor.plugins.wscommon.resizeToolbar()}}else"wscancel"==a&&(e=b.createButton("wscancel",{title:"Cancel",label:"Cancel",
"class":"btn",onclick:function(){ws.common.track("Editor","Stop","Cancel");d.timeTracker._recordEndTime();try{_gaq.push(function(){d.timeTracker._track(_gat._getTrackerByName(),void 0,"Editor")})}catch(a){}d.isContentDirty()&&d.editor.plugins.wsautosave.autosave(!1);d.noDirtyCheck=!0;document.location=d.editor.getParam("wssave_cancel_url")}}));return e},getInfo:function(){return{longname:"Wikispaces save",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},
save:function(){this.editor.plugins.wsautosave.autosave(!1);var a;if("failed"==this.editor.plugins.wsautosave.mergeStatus)if(confirm("Someone else has saved changes to this page since you started editing. You are about to overwrite some of their changes.\n\nClick OK to save. Your edits will overwrite the other person's changes.\n\nClick Cancel to return to editing. We will show you the other person's saved changes. Where there are conflicts, you can copy their changes into your edit by hand."))ws.common.track("Editor",
"Concurrent Editing","Merge Failed - Overwrite"),a=this.editor.plugins.wscommon.fullContent(!0,"bookmarks,empty");else return ws.common.track("Editor","Concurrent Editing","Merge Failed - Cancel"),this.editor.plugins.wsautosave.showConcurrentEditorPopup(),!1;else a="success"==this.editor.plugins.wsautosave.mergeStatus?this.editor.plugins.wsautosave.mergeResult:this.editor.plugins.wscommon.fullContent(!0,"bookmarks,empty");ws.common.track("Editor","Stop","Save");this.timeTracker._recordEndTime();try{_gaq.push(function(){this.timeTracker&&
this.timeTracker._track(_gat._getTrackerByName(),void 0,"Editor")})}catch(b){}var d=c(this.editor.getElement()).closest("form");this.noDirtyCheck=!0;this.addComments(d.get(0));d.find("#wsMainEditor").val(a);d.submit()},saveAndContinue:function(){this.editor.plugins.wsautosave.autosave(!1);if("failed"==this.editor.plugins.wsautosave.mergeStatus)if(confirm("Someone else has saved changes to this page since you started editing. You are about to overwrite some of their changes.\n\nClick OK to save. Your edits will overwrite the other person's changes.\n\nClick Cancel to return to editing. We will show you the other person's saved changes. Where there are conflicts, you can copy their changes into your edit by hand."))ws.common.track("Editor",
"Concurrent Editing","Merge Failed - Overwrite");else return ws.common.track("Editor","Concurrent Editing","Merge Failed - Cancel"),this.editor.plugins.wsautosave.showConcurrentEditorPopup(),!1;var a=this.editor.plugins.wscommon.fullContent(!0,"bookmarks,empty"),b=c(this.editor.getElement()).closest("form");this.noDirtyCheck=!0;this.addComments(b.get(0));b.find("#wsMainEditor").val(a);b.attr("target","target_editor");this.editor.plugins.wscommon.setOption("saveAndContinue",1);b.submit();this.editor.plugins.wscomment.markCommentsSaved()},
isContentDirty:function(){if("visual"==this.editor.plugins.wscommon.getOption("mode")){for(var a=0;a<f.editors.length;a++)if(f.editors[a].isDirty())return!0;return!1}return f.mainEditor.plugins.wstext.isDirty()},addComments:function(){this.editor.plugins.wscommon.setOption("pageComments",JSON.stringify(this.editor.plugins.wscomment.newComments()))}});f.PluginManager.add("wssave",wikispaces.plugins.SavePlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.CommentSpacePlugin",{popup:null,MINIMUM_REDISCOVER_MILLISECONDS:600,init:function(a){this.editor=a;var b=this;this.commentSpace=null;this.commentsDisabled=!!a.plugins.wscommon.getOption("commentsDisabled");a.onInit.add(function(){c(".mceIframeContainer iframe").css("background-color","transparent").attr("allowTransparency",!0);b.commentSpace=new WikispacesCommentSpace(a.getBody(),a.getContainer(),a.getContainer(),c(a.getContainer()).find(".mceIframeContainer"),
a);WikispacesCommentManager.drawAll();a.theme.controlManager().setDisabled("wscomment",b.commentsDisabled)});a.onSetContent.add(function(){var b=c("a.range[name^=comment-]:last",a.getBody());0<b.size()&&0==b.next().size()&&(b.parent().is("body")||0==b.parent().next().size())&&c(a.getBody()).append("<p><br/></p>")});a.onRemove.add(function(){b.comments&&(b.commentSpace.remove(),b.commentSpace=null)});a.addCommand("wsComment",function(){function b(a){return a?(1==a.nodeType?c(a).text():a.nodeValue||
"")+b(a.nextSibling):""}if(!a.wsselection||!a.wsselection.withinCode())if(a.selection.isCollapsed()||!wikispaces_can_discuss)WikispacesCommentManager.expand();else{var d=new WikispacesComment;a.wsselection.normalizeOutsideLinks();var e=a.selection.getRng(!0).cloneRange(),l=a.selection.getRng(!0).cloneRange();e.collapse(!0);l.collapse(!1);var m=a.getDoc().createTextNode("\u00a0");l.insertNode(m);c.trim(b(m.nextSibling))&&m.parentNode.removeChild(m);m=d.generateCloser(a.getDoc());l.insertNode(m);l=
d.generateOpener(a.getDoc());e.insertNode(l);f.isIE&&(m=c(m),!m.parent().is("p")&&m.prev().is("p")&&m.appendTo(m.prev()),8>=c.browser.version&&(a.dom.setOuterHTML(l,a.dom.createHTML("a",{name:d.openAnchorName(),"class":"range"},"")),a.dom.setOuterHTML(m,a.dom.createHTML("a",{name:d.closeAnchorName(),"class":"range"},""))));WikispacesCommentManager.addComment(d);d.compose();c.scrollTo(d.div,{offset:-70});a.selection.collapse()}});var d=0,e=function(a){var c=(new Date).getTime();c-d<b.MINIMUM_REDISCOVER_MILLISECONDS?
setTimeout(function(){d<c&&(d=(new Date).getTime(),WikispacesCommentManager.redrawAll(a))},b.MINIMUM_REDISCOVER_MILLISECONDS):(d=c,WikispacesCommentManager.redrawAll(a))};a.onChange.add(function(){setTimeout(e,0)});a.onUndo.add(function(){e(!0)});a.onRedo.add(function(){e(!0)});a.onKeyUp.add(e)},getInfo:function(){return{longname:"Wikispaces comment space",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},loadComments:function(a){WikispacesCommentManager.load(a)}});
f.PluginManager.add("wscommentspace",wikispaces.plugins.CommentSpacePlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.ListPlugin",{init:function(a){function b(b){var d=null;0<c(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").size()&&(d=c(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").get(0).nodeName);c(a.selection.getNode()).closest("ul,ol");a.execCommand(b);f.isWebKit&&d&&(b=a.selection.getBookmark(),c(a.selection.getNode()).closest("li").wrapInner("<"+d+">"),a.selection.moveToBookmark(b));e.mergeLists(a.selection.getNode())}var d=this,e=this;this.editor=a;this.selectedItem=
null;a.addCommand("wsInsertOrderedList",function(){b("InsertOrderedList")});a.addCommand("wsInsertUnorderedList",function(){b("InsertUnorderedList")});a.onNodeChange.add(function(a,b,e){d.selectedItem=c(e).closest("li").get(0);b=a.wsselection&&0<a.wsselection.selectedElements("table").length;a.theme.controlManager().setDisabled("insertorderedlist",b);a.theme.controlManager().setDisabled("insertunorderedlist",b);a.theme.controlManager().setDisabled("hr",null!=d.selectedItem)});a.onKeyDown.addToTop(function(a,
b){if(d.selectedItem&&!b.ctrlKey&&!b.altKey){if("9"==b.keyCode){try{a.wsExecCommand("useCSS",!1,!0)}catch(e){}a.undoManager.add();a.undoManager.begin();c(".wsTmpLiWorkingClass",a.getDoc()).removeClass("wsTmpLiWorkingClass");var g=c(a.selection.getNode()).closest("li").addClass("wsTmpLiWorkingClass").children("ol,ul")[0];if(g){for(var n=a.selection.getBookmark();g;)a.dom.split(g.parentNode,g),g=c(".wsTmpLiWorkingClass",a.getDoc()).eq(0).removeClass("wsTmpLiWorkingClass").end().eq(1).children("ol,ul")[0];
a.selection.moveToBookmark(n)}c(".wsTmpLiWorkingClass",a.getDoc()).removeClass("wsTmpLiWorkingClass");if(b.shiftKey)if(f.isGecko){var n=a.selection.getBookmark(),g=c(a.selection.getNode()).closest("li"),o=g.parent("ol,ul");o.length&&(g=1<o.children().length?c(a.dom.split(o[0],g[0])):o.children().replaceAll(o));g.parent().is("ol,ul")||g.replaceWith(c("<p>",a.getDoc()).append(g.contents()));a.selection.moveToBookmark(n)}else a.wsExecCommand("outdent",!1,"");else{a.wsExecCommand("indent",!1,"");if(f.isWebKit){n=
a.selection.getBookmark();c(a.selection.getStart()).closest("li").addClass("wsholdstart");c(a.selection.getEnd()).closest("li").addClass("wsholdend");var p=!1,q=!1;c(a.selection.getStart()).parents("ul,ol").last().find("li").each(function(a,b){p||(c(b).is(".wsholdstart")&&(c(b).removeClass("wsholdstart"),q=!0),c(b).is(".wsholdend")&&(c(b).removeClass("wsholdend"),p=!0),q&&c(b).children("br:first-child").remove())});a.selection.moveToBookmark(n)}f.isGecko&&(g=c(a.selection.getNode()).parent().closest("blockquote"),
o=g.children(),1==o.length&&o.eq(0).is("ol,ul")&&(n=a.selection.getBookmark(),o=o[0].nodeName.toLowerCase(),g.wrapInner("<"+o+">").children().eq(0).unwrap(),a.selection.moveToBookmark(n)))}a.undoManager.end();b.preventDefault();b.stopPropagation();return!1}f.isGecko&&a.onSetContent.add(function(){c("li",a.getBody()).each(function(a,b){0==b.childNodes.length&&c(b).html("<br/>")})})}});var g=!1;a.onKeyDown.addToTop(function(a,b){if(d.selectedItem&&!b.ctrlKey&&!b.altKey){if("13"==b.keyCode&&!b.shiftKey&&
f.isIE){var e=c(a.selection.getNode()).closest("li");if(e.length&&""==e.text()&&!e.find("img").length){a.selection.setContent('<span id="_ws_new_cursor">\ufeff</span>');e.parent().find("li").each(function(a,b){""==c(b).text()&&!c(b).find("img").length&&c(b).html('<span class="wsTemp">\ufeff</span>')});e=c(a.dom.split(e.parent()[0],e[0]));e.parent().find("span.wsTemp").remove();e.parent().is("ol,ul")||(e.find("br:last-child").length||e.append("<br>"),e.wrapInner("<p>").replaceWith(e.contents()));var m=
c("#_ws_new_cursor",a.getDoc());m.after(a.getDoc().createTextNode(""));a.selection.select(m[0].nextSibling,!0);a.selection.collapse(!1);m.remove();f.dom.Event.cancel(b);return}e=c(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6,p,div").closest("li");if(e.length){a.selection.setContent('<span id="_ws_splitonme">\ufeff</span><span id="_ws_new_cursor">\ufeff</span>');e=c("#_ws_splitonme",a.getDoc());c(a.dom.split(e.closest("li")[0],e[0])).remove();e=c("#_ws_new_cursor",a.getDoc()).closest("h1,h2,h3,h4,h5,h6,p,div");
e.replaceWith(e.contents());m=c("#_ws_new_cursor",a.getDoc());e=m.closest("li");m.remove();e.prepend(a.getDoc().createTextNode(""));a.selection.select(e[0].firstChild,!0);a.selection.collapse(!1);f.dom.Event.cancel(b);return}}if("13"==b.keyCode)if(e=function(){var d=c(a.selection.getNode()).closest("li").find("ul,ol").first();d.length||(d=c(a.selection.getNode()).next("ul,ol"));var e=c("<li>&nbsp;</li>").insertBefore(d);d.appendTo(e);d=c("<span>",a.getDoc()).prependTo(e);a.plugins.wscommon.cursorToAndRemoveElement(d);
f.dom.Event.cancel(b)},f.isGecko&&!b.shiftKey&&a.wsselection.isInFrontOf("ul,ol"))e();else if((f.isGecko||f.isWebKit)&&""==c(a.selection.getNode()).text()&&!c(a.selection.getNode()).find("img").length&&2<=c(a.selection.getNode()).parents("ol,ul").length){var e=c(a.selection.getNode()).closest("li"),n;e.parent("ul,ol").prev("li").get(0)?(n=c("<span>",a.getDoc()).prependTo(c("<li><br/>").insertAfter(e.parent())),f.isGecko&&setTimeout(function(){c("ul > br:only-child",a.getDoc()).parent().remove()},
100)):n=c("<span>",a.getDoc()).prependTo(c("<li><br/>").insertAfter(e.parents("li").first()));setTimeout(function(){a.plugins.wscommon.cursorToAndRemoveElement(n)},100);e.remove();f.dom.Event.cancel(b)}else f.isWebKit&&(b.shiftKey&&a.wsselection.isInFrontOf("ul,ol")?c(a.selection.getNode()).closest("li").find("ul,ol").first().before("<br/>"):!b.shiftKey&&0<c(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").size()&&(a.wsselection.isAtTheEndOf("li")?(n=c("<span>",a.getDoc()).prependTo(c("<li><br/>").insertAfter(c(a.selection.getNode()).parent("li"))),
a.plugins.wscommon.cursorToAndRemoveElement(n),f.dom.Event.cancel(b)):a.wsselection.isInFrontOf("ul,ol")?reinsertNestedList():g=!0))}});a.onKeyUp.add(function(a,b){if(!b.shiftKey&&!b.ctrlKey&&!b.altKey&&f.isWebKit){if(d.selectedItem&&"8"==b.keyCode){var e=c(a.selection.getNode()).closest("li"),m=e.next("li").children();m.eq(0).is("ul,ol")&&(m=m.eq(0),m.remove(),e.append(m),0==e.next("li").children().length&&e.next("li").remove())}g&&(e=c(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").wrap("<li>"),
a.plugins.wscommon.cursorToAndRemoveElement(c("<span>",a.getDoc()).prependTo(e)),g=!1)}})},mergeLists:function(a){for(var b=this.editor,a=c(a).parents("ul,ol").last();a.prev().is("ul,ol");)a=a.prev();for(;a.is("ul,ol");)a.find("ol,ul").each(function(a,e){var g=c(e);g.closest("body")[0]==b.getBody()&&g.prev().length&&g.prev()[0].nodeName==g[0].nodeName&&b.plugins.wscommon.areNodesAdjacent(g.prev()[0],g[0])&&(g.prepend(g.prev().html()),g.prev().remove())}),a=a.next(),a[0]&&a[0].nodeName==a.prev()[0].nodeName&&
(a.prepend(a.prev().html()),a.prev().remove())},getInfo:function(){return{longname:"Wikispaces list",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}}});f.PluginManager.add("wslist",wikispaces.plugins.ListPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.ToolbarScrollPlugin",{init:function(a){var b=this;a.onInit.add(function(){c(".mceExternalToolbar").before('<div id="mceToolbarAnchor">');c(window).scroll(b.moveScroller);b.moveScroller()})},moveScroller:function(){var a=c(".mceExternalToolbar"),b=a.height();c(window).scrollTop()>c("#mceToolbarAnchor").offset().top-b?a.css({position:"fixed",top:"0px"}):a.css({position:"absolute",top:"-"+(b+4)+"px"});c("#menu_wsMainEditor_wsMainEditor_wssave_menu").is(":visible")&&
(a=c("#wsMainEditor_wssave_action"),c("#menu_wsMainEditor_wsMainEditor_wssave_menu").css({left:Math.min(a.offset().left,c(window).scrollLeft()+c(window).width()-c("#menu_wsMainEditor_wsMainEditor_wssave_menu").width()-3)+"px",top:a.offset().top+a.outerHeight()+"px"}));c("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu").is(":visible")&&(a=c("#wsMainEditor_formatlistbox"),c("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu").css({left:a.offset().left+"px",top:a.offset().top+a.outerHeight()+"px"}))},
getInfo:function(){return{longname:"Wikispaces toolbar scroll",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}}});f.PluginManager.add("wstoolbarscroll",wikispaces.plugins.ToolbarScrollPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.LinkPlugin",{init:function(a){var b=this;this.editor=a;a.addCommand("wslink",function(){f.mainEditor.plugins.wspopup.show("linkTool",{plugin:b})});a.addButton("wslink",{title:"Insert Link",label:"Link",onclick:function(){f.activeEditor.wsExecCommand("wslink");ws.common.track("Editor","Open Link Tool")}});a.onNodeChange.add(function(a,b,c,h,k){a.theme.controlManager().setActive("wslink","A"==c.nodeName&&!c.name||"IMG"==c.nodeName&&"A"==c.parentNode.nodeName);
k.initial||("A"==c.nodeName&&!c.name&&-1==c.href.indexOf("#mce_temp_url#")&&"visual"==a.plugins.wscommon.getOption("mode")?f.mainEditor.plugins.wslinkoverlay.show(c):f.mainEditor.plugins.wslinkoverlay.hide())});a.onDblClick.add(function(a,b){"A"==b.target.nodeName&&("A"==b.target.nodeName&&a.selection.select(b.target),a.execCommand("wslink"))});a.plugins.wscommon.disableUntilLibsLoad(a,"wslink")},getInfo:function(){return{longname:"Wikispaces link",author:"Tangient LLC",authorurl:"http://wikispaces.com",
infourl:"http://wikispaces.com",version:"0.1"}},setupForms:function(){var a=f.activeEditor;a.wsselection.restore(!0);this.linkEnclosingSelectedImage()?a.plugins.wslinkpopup.prefill(this.parseLink(c(this.linkEnclosingSelectedImage()))):this.selectedLink()?a.plugins.wslinkpopup.prefill(this.parseLink(c(this.selectedLink()))):this.selectedImage()||this.isBlockElementSelected()?a.plugins.wslinkpopup.prefill({linkText:null}):a.plugins.wslinkpopup.prefill({linkText:this.selectedText()})},insertLinkFromComponents:function(a){var b=
this.editor,d=this.componentsToLink(a),e=this.selectedText()==a.linkText,g;if(this.linkEnclosingSelectedImage())this.linkEnclosingSelectedImage().setAttribute("href",d.attr("href")),a.targetNew?this.linkEnclosingSelectedImage().setAttribute("target","_blank"):this.linkEnclosingSelectedImage().removeAttribute("target");else if(g=this.selectedImage())g.parentNode.appendChild(d.get(0)),this.selectedImage().parentNode.replaceChild(d.get(0),g),d.get(0).appendChild(g),f.mainEditor.plugins.wsimageoverlay.refreshLinkStatus(),
b.wsselection.updateBookmarkToNode(g);else if(this.selectedLink())b.dom.replace(d.get(0),this.selectedLink()),b.wsselection.updateBookmarkToNode(d.get(0));else if(this.selectedText()&&!e){b.wsselection.restore();b.getDoc().execCommand("unlink",!1,null);c.browser.msie&&(g=b.selection.getRng(!0).cloneRange(),"A"==g.endContainer.parentNode.nodeName&&0==g.endOffset&&(span=c('<span class="ie-is-the-best">&nbsp</span>').insertBefore(g.endContainer.parentNode),g.setEndBefore(span.get(0)),b.selection.setRng(g)));
b.execCommand("CreateLink",!1,"#mce_temp_url#");c.browser.msie&&c(".ie-is-the-best",b.getDoc()).remove();g=b.dom.select("a[href='#mce_temp_url#']");for(i=0;i<g.length;i++)if(b.dom.setAttrib(g[i],"href",d.attr("href")),b.dom.removeClass(g[i],"wiki_link"),b.dom.removeClass(g[i],"wiki_link_ext"),b.dom.addClass(g[i],d.attr("class")),a.targetNew&&b.dom.setAttrib(g[i],"target","_blank"),f.mainEditor.plugins.wslinkoverlay.show(g[i]),e&&0==i){b.dom.setHTML(g[i],c("<div>").text(a.linkText).html());break}c("a > a",
f.activeEditor.getDoc()).each(function(){c(this).parent().replaceWith(this)})}else b.wsselection.setContent(this.editor.dom.getOuterHTML(d.get(0)));ws.common.track("Editor","Add Link",d.attr("href"));return!0},removeLink:function(){var a=f.activeEditor;if(a.selection.isCollapsed()){a.wsselection.restore(!0);var b=a.dom.getParent(a.selection.getNode(),"A");b&&a.dom.replace(c("<span>",a.getDoc()).get(0),b,!0)}else{a.wsselection.restore();if(f.isIE&&!a.selection.isCollapsed()){a.selection.setContent('<span id="startMarker">\ufeff</span>'+
a.selection.getContent()+'<span id="endMarker">\ufeff</span>');var b=c("#startMarker",a.getDoc()),d=c("#endMarker",a.getDoc());a.dom.split(b.closest("a").get(0),b.get(0));a.dom.split(d.closest("a").get(0),d.get(0));var e=b.next("a");a.selection.select(e.get(0),!0);b.remove();d.remove()}a.getDoc().execCommand("unlink",!1,null);a.wsselection.tightenSelection();b=c(a.selection.getRng(!0).startContainer).closest("span.wiki_link,span.wiki_link_new");b.before(b.html()).remove();a.nodeChanged()}},componentsToLink:function(a){var b,
d=null;a.pageName?(d=b=null,"doc"==a.objectClass?(b="doc",d="view"):"file"==a.objectClass&&(b="file",d="view"),b=ws.common.parseLink(a.pageName,b,d),b=a.wikiName==wikispaces_wikiName?b:"http://"+a.wikiName+"."+wikispaces_domain+b,a.anchor&&(b+="#"+a.anchor),d="wiki_link"):(b=a.mailTo?"mailto:"+a.mailTo:a.url,d="wiki_link_ext");b=encodeURI(b).replace(/%25/g,"%");b=c("<a></a>",this.editor.getDoc()).attr("href",b).addClass(d);a.linkText&&b.text(a.linkText);a.targetNew&&b.attr("target","_blank");return b},
parseLink:function(a){var b=a.attr("href"),c="",e="",g="",f="",k="",l="page",b=b.replace(/^(\.\.\/)+/,"/"),m="(?:/"+ws.common.PROJECT_INDICATOR+"/(.*?/.*?))?/(?:(page|file|doc)/view/)?([^#/]+)?(?:#(.+))?$",n=RegExp("^(?:https?://)?([a-z0-9-]+)."+ws.common.escapeRegExp(wikispaces_domain)+m,"i"),o=RegExp("^(?:https?://)?"+ws.common.escapeRegExp(location.hostname)+m,"i"),m=RegExp("^"+m,"i"),p=null;(p=n.exec(b))?(c=p[1],e=p[4],!e&&!p[5]&&(e="home"),p[2]&&(e=p[2]+"/"+e),p[3]&&(l=p[3]),g=p[5]):(p=o.exec(b))||
(p=m.exec(b))?(c=wikispaces_wikiName,e=p[3],!e&&!p[4]&&(e="home"),p[1]&&(e=p[1]+"/"+e),p[2]&&(l=p[2]),g=p[4]):(p=b.match(/^mailto:(.+)/i))?k=p[1]:f=b;l=l.replace(/\/view\//,"");e&&(e=e.replace(/\+/g," "),e=decodeURIComponent(e));g&&(g=g.replace(/\+/g," "),g=decodeURIComponent(g));b=a.text().replace(/\uFEFF/g,"");a.find("img").length&&(b=null);a=a.attr("target")&&a.attr("target").match(/^_(blank|new)/);return{linkText:b,objectClass:l,pageName:e,wikiName:c,anchor:g,extLink:f,mailTo:k,targetNew:!!a}},
selectedLink:function(){return this.editor.wsselection.selectedLink()},selectedImage:function(){this.editor.wsselection.restore(!0);return c(this.editor.selection.getNode()).closest("img").get(0)},linkEnclosingSelectedImage:function(){return c(this.selectedImage()).parent("a").get(0)},isBlockElementSelected:function(){return this.editor.selection.getContent().match(/(<\/?table>)|(<\/?tr>)|(<\/?td>)|(<\/?ul>)|(<\/?ol>)|(<\/?li>)/i)},selectedText:function(){this.editor.wsselection.restore(!0);return this.editor.selection.getContent({format:"text"}).replace(/\uFEFF/g,
"")}});f.PluginManager.add("wslink",wikispaces.plugins.LinkPlugin)})(tinymce,jQuery);
(function(f,c){var a=["WikiAnchor","WikiReference","WikiMediaRss","WikiMediaToc","WikiMediaCustom"];f.create("wikispaces.plugins.ObjectResizePlugin",{init:function(a){this.editor=a;var c=this;a.onInit.add(function(){f.isGecko&&(a.onMouseDown.add(function(a,b){c.enableObjectResizing(c.isResizable(b.target))}),a.onKeyDown.add(function(a,b){33<=b.keyCode&&40>=b.keyCode&&c.enableObjectResizing(!1)}));f.isIE&&a.dom.bind(a.getDoc(),"controlselect",function(a){return c.isResizable(a.srcElement)})})},getInfo:function(){return{longname:"Wikispaces object resize",
author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},isResizable:function(b){b=c(b);return b.is("img,pre")&&!this.hasAnyClass(b,a)},enableObjectResizing:function(a){if(this.resizingEnabled!==a){this.resizingEnabled=a;try{this.editor.execCommand("enableObjectResizing",!1,a,{skip_undo:!0})}catch(c){}this.editor.execCommand("mceRepaint",!1)}},hasAnyClass:function(a,d){for(var e=0;e<d.length;e++)if(c(a).hasClass(d[e]))return!0;return!1}});f.PluginManager.add("wsobjectresize",
wikispaces.plugins.ObjectResizePlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.popups.Widget",{previousSection:"wikispaces",currentMenu:"wikispaces",currentSection:"wikispaces",editor:null,plugin:null,COMMAND_URL_PARAM:"wikispacesCommandUrl",customPlugins:[],init:function(a){var b=this;b.editor=a;a.plugins.wspopup.register({wsname:"mediaTool",title:"Widgets",width:680,height:420,wsselection:0,onShow:function(a){b.onShow(a)},uiSetup:function(a){b.uiSetup(a)}});a.plugins.wspopup.register({wsname:"mediaPreview",title:"Widget Preview",width:340,
height:340,uiSetup:function(a){c("#closePreviewButton").click(function(){a.close()})}});this.registerPlugin({options:{id:"glogster",name:"Glogster",type:"media",category:"poster",logo:"/i/glogster_widget_160x70.jpg",url:"http://edu.glogster.com/?page=wiki_spaces&wikiaction=login",homepage_url:"http://edu.glogster.com",terms_url:"http://edu.glogster.com/terms-of-use"}})},setPlugin:function(a){this.plugin=a},onShow:function(a){this.setPlugin(a.plugin);this.resetMediaForms();a.plugin&&(a.plugin.editor.plugins.wsreference?
c("#referenceMediaMenuEntry").show():c("#referenceMediaMenuEntry").hide(),wikispaces_isMain&&"www"==wikispaces_spaceName&&c("#includeTagCloudMediaMenuEntry, #includeEditorsMediaMenuEntry, #includeNavbarMediaMenuEntry, #includePageListMediaMenuEntry, #includeWikiListMediaMenuEntry").hide());c("#mediaDiv form").attr("action",ws.common.pathFor("page","embedmedia",wikispaces_page)+"?mode="+encodeURIComponent(this.editor.plugins.wscommon.getOption("mode"))+"&editorVersion=3");var b;a.mediaString&&(b=a.mediaString.match(/^#(.+)/))?
(c("#anchorName").val(b[1]),c("#anchorMediaMenuEntry").click()):a.mediaString?this.loadMedia(a.mediaString):this.setMediaMenu("wikispaces")},loadMedia:function(a){document.genericMediaForm.media.value=a;document.genericMediaForm.submit()},addWidget:function(a,b){this.plugin.insertWidget(a,b);c("#mediaDiv .cancelMediaLink").eq(0).click()},setMediaError:function(a){c("#mediaError").show().text(a)},resetMediaForms:function(){c("#mediaDiv .mediaForm").each(function(){this.reset()});c("#mediaDiv .autocompletePage").not("#includePageMediaMenu input").val(wikispaces_page);
wikispaces_isMain&&"www"==wikispaces_spaceName&&c("#mediaDiv .autocompletePage").not("#includePageMediaMenu input").attr("readonly","readonly");c("#mediaDiv .linkWiki").val(wikispaces_wikiName);c("#mediaError").hide().html("")},setMediaPreview:function(a){this.editor.plugins.wspopup.show("mediaPreview");c("#mediaPreviewArea").html(a)},startMediaSpinner:function(){this.previousSection=this.currentSection;this.setMediaMenu("spinner");c("#mediaError").hide().html("")},stopMediaSpinner:function(){this.setMediaMenu(this.previousSection)},
setMediaMenu:function(a){ws.common.log("setMediaMenu",a);var b=!1;1==c("#"+a+"MediaMenuEntry").parents("#mediaMenu").length&&(c("#"+this.currentMenu+"MediaMenuEntry").removeClass("selected"),c("#"+a+"MediaMenuEntry").addClass("selected"),this.currentMenu=a,b=!0);"showcustom"==a&&(a="custom");document.getElementById(a+"MediaMenu")||(a="wikispaces");ws.autocomplete.getAutocompleters(c("#"+a+"MediaMenu")).each(function(){var a=this.autocompleter;setTimeout(function(){a.findValue()},1)});c("#"+this.currentSection+
"MediaMenu").hide();c("#"+a+"MediaMenu").show();this.currentSection=a;b&&"custom"!=a||"wikispaces"==a||"spinner"==a||"flickr"==a||"gabbly"==a||"yackpack"==a||"bittybrowser"==a||"toc"==a||"reference"==a||"facebooklike"==a||"googleplusone"==a||"digg"==a||"reddit"==a||"anchor"==a||"include"==a.substring(0,7)||c("#"+a+"MediaMenu").is(".hideTextMediaInstructions")?c(document.otherMediaForm).hide():c(document.otherMediaForm).show();"spinner"!=a&&(document.otherMediaForm.mediaType.value=a);c("#"+a+"MediaMenu").find('input[type="text"],textarea').eq(0).focus()},
submitYackpack:function(){var a="http://www.yackpack.com/walkietalkie/?"+encodeURIComponent(document.yackpackMediaForm.channel.value);document.otherMediaForm.embedText.value=a;document.otherMediaForm.save.click()},submitBittyBrowser:function(){document.otherMediaForm.embedText.value='bitty browser\nwebsite: "'+document.bittybrowserMediaForm.url.value+'"';document.otherMediaForm.save.click()},embedGabbly:function(){document.otherMediaForm.embedText.value="<iframe src='http://cw.gabbly.com/gabbly/cw.jsp?e=1&t="+
encodeURIComponent(location.protocol+"//"+location.host+"/"+wikispaces_page)+"' scrolling='no' style='width:300px; height:250px;' frameborder='0'></iframe>";document.otherMediaForm.save.click()},embedFacebookLike:function(){document.otherMediaForm.embedText.value='<iframe src="//www.facebook.com/plugins/like.php?href='+encodeURIComponent(location.protocol+"//"+location.host+"/"+wikispaces_page)+'&amp;send=false&amp;layout=standard&amp;width=450&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font&amp;height=80&amp;appId=XXX" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:450px; height:80px;" allowTransparency="true"></iframe>';
document.otherMediaForm.save.click()},embedGooglePlusOne:function(){document.otherMediaForm.embedText.value='<g:plusone annotation="inline"></g:plusone>';document.otherMediaForm.save.click()},embedDigg:function(){document.otherMediaForm.embedText.value='<a class="DiggThisButton DiggMedium" src="http://digg.com/submit?url='+encodeURIComponent(location.protocol+"//"+location.host+"/"+wikispaces_page)+'"></a>';document.otherMediaForm.save.click()},embedReddit:function(){document.otherMediaForm.embedText.value=
'<script type="text/javascript" src="http://www.reddit.com/static/button/button1.js"><\/script>';document.otherMediaForm.save.click()},uiSetup:function(a){var b=this,d=function(){a.close();return!1};c("#widgetCloseButton").click(d);c("#mediaDiv ul li").live("click",function(){var c=this.id,c=c.substring(0,c.indexOf("MediaMenuEntry"));"spinner"!=b.currentMenu&&(b.setMediaMenu(c),a.resize());return!1});c("#tocMediaForm #tocSubmitButton").click(function(){b.plugin.insertToc();return d()});c("#tocMediaForm #flatSubmitButton").click(function(){b.plugin.insertToc(!0);
return d()});c("#referenceMediaForm").submit(function(a){b.plugin.insertReference();a.preventDefault();a.stopPropagation();return d()});c("#referencesMediaForm").submit(function(a){b.plugin.insertReferences();a.preventDefault();a.stopPropagation();return d()});c("#anchorMediaForm").submit(function(a){var g=c("#anchorName").val();if(g.match(/^[^\]\|]+$/))return b.plugin.insertAnchor(g),a.preventDefault(),a.stopPropagation(),d();g?alert('Anchors may not contain the characters "|" or "]".'):alert("Please enter a name for the anchor.");
a.preventDefault();a.stopPropagation();return!1});c("#mediaDiv .mediaForm").submit(function(){b.startMediaSpinner()});c("#bittybrowserMediaForm").submit(function(){b.submitBittyBrowser()});c("#gabblyMediaForm").submit(function(a){b.embedGabbly();a.preventDefault();a.stopPropagation();return!1});c("#yackpackMediaForm").submit(function(a){b.submitYackpack();a.preventDefault();a.stopPropagation();return!1});c("#codeMediaForm").submit(function(a){c(f.activeEditor.selection.getNode()).closest("pre").length?
(alert("You cannot insert a code block inside another code block"),b.stopMediaSpinner()):(b.plugin.insertCode(document.codeMediaForm.code.value,document.codeMediaForm.format.value),d());a.preventDefault();a.stopPropagation();return!1});c("#facebooklikeMediaForm").submit(function(a){b.embedFacebookLike();a.preventDefault();a.stopPropagation();return!1});c("#googleplusoneMediaForm").submit(function(a){b.embedGooglePlusOne();a.preventDefault();a.stopPropagation();return!1});c("#diggMediaForm").submit(function(a){b.embedDigg();
a.preventDefault();a.stopPropagation();return!1});c("#redditMediaForm").submit(function(a){b.embedReddit();a.preventDefault();a.stopPropagation();return!1});c("#includeCharMediaMenu td").hover(function(){c(this).hasClass("empty")||c(this).addClass("hl")},function(){c(this).hasClass("empty")||c(this).removeClass("hl")});c("#includeCharMediaMenu td").click(function(){c(this).hasClass("empty")||(b.plugin.insertCharacter(c(this).html(),c(this).text()),d())});c("#mediaDiv .cancelMediaLink").click(d);ws.autocomplete.registerAutocompleters(c("#mediaDiv"));
c("#rssDescInput").change(function(){this.checked?(c("#rssDescRow input").prop("disabled",!1),c("#rssDescRow th").removeClass("disabled")):(c("#rssDescRow input").prop("disabled",!0),c("#rssDescRow th").addClass("disabled"))});c.each(this.customPlugins,function(){if("media"==this.options.type){var a=c("<a>").attr("href","#widget-"+this.options.id).text(this.options.name),a=c("<li>").attr("id",this.options.id+"MediaMenuEntry").append(a);c("#"+this.options.category+"MediaMenu ul li:last").before(a);
a=document.location.protocol+"//"+document.location.host+ws.common.pathFor("site","editorplugin",this.options.id);a=ws.common.addUriParams(this.options.url,[[b.COMMAND_URL_PARAM,a]]);a=c("<div>").attr("id",this.options.id+"MediaMenu").addClass("hideTextMediaInstructions").addClass("mediaInstructions").hide().html('<div><iframe class="pluginIframe" frameborder="0" src="'+a+'" id="'+this.options.id+'-pluginIframe" name="'+this.options.id+'-pluginIframe"></iframe><p class="mediaInstructionsTerms">The content above is provided by <a href="'+
this.options.homepage_url+'" target="_blank">'+this.options.homepage_url+'</a> and is governed by their <a href="'+this.options.terms_url+'" target="_blank">terms of service</a>.</p></div>');c("#mediaDiv").find(".mediaInstructions:last").after(a)}})},runCustomPluginCommand:function(a,b,d){switch(a){case "cancel":c("#mediaDiv .cancelMediaLink").click();break;case "preview":this.setMediaPreview(d.content);break;case "submit":document.otherMediaForm.embedText.value=d.content;document.otherMediaForm.mediaType.value=
b;document.otherMediaForm.save.click();break;default:alert("The "+b+" plugin requested an invalid operation.")}},registerPlugin:function(a){this.customPlugins[this.customPlugins.length]=a}});f.PluginManager.add("wswidgetpopup",wikispaces.popups.Widget)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.LinkOverlay",{init:function(a){var b=this;this.editor=a;this.overlay=null;a.onInit.add(function(a){var c=function(a){a.onClick.add(function(a,c){"A"==c.target.nodeName?b.show(c.target):b.hide()})};a.onInitSubEditor.add(c);c(a)});a.onModeSwitch.add(function(a){"plain"==a&&b.hide()});c(window).resize(function(){b.link&&c(b.link).is(":visible")&&b.repositionAndShow()})},getInfo:function(){return{longname:"Wikispaces link overlay",author:"Tangient LLC",authorurl:"http://wikispaces.com",
infourl:"http://wikispaces.com",version:"0.1"}},overlayContent:function(){return ws.editor.content.loadContent("linkProperties")},show:function(a){this.link!=a&&(this.link=a,null==this.overlay&&(this.overlay=c("<div>").addClass("WikiOverlay overlayLayer").css({position:"absolute"}).html(this.overlayContent()).hide().appendTo("#pageEditor"),this.setup()),f.mainEditor.plugins.wstableoverlay.unselectTableCell(),a=this.editor.plugins.wslink.parseLink(c(this.link)),c(".linkOverlayLabel").hide(),c("#linkOverlayVisit").text("Visit").show(),
a.extLink?(c("#linkOverlayLabelUrl").show(),c("#linkOverlayHref").text(ws.common.truncify(a.extLink,60))):a.mailTo?(c("#linkOverlayLabelMailTo").show(),c("#linkOverlayHref").text(ws.common.truncify(a.mailTo,60)),c("#linkOverlayVisit").hide()):(a.wikiName&&a.wikiName!=wikispaces_wikiName&&(c("#linkOverlayLabelWiki").show(),c("#linkOverlayWiki").text(a.wikiName).show()),c("#linkOverlayLabel"+ws.common.ucfirst(a.objectClass)).show(),c("#linkOverlayHref").text(ws.common.truncify(a.pageName,60)),"file"==
a.objectClass&&c("#linkOverlayVisit").text("Show")),this.repositionAndShow())},hide:function(){c(this.link).closest("td,th").length&&f.mainEditor.plugins.wstableoverlay.selectTableCell(c(this.link).closest("td,th").get(0));this.overlay&&this.overlay.hide();this.link=null},repositionAndShow:function(){this.overlay.css({left:"-10000px",top:"-10000px"}).show();this.overlay.css(this.editor.plugins.wscommon.positionBelow(this.overlay,this.link))},setup:function(){var a=this;c("#linkOverlayVisit").click(function(){a.visitLink();
return!1});c("#linkOverlayChange").click(function(){a.changeLink();return!1});c("#linkOverlayRemove").click(function(){a.removeLink();return!1})},visitLink:function(){window.open(c(this.link).attr("href"));this.hide()},changeLink:function(){this.editor.execCommand("wslink");this.hide()},removeLink:function(){this.editor.undoManager.begin();this.editor.selection.select(this.link);this.editor.plugins.wslink.removeLink();this.editor.undoManager.end();this.hide()}});f.PluginManager.add("wslinkoverlay",
wikispaces.plugins.LinkOverlay)})(tinymce,jQuery);
(function(f,c){f.create("static wikispaces.util.Cleanup",{cleanupEmptySpans:function(a){ws.common.log("cleanupEmptySpans",a);for(var b=a.length-1;0<=b;b--){var d=c(a[b]);if(!d.is(".commentBase")&&!d.is(".commentRef")){var e=c.trim(d.text());0<d.parents("body").length&&(0==a[b].childNodes.length||1==a[b].childNodes.length&&3==a[b].childNodes[0].nodeType&&(""==e||8203==e.charCodeAt(0)))&&d.replaceWith(d.text())}}},cleanupEmptyDivs:function(a){ws.common.log("cleanupEmptyDivs",a);for(var b=a.length-1;0<=
b;b--){var d=c(a[b]),e=c.trim(d.text());0<d.parents("body").length&&(0==a[b].childNodes.length||1==a[b].childNodes.length&&3==a[b].childNodes[0].nodeType&&(""==e||8203==e.charCodeAt(0)))&&d.replaceWith("<div> </div>")}},cleanupNoAttributeSpans:function(a){var b=this;ws.common.log("cleanupNoAttributeSpans");c(a).find("span").each(function(){if(!(b.selectedSpans&&this==b.selectedSpans[0])){var a=c(this);!a.attr("style")&&!a.attr("class")&&a.replaceWith(a.contents())}});(c(a).find(":last").is("span,div")||
c(a).find(":last").is("br")&&c(a).find(":last").prev().is("span,div"))&&c(a).append("&nbsp;")},getStyleArray:function(a){if(!a)return{};a=c(a).attr("style");return!a?{}:f.activeEditor.dom.parseStyle(a)},normalizeCssSelector:function(a){a==a.toUpperCase()&&(a=a.toLowerCase());return ws.common.camelize(a)},mergeStyles:function(a,b){var c={},e;for(e in a)"function"!=typeof a[e]&&(c[e]=a[e]);for(e in b)"function"!=typeof b[e]&&(c[e]=this.mergeCss(a[e],e,b[e]));return c},collapseNodes:function(a){ws.common.log("collapseNodes");
for(var b=[],d=a.length-1;0<=d;d--)if(0<c(a[d]).parents("body").length){var e=this.collapseNodeDown(a[d]);b[b.length]=e}return b},flattenNodes:function(a){ws.common.log("flattenNodes",a);for(var b=a.length-1;0<=b;b--)for(var d=[c(a[b])],e;e=d.pop();){var g=e.parent();if(g.is(e.get(0).tagName)){ws.common.log("flattening",e.get(0),e.html());var f=g.contents(),k=f.index(e),f=g.clone().empty().append(f.slice(k+1));c(g).after(f).after(e);var k=this.mergeStyles(this.getStyleArray(g.get(0)),this.getStyleArray(e.get(0))),
l;for(l in k)if("function"!=typeof k[l])try{e.css(l,k[l])}catch(m){}""==c.trim(g.html())&&g.remove();""==c.trim(f.html())?f.remove():d.push(f);d.push(e)}}},collapseNodeDown:function(a){for(;c(a).parent().is(c(a).get(0).tagName)&&c(a).parent().attr("class")==c(a).attr("class")&&1==c(a).parent().children().length;){for(var b=!0,d=0;d<a.parentNode.childNodes.length;d++)if(3==a.parentNode.childNodes[d].nodeType&&""==!c.trim(a.parentNode.childNodes[d].nodeValue)){b=!1;break}if(!b)break;a=a.parentNode}for(var e=
"",g="",f=this.getStyleArray(a),k=a;1==c(k).children().length&&c(k).children().eq(0).is(k.tagName)&&c(k).attr("class")==c(k).children().eq(0).attr("class");){for(var l=!0,b=!0,d=0;d<k.childNodes.length;d++)if(1==k.childNodes[d].nodeType)l=!1;else if(3==k.childNodes[d].nodeType&&""==c.trim(k.childNodes[d].nodeValue))l?e+=k.childNodes[d].nodeValue:g+=k.childNodes[d].nodeValue;else{b=!1;break}if(!b)break;k=c(k).children().get(0);f=this.mergeStyles(f,this.getStyleArray(k))}if(k&&k!=a){c(k).prepend(e);
c(k).append(g);b=c(k).html();c(a).empty();c(a).html(b);for(var m in f)if("function"!=typeof f[m])try{c(a).css(m,f[m])}catch(n){}}return a},mergeNodes:function(a){ws.common.log("mergeNodes",a);if(a&&0!=a.length){for(var b=this.editorDocument,d=a[0].tagName,e=!0;e;)e=!1,c(b.body).find(d+" + br").each(function(){1==this.previousSibling.nodeType&&(e=!0,c(this).prev().append("<br/>"),c(this).remove())});c(b.body).find(d).each(function(){var a=this.nextSibling;a&&3==a.nodeType&&""==c.trim(a.nodeValue)&&
a.nextSibling&&1==a.nextSibling.nodeType&&a.nextSibling.tagName==d.toUpperCase()&&c(a.nextSibling).attr("style")==c(this).attr("style")&&c(a.nextSibling).attr("class")==c(this).attr("class")&&(c(this).append(a.nodeValue),a.parentNode.removeChild(a))});for(var g=a.length-1;0<=g;g--)0<c(a[g]).parents("body").length&&this.mergeNode(a[g]);for(e=!0;e;)e=!1,c(b.body).find(d+" br:last-child").each(function(){this.nextSibling||(e=!0,c(this).parent().after("<br/>"),c(this).remove())});ws.common.log("end mergeNodes",
a)}},mergeNode:function(a){var b=c(a);a.previousSibling&&a.previousSibling.tagName==a.tagName&&b.prev().attr("class")==b.attr("class")&&b.prev().attr("style")==b.attr("style")&&(a=b.prev(),a.html(a.html()+b.html()),b.remove())},mergeCss:function(a,b,c){if(!a||"fontSize"!=b)return c;var b=a.substr(0,a.length-2),e=a.substr(a.length-2,2);"%"==e[1]&&(e="%",b=a.substr(0,a.length-1));var a=c.substr(c.length-2,2),g=c.substr(0,c.length-2);"%"==a[1]&&(a="%",g=c.substr(0,c.length-1));if("em"==a||"ex"==a)a=
"%",g*=100;if("em"==e||"ex"==e)e="%",b*=100;return"%"==a?Math.round(100*b*g)/1E4+e:c},removeBrInTable:function(a){c(a).find("td br:last-child, th br:last-child").remove()},removeSafariSpans:function(a){ws.common.log("removeSafariSpans");c("span.wkzw",a).remove();c("span",a).removeClass("Apple-tab-span Apple-style-span");this.cleanupNoAttributeSpans(a)},removeMsoStyles:function(a){var b=this;c(a).each(function(){var a=b.getStyleArray(this),e=!1,g;for(g in a)"function"==typeof a[g]?delete a[g]:0==g.indexOf("mso")&&
(delete a[g],e=!0);if(e)try{var f=c("<"+c(this)[0].tagName+">",this.ownerDocument).attr("class",c(this).attr("class")).html(c(this).html()).attr("id",c(this).attr("id")).css(a);c(this).replaceWith(f)}catch(k){}})},actionableSpans:function(a){return c(a).find("span")},actionableDivs:function(a){return c(a).find("div")},cleanup:function(a,b,d){var e=this;ws.common.log("cleanup",b);if("none"!=b){var g=[];b&&(g=b.split(","));if(0<g.length){this.editorDocument=a.getDoc();var h=this.editorDocument.body,
a=null;d&&(a=f.mainEditor.plugins.wspopup.show("cleanupPopupContents"));c.each(g,function(a,b){switch(b){case "safari":e.removeSafariSpans(h);break;case "mso":e.removeMsoStyles(e.actionableSpans(h));break;case "collapse":e.collapseNodes(e.actionableSpans(h));break;case "merge":e.mergeNodes(e.actionableSpans(h));break;case "flatten":e.flattenNodes(e.actionableSpans(h));break;case "empty":e.cleanupEmptySpans(e.actionableSpans(h));e.cleanupEmptyDivs(e.actionableDivs(h));break;case "bookmarks":c(h).find("span[_mce_type='bookmark']").remove();
break;case "trailingLinebreaks":c(h).find("p > br:last-child, div > br:last-child").remove();break;case "brTable":e.removeBrInTable(h);break;case "relativeFiles":c(h).find("img").each(function(){c(this).attr("src").match(/^file\/view/)?c(this).attr("src","/"+c(this).attr("src")):c(this).attr("src").match(/^\.\.\/\.\.\/file\/view/)&&c(this).attr("src",c(this).attr("src").slice(5))})}});a&&a.close()}}}});f.PluginManager.add("wscleanup",wikispaces.util.Cleanup)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.CommonPlugin",{init:function(a){var b=this;this.editor=a;a.onLoadContent.add(function(a){b.startingSpanCount=c(a.getDoc()).find("span").length});(c.browser.mozilla||c.browser.webkit)&&a.onBeforeSetContent.add(function(a,b){b.content.match(/<hr ?\/>\s*$/)&&(b.content+="<br/>")});if(a.plugins.paste){a.plugins.paste.onPreProcess.add(function(a,b){b.content=b.content.replace(/<\/?pre>/ig,"")});var d="font-family,font-size,background-color,text-align,vertical-align,text-decoration,color".split(",");
a.plugins.paste.onPostProcess.add(function(a,b){c("*",b.node).each(function(){var a=c(this);if(a.attr("style")){var b={};c.each(d,function(c,d){a.attr("style").match(RegExp("\\b"+d+"\\b","i"))&&(b[d]=a.css(d))});a.attr("style","");a.css(b)}});wikispaces.util.Cleanup.collapseNodes(c("span",b.node));wikispaces.util.Cleanup.flattenNodes(c("span",b.node))})}},getInfo:function(){return{longname:"Wikispaces common",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",
version:"0.1"}},fullContent:function(a,b){if("visual"==this.editor.plugins.wscommon.getOption("mode")){try{var d=b?b.split(","):[];d.push("mso");d.push("merge");d.push("relativeFiles");c(this.editor.getDoc()).find("span").length!=this.startingSpanCount&&d.push("collapse");f.isWebKit&&d.push("safari");wikispaces.util.Cleanup.cleanup(this.editor,d.join(","),a);this.startingSpanCount=c(this.editor.getDoc()).find("span").length}catch(e){}c("img[data-mce-src]",this.editor.getDoc()).each(function(){c(this).attr("src",
c(this).data("mce-src"))});return this.editor.plugins.wsreference.pushInReferences(this.editor.getContent({format:"raw"}))}return c("#textEditor").val()},editorIFrame:function(){return document.getElementById(this.editor.id+"_ifr")},editorToolbar:function(){return document.getElementById(this.editor.id+"_external")},editorContainer:function(){return document.getElementById(this.editor.id+"_container")},sessionReloadFailed:function(){var a=f.mainEditor;this.reloadFailed=!0;a.plugins.wsautosave.autosaveEnabled=
!1;a.plugins.wsautosave.setStatus("Autosave Disabled",!0);a.controlManager.setDisabled("wspreview",!0);a.controlManager.setDisabled("wsimage",!0);a.plugins.wslinkpopup.disableSelect();alert("Your connection to Wikispaces has been disrupted.  We recommend you save your page now, and try editing the page again.")},getIframeInParentWindow:function(a){var a=a.ownerDocument,b=a.parentWindow;b||(b=a.defaultView);return!b||b.parent==b?null:b.frameElement},absoluteOffset:function(a){for(var b=0,c=0;a&&!("BODY"==
a.tagName.toUpperCase()&&(a=this.getIframeInParentWindow(a),!a));)b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;return{left:c,top:b}},getPositionWith:function(a,b,d){var b=c(b),a=c(a),e=this.absoluteOffset(b[0]),g=this.absoluteOffset(a[0].offsetParent),f=e.left+b.outerWidth()-g.left,b=e.top+b.outerHeight()-g.top;d&&(b+=d,f+=d);a=a.outerWidth();d=c(this.editor.getContentAreaContainer()).offset().left;e=c("body").width();f+d+a>e&&(f=e-a-d);0>b&&(b=0);0>f&&(f=0);return{left:f,top:b}},positionBelow:function(a,
b){var b=c(b),a=c(a),d=this.absoluteOffset(b[0]),e=c(window).scrollLeft(),g=c(window).scrollTop(),f=d.left+2,d=d.top+b.outerHeight()+4,k=a.outerWidth(),l=c(window).width()+e;f+k>l&&(f=l-k);k=a.outerHeight();l=c(window).height()+g;d+k>l&&(d=l-k);d<g&&(d=g);f<e&&(f=e);e=this.absoluteOffset(a[0].offsetParent);return{left:f-e.left,top:d-e.top}},scrollToElement:function(a){var a=c(a),b=this.absoluteOffset(a[0]).top,a=a.outerHeight({margin:!0}),d=b+a,e=document.body.scrollTop;0==e&&(window.pageYOffset?
e=window.pageYOffset:document.body.parentElement?e=document.body.parentElement.scrollTop:widowTop=0);var g=c(window).height(),f=e+g,k=b-(e+50);0>k||g-50<a&&b>e+50?c(window).scrollTo({top:"+="+(k-30)+"px",left:"+=0px"}):(b=d-f,0<b&&c(window).scrollTo({top:"+="+(b+150)+"px",left:"+=0px"}))},cursorToAndRemoveElement:function(a){a=c(a);a.length&&(this.editor.selection.select(a[0],!0),this.editor.selection.collapse(!0),this.editor.focus(),this.scrollToElement(a),a.remove(),this.editor.nodeChanged())},
getSiblingOfElement:function(a,b){if(!a)return null;b||(b="next");for(var c=a[b+"Sibling"];c&&3==c.nodeType&&""==c.nodeValue;)c=c[b+"Sibling"];return c},disableUntilLibsLoad:function(a,b){a.onInit.add(function(){ws.editor.content.isLoaded||(a.theme.controlManager().setDisabled(b,!0),ws.editor.content.add(function(){a.theme.controlManager().setDisabled(b,!1)}))})},isNodeEmpty:function(a){return this.isTextEmpty(c(a).text())},isTextEmpty:function(a){a=a.replace(/\uFEFF/g,"");a=c.trim(a);return 0==a.length},
areNodesAdjacent:function(a,b){for(;a&&a!=b;){if(1==a.nodeType||!this.isTextEmpty(a))return!1;a.prev.nextSibling}return a==b?!0:!1},isCommentEditor:function(){return c(this.editor.getContainer()).parent().is(".commentEditor")},getOption:function(a){return c(this.editor.getElement()).closest("form").find('input[title="'+a+'"]').val()},setOption:function(a,b){return c(this.editor.getElement()).closest("form").find('input[title="'+a+'"]').val(b)},resizeToolbar:function(){var a=c("#wsMainEditor_external"),
b=c("span.mce_menuPreview").closest("tr"),d=c("#wsMainEditor_wspreview").closest("td");c(window).width()<674+a.offset().left?(d.hide(),b.show(),c(".mceButtonLabel").slice(0,5).hide(),a.css("min-width",615)):c(window).width()<848+a.offset().left?(d.show(),b.hide(),c(".mceButtonLabel").slice(0,5).hide(),a.css("min-width",674)):(d.show(),b.hide(),c(".mceButtonLabel").show(),a.css("min-width",848))}});f.PluginManager.add("wscommon",wikispaces.plugins.CommonPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.TablePlugin",{init:function(a){var b=this;this.editor=a;this.emptyCellContents=f.isIE?"&nbsp;":"<br/>";a.addCommand("wsTable",function(){a.dom.getParent(a.selection.getNode(),"TABLE,UL,OL")||(f.mainEditor.plugins.wspopup.show("tablePopupContents",{plugin:b}),c("#tablePopupContents input").first().focus())});a.addButton("wstable",{title:"Insert Table",label:"Table",onclick:function(){f.activeEditor.wsExecCommand("wsTable");ws.common.track("Editor","Open Table Tool")}});
a.onNodeChange.add(function(a,b,g){g=a.selection.getStart();if(!g||c(g).parents().andSelf().is(".mceContentBody")){var b=a.dom.getParent(g,"td,th"),h="TABLE"===g.nodeName||!!b;"visual"==a.plugins.wscommon.getOption("mode")?(a.theme.controlManager().setActive("wstable",h),a.theme.controlManager().setDisabled("wstable",c(g).parents().is("ol,ul"))):(a.theme.controlManager().setActive("wstable",!1),a.theme.controlManager().setDisabled("wstable",!1));b&&!c(g).is("img")&&"visual"==a.plugins.wscommon.getOption("mode")?
f.mainEditor.plugins.wstableoverlay.selectTableCell(b):f.mainEditor.plugins.wstableoverlay.unselectTableCell()}});a.onInit.add(function(a){if(!f.isIE){var b=function(){var b;for(b=a.getBody().lastChild;b&&3==b.nodeType&&!b.nodeValue.length;b=b.previousSibling);b&&"TABLE"==b.nodeName&&a.dom.add(a.getBody(),"p",null,'<br mce_bogus="1" />')};f.isGecko&&a.onKeyDown.add(function(a,b){var c,d,e=a.dom;if(37==b.keyCode||38==b.keyCode){c=a.selection.getRng();d=e.getParent(c.startContainer,"table");var f;if(f=
d&&a.getBody().firstChild==d){f=c;var o=d.ownerDocument;c=o.createRange();c.setStartBefore(d);c.setEnd(f.endContainer,f.endOffset);f=o.createElement("body");f.appendChild(c.cloneContents());c=f.innerHTML.replace(/<(br|img)[^>]*>/gi,"-");c=c.replace(/<table[^>]*>\s*(<tbody[^>]*>\s*)?(<tr[^>]*>\s*|(<tr[^>]*>\s*)?<t(d|h)[^>]*>)/g,"");c=c.replace(/<[^>]+>/g,"");f=0==c.length}f&&(c=e.createRng(),c.setStartBefore(d),c.setEndBefore(d),a.selection.setRng(c),b.preventDefault())}});a.onKeyUp.add(b);a.onSetContent.add(b);
a.onVisualAid.add(b);a.onPreProcess.add(function(a,b){var c=b.node.lastChild;c&&1==c.childNodes.length&&"BR"==c.firstChild.nodeName&&a.dom.remove(c)});b()}});a.onKeyDown.addToTop(function(a,b){if(f.mainEditor.plugins.wstableoverlay.selectedTableCell&&!b.ctrlKey&&!b.altKey){if("9"==b.keyCode){var g=c(f.mainEditor.plugins.wstableoverlay.selectedTableCell),h;b.shiftKey?(h=g.prev("td,th"),0==h.length&&0<g.parents("tr").eq(0).prev("tr").length&&(h=g.parents("tr").eq(0).prev("tr").find("td,th").eq(g.parents("tr").eq(0).prev("tr").find("td,th").length-
1)),h.length||(f.mainEditor.plugins.wstableoverlay.addNewRow(!1,!0),h=g.parents("tr").eq(0).prev("tr").find("td,th").eq(g.parents("tr").eq(0).prev("tr").find("td,th").length-1))):(h=g.next("td,th"),0==h.length&&0<g.parents("tr").eq(0).next("tr").length&&(h=g.parents("tr").eq(0).next("tr").find("td,th").eq(0)),h.length||(f.mainEditor.plugins.wstableoverlay.addNewRow(!1,!1),h=g.parents("tr").eq(0).next("tr").find("td,th").eq(0)));h.length&&(h=h.get(0),a.selection.select(h,!0),a.selection.collapse(!0),
f.mainEditor.plugins.wstableoverlay.selectTableCell(h),f.activeEditor.undoManager.add(),b.preventDefault(),b.stopPropagation())}if(f.isWebKit&&(8==b.keyCode||46==b.keyCode))g=c(a.selection.getNode()).closest("li:first-child"),0<g.size()&&""==g.text()&&(a.undoManager.begin(),h=g.parent(),g.remove(),0==h.children().size()&&h.remove(),span=c("<span>",a.getDoc()).prependTo(f.mainEditor.plugins.wstableoverlay.selectedTableCell),a.plugins.wscommon.cursorToAndRemoveElement(span),a.undoManager.end())}});
a.plugins.wscommon.disableUntilLibsLoad(a,"wstable")},getInfo:function(){return{longname:"Wikispaces table",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},addTable:function(a,b){ws.common.track("Editor","Add Table",a+"x"+b);if(isNaN(a)||1>a)a=1;if(isNaN(b)||1>b)b=1;for(var d='<table class="wiki_table" id="__newTable__">\n',e=0;e<a;e++){for(var d=d+"<tr>\n",g=0;g<b;g++)d+="<td>"+this.emptyCellContents+"</td>\n";d+="</tr>\n"}e=this.editor;e.wsselection.setContent(d+
"</table>\n");d=e.dom.select("#__newTable__")[0];e.dom.split(c(d).closest("p,div,h1,h2,h3,h4,h5,h6")[0],d);d=e.dom.select("#__newTable__")[0];e.dom.setAttrib(d,"id",null);c("td",e.contentDocument).css({minWidth:5,minHeight:20});d=e.dom.select("td",d)[0];e.selection.select(d.firstChild);e.selection.collapse(!0);e.controlManager.setDisabled("table",!0);e.controlManager.setActive("table",!0);f.mainEditor.plugins.wstableoverlay.selectTableCell(d);f.mainEditor.controlManager.setActive("wstable",!0)}});
f.PluginManager.add("wstable",wikispaces.plugins.TablePlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.popups.Image",{MAX_PER_ROW:8,MAX_ROWS:8,PER_PAGE:6,IMAGE_SIZE:32,externalPosition:0,currentMode:"all",newUploads:[],plugin:null,editor:null,tagFilter:null,fileSource:"",init:function(a){var b=this;b.editor=a;a.plugins.wspopup.register({wsname:"imageTool",title:"Images and Files",width:670,height:387,wsselection:0,onShow:function(a){b.onShow(a)},uiSetup:function(a){b.uiSetup(a)}})},onShow:function(a){this.showPage(1);this.setPlugin(a.plugin);this.uploader.refresh()},
setPlugin:function(a){this.plugin=a},addPage:function(a){var b=this,d=document.createElement("a");d.href="#";c(d).click(function(){ws.common.track("Editor","Show File Page",a);b.showPage(a);return!1});c(d).html(a);c(d).addClass("pageNumber");c("#imagePages").append(d).append("&nbsp;")},showPage:function(a){var b=this;this.showFileSpinner();var d=(a-1)*this.PER_PAGE,e=this.PER_PAGE,g="";c("#filenameAutocomplete").val()!=c("#filenameAutocomplete").attr("title")&&(g=c("#filenameAutocomplete").val());
var h=ws.common.pathFor("file","listjson",this.currentMode);this.fileSource&&(h=(match=this.fileSource.match(/(.*)\*$/))?match[1]+"file/listjson/"+this.currentMode+"?allTeams=1":this.fileSource+"file/listjson/"+this.currentMode);c.ajaxq("imageList");c.ajaxq("imageList",{url:h,type:"GET",cache:!1,data:{offset:d,pageLimit:e,filename:g,tag:this.tagFilter.getTags()},dataType:"json",global:!1,error:function(){ws.session.reloadSession(function(){b.showPage(a)},3E3,function(){f.activeEditor.plugins.wscommon.sessionReloadFailed()})},
success:function(a){ws.session.reloadSessionSuccess();b.loadFileData(a);b.editor.plugins.wspopup.resize("imageTool")}})},showFileSpinner:function(){c("#filenameAutocomplete").css("background","white url('/i/spinner.gif') no-repeat center right")},hideFileSpinner:function(){c("#filenameAutocomplete").css("background-image","none")},setListMode:function(a){c("#fileListMode").val(a);this.currentMode=a;this.tagFilter.setMode(a);this.showPage(1);this.tagFilter.showPage(1)},getCell:function(a,b){return c("#"+
a+" tr").eq(Math.floor(b/this.MAX_PER_ROW)).find("td").get(b%this.MAX_PER_ROW)},addRow:function(a){var b=document.createElement("tr");for(j=0;j<this.MAX_PER_ROW;j++)b.appendChild(document.createElement("td"));c("#"+a).append(b)},addFileRow:function(a,b,d,e,g,h,k,l,m){var n=this,o=null;"image"==e||this.isImage(e)||"application/vnd.google-apps.drawing"==e?o="image":this.isAudio(e)?o="audio":this.isVideo(e)&&(o="video");li1=c("<li>").attr("title",d).addClass("active");m||li1.click(function(){n.plugin.insertImageInEditor(b,
d,o,null,h,k);n.editor.plugins.wspopup.hide("imageTool")});a=document.createElement("img");m?(a.src="/i/c.gif",a.width=n.IMAGE_SIZE,a.height=n.IMAGE_SIZE):"image"==o&&l?(a.src=l,a.height>a.width?(a.width=a.width/a.height*n.IMAGE_SIZE,a.height=n.IMAGE_SIZE):(a.height=a.height/a.width*n.IMAGE_SIZE,a.width=n.IMAGE_SIZE)):(l=(h?h:"")+ws.common.encodePath(b,"thumbnail",d),a.src=l+"?size="+n.IMAGE_SIZE+(m?"&rnd="+Math.random():""),a.width=n.IMAGE_SIZE,a.height=n.IMAGE_SIZE);c(li1).append(a).append(c('<div class="fileName">').text(ws.common.truncify(d,
40)));m=f.mainEditor.getParam("wsimage_page_view_group");1==ws.common.compareGroupPermissionValues(g,m)&&c('<img src="/i/icon_16_hidden.png"/>').css({"float":"right","padding-top":6}).attr("title","This file has more restrictive permissions than this page. Some users may not be able to see it.").attr("alt","This file has more restrictive permissions than this page. Some users may not be able to see it.").appendTo(li1);c(".fileList ul").append(li1);return li1},addFileCell:function(a,b,d,e,f,h){var k=
this,l=a+"-file-"+e,d=this.getCell(a,e);d||(this.addRow(a),d=this.getCell(a,e));a=document.createElement("td");a.style.textAlign="center";a.style.padding="5px;";a.title=b;c(a).dblclick(function(){k.plugin.insertImageInEditor("external",b,"image",f);k.editor.plugins.wspopup.hide("imageTool")});h||(h=document.createElement("img"));f&&(h.src=f,h.height>h.width?(h.width=h.width/h.height*k.IMAGE_SIZE,h.height=k.IMAGE_SIZE):(h.height=h.height/h.width*k.IMAGE_SIZE,h.width=k.IMAGE_SIZE));h.onmousedown=function(){return false};
e=document.createElement("div");e.className="WikiUploadFileEditor";e.appendChild(h);a.appendChild(e);h=c("<span>").attr("id",l).text(ws.common.truncate(b,13));c(e).append("<br/>").append(h);d.parentNode.replaceChild(a,d)},resetPages:function(){var a=this;c("#imagePages").html('<a href="#" class="pageNumber pageCurrent" style="visibility: hidden;">&nbsp;</a>');var b=1,d=this.pageCount;7<this.pageCount&&(b=this.currentPage-1,1>b&&(b=1),d=b+1,d>this.pageCount&&(d=this.pageCount));for(var e=1+d-b+(d==
this.pageCount?0:1)+(1==b?0:1),f=0;7>e&&(1!=b||d!=this.pageCount);)f%2?(b--,1>b&&(b=1)):(d++,d>this.pageCount&&(d=this.pageCount)),f++,e=1+d-b+(d==this.pageCount?0:1)+(1==b?0:1);if(1<this.pageCount){1==this.currentPage?c("#imagePages").append('<span class="pageFirst inactive">&laquo; Previous</span>'):(e=c('<a href="#" class="pageFirst">&laquo; Previous</a>').click(function(){a.showPage(a.currentPage-1)}),c("#imagePages").append(e));1<b&&(this.addPage(1),2<b&&c("#imagePages").append(" ... "));for(f=
b;f<=d;f++)this.addPage(f);this.pageCount>d&&(d+1<this.pageCount&&c("#imagePages").append(" ... "),this.addPage(this.pageCount));this.currentPage==this.pageCount?c("#imagePages").append('<span class="inactive">Next &raquo;</span>'):(b=c('<a href="#">Next &raquo;</a>').click(function(){a.showPage(a.currentPage+1)}),c("#imagePages").append(b))}},loadFileData:function(a){var b=this;c(".fileList ul").empty();var d=0;if("myrecent"==this.currentMode){var e=(b.currentPage-1)*b.PER_PAGE;c.each(this.newUploads,
function(a,f){if(!(a<e)){if(d>=b.PER_PAGE)return!1;var g=b.addFileRow("imageTable",f.f_type,f.f_name,f.r_mime_type,f.f_view_group,f.f_location,f.f_context,null,!0);c(g).attr("id","swfu_file_"+f.id).find("div.fileName").append("&nbsp;&nbsp;").append(c("<a>").attr("href","#").addClass("uploadCancelButton").attr("id",f.id+"cancel").text("cancel").click(function(a){g.remove();b.uploader.removeFile(b.uploader.getFile(f.id));a.preventDefault()})).append('<div class="progressContainer"><div class="progressBar" id="'+
f.id+'progress"></div></div>');d++}})}c.each(a.files,function(a,c){if(d>=b.PER_PAGE)return!1;b.addFileRow("imageTable",c.f_type,c.f_name,c.r_mime_type,c.f_view_group,c.f_location,c.f_context);d++});if(!d){var f=c("<li>").text("No files found").addClass("nodata");c(".fileList ul").append(f);d++}for(;d<this.PER_PAGE;){var f=document.createElement("li"),h=document.createElement("img");h.src="/i/c.gif";h.height=b.IMAGE_SIZE;h.width=b.IMAGE_SIZE;f.appendChild(h);f.appendChild(document.createTextNode(" "));
c(".fileList ul").append(f);d++}this.pageCount=a.pagedata.numpages;this.currentPage=a.pagedata.current;this.resetPages();this.highlightPage(this.currentPage);this.hideFileSpinner()},highlightPage:function(a){c("#imagePages a.pageNumber").each(function(){c(this).html()==a?c(this).addClass("pageCurrent"):c(this).removeClass("pageCurrent")})},externalImageOnloadCallback:function(a){if(0==a.height)alert("The external image could not be found.");else{var b=a.src,c=b.match(/.*\/([^\/\?]+)/);2==c.length&&
this.addFileCell("externalTable",c[2],"image",this.externalPosition++,b,a)}},showExternalImage:function(){var a=this,b=document.getElementById("externalImageUrl").value;if(b){var d=new Image;c(d).one("load",function(){a.externalImageOnloadCallback(d)});c(d).one("error",function(){alert("The external image could not be found.")});d.src=b}else alert("Please enter the address of an external image.")},uiSetup:function(a){var b=this;c("#imageCloseButton").click(function(){a.close();return!1});for(i=0;i<
this.MAX_ROWS;i++)this.addRow("externalTable");ws.session.reloadSessionAt(0);ws.common.inputHint(c("#imageDivTable .fileNameField"));c("#fileListMode").change(function(){b.setListMode(c(this).val())});(!wikispaces_isUserLoggedIn||!wikispaces_isUploadCapable)&&c("#uploadButtons button").prop("disabled",!0);c("#externalTabCell button").click(function(){b.showExternalImage();return!1});c("#imageDiv .modeSelector li.tab").click(function(){c("#imageDiv .modeSelector li.tab").removeClass("selected");c(this).addClass("selected");
c("#imageDiv .fileMode").hide();c("#imageDiv").find("#"+c(this).attr("id")+"Cell").show()});ws.common.inputHint(c("#filenameAutocomplete"));c("#filenameAutocomplete").keyup(function(){b.showPage(1);b.tagFilter.showPage(1)});wikispaces_username&&c("#fileListMode").append('<option value="myrecent">My Recent Uploads</option>');ws.autocomplete.registerAutocompleters(c("#imageDiv"));this.tagFilter=ws.cob.initFilter(c("#imageDiv .filterWrapper"),{tagChangeCallback:function(){b.showPage(1)},sessionFailCallback:function(){f.activeEditor.plugins.wscommon.sessionReloadFailed()},
tagPageChangeCallback:function(){a.resize()}});-1!=navigator.platform.indexOf("Mac")&&c("#ctrlKeyName").html("&#8984;");var d=c("#fileSourcesList").find("select");d.length&&(this.defaultSpace=d.val(),c(".filterSourcesDrop").append(d),c(".filterSources").show());c(".filterSourcesDrop select").change(function(){b.fileSource=c(this).val()==b.defaultSpace?"":c(this).val();b.resetPages();b.showPage(1)});wikispaces_isUserLoggedIn&&this.setupUploader()},setupUploader:function(){var a=this,b=f.mainEditor;
this.uploader=new plupload.Uploader({runtimes:_(ws.common.pluploadRuntimes()).without("silverlight").join(","),browse_button:"uploadFiles",url:b.getParam("wsimage_upload_url"),flash_swf_url:"/s/plupload.flash.swf",silverlight_xap_url:"/s/plupload.silverlight.xap",multipart_params:Cookie.all(),max_file_size:b.getParam("wsimage_max_file_size_mb")+"MB",drop_element:"imageDivTable",container:"uploadButtons"});this.uploader.init();this.uploader.bind("FilesAdded",function(b,d){_(d).each(function(b){var c=
"application/octet-stream";a.isImageFilename(b.name)&&(c="image");a.newUploads.push({f_name:b.name,r_mime_type:c,id:b.id})});a.setListMode("myrecent");c("#imageDivTable .filterTagShow").effect("highlight",{},3E3);c("#filenameAutocomplete").val("");c("#imageDiv .WikiTokenAutocomplete .closebutton").click();c("#uploadFiles").hide();c("#cancelQueueBtn").show();b.refresh();b.start()});this.uploader.bind("UploadProgress",function(a,b){c("#swfu_file_"+b.id).find(".progressBar").css("width",b.percent+"%")});
this.uploader.bind("FileUploaded",function(a,b){c("#swfu_file_"+b.id).attr("id","").find(".progressContainer").remove();c("#"+b.id+"cancel").remove()});var d=function(){a.newUploads=[];c("#cancelQueueBtn").hide();c("#uploadFiles").show();$iframe=c("<iframe>").css({width:0,height:0,border:0}).attr("src",ws.common.pathFor("file","upload")+"?multiModeConfirm=1&remoteMode=true").bind("load",function(){a.setListMode("myrecent");c("#filenameAutocomplete").val("");c("#imageDiv .WikiTokenAutocomplete .closebutton").click()}).appendTo(document.body)};
this.uploader.bind("UploadComplete",d);c("#cancelQueueBtn").click(function(){a.uploader.stop();d()});this.uploader.bind("Error",function(a,d){ws.common.logFileUploadError(d,b.getParam("wsimage_max_file_size_mb")+"MB");d.file&&c("#"+d.file.id).length&&c("#"+d.file.id).removeClass("fileUploading").addClass("uploadError");a.refresh()})},isImage:function(a){switch(a){case "image/png":case "image/x-png":case "image/jpeg":case "image/gif":case "image/jpg":case "image/pjpeg":return!0}return!1},isImageFilename:function(a){return a.match(/.*\.(?:gif|jpg|jpeg|png)$/i)},
isMedia:function(a){return this.isAudio(a)||this.isVideo(a)},isAudio:function(a){switch(a){case "audio/mpeg":case "audio/mpg":case "audio/mp3":case "audio/x-mp3":case "audio/x-mpeg":case "audio/x-mpg":case "application/asx":case "application/x-mplayer2":case "audio/x-ms-wma":case "audio/x-ms-wax":case "audio/3gpp":case "audio/3gpp2":case "audio/aac":case "audio/x-aac":case "audio/aiff":case "audio/x-aiff":case "audio/mid":case "audio/midi":case "audio/x-midi":case "audio/mp4":case "audio/m4a":case "audio/x-m4a":case "audio/wav":case "audio/x-wav":case "audio/x-pn-realaudio":case "audio/x-pn-realaudio-plugin":return!0}return!1},
isVideo:function(a){switch(a){case "video/x-ms-asf-plugin":case "video/x-ms-asf":case "video/x-ms-wm":case "video/x-ms-wmv":case "video/x-ms-wvx":case "video/avi":case "video/3gpp":case "video/3gpp2":case "video/m4v":case "video/x-m4v":case "video/mp4":case "video/mpeg":case "video/x-mpeg":case "video/quicktime":case "video/sd-video":case "video/flv":case "video/x-flv":case "video/x-msvideo":case "application/x-shockwave-flash":case "application/futuresplash":return!0}return!1}});f.PluginManager.add("wsimagepopup",
wikispaces.popups.Image)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.popups.SaveWithComment",{editor:null,init:function(a){var b=this;b.editor=a;a.plugins.wspopup.register({wsname:"saveWithComment",title:"Save With Comment",width:430,height:100,uiSetup:function(a){b.uiSetup(a)}})},uiSetup:function(a){var b=this.editor;c("#saveWithCommentComment").keydown(function(a){switch(a.which){case 13:c("#saveWithCommentSave").click();break;case 27:c("#saveWithCommentCancel").click()}});c("#saveWithCommentSave").click(function(a){ws.common.track("Editor","Stop",
"Comment");b.plugins.wscommon.setOption("comment",c("#saveWithCommentComment").val());b.wsExecCommand("wsSave");a.preventDefault();return!1});c("#saveWithCommentCancel").click(function(b){a.close();b.preventDefault();return!1});c("#saveWithCommentClose").click(function(b){a.close();b.preventDefault();return!1})}});f.PluginManager.add("wssavewithcommentpopup",wikispaces.popups.SaveWithComment)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.AutoloadPlugin",{init:function(a){this.editor=a;var b=this;a.onInit.add(function(a){a.onInitSubEditor&&a.onInitSubEditor.add(function(a){a.onChange.add(function(){f.mainEditor.plugins.wsautosave.autosaveDelayed()})});if(b.editor.plugins.wscommon.getOption("contentPresent")){b.loadVersionFromForm();var e=c("#autosaveData").get(0);if(e){var g=e.autosaveContent.value,h=JSON.parse(e.autosavePageComments.value);b.autoload(g,h,e.autosaveDate.value,e.autosaveVersion.value,
e.autosaveCleanup.value,e.autosaveAge.value,e.autosaveConflict.value)}b.editorLoaded()}else c("#wsMainEditor_container").hide(),c.ajax({url:ws.common.pathFor("page","dump",wikispaces_page,wikispaces_page_version),type:"GET",cache:!1,data:{mode:a.plugins.wscommon.getOption("mode"),format:a.plugins.wscommon.getOption("mode")},global:!1,error:function(a,c,d){b.error(a,c,d)},success:function(a){b.loadData(a);c("#content_view").hide();b.editorLoaded()},complete:function(){c("#wsMainEditor_container").show();
a.plugins.wstoolbarscroll.moveScroller()}})})},convertHtml:function(){c("#contentEditButton").remove();c("#content_view").contents().filter(function(){return 8==this.nodeType&&"ws:"!=c.trim(this.data).substring(0,3)}).remove();return c.trim(c("#content_view").html().replace(/<\!-- ws:start:WikiText[a-zA-Z]+Rule:(\d+):([\s\S]*?) --\>[\s\S]*?<\!-- ws:end:WikiText[a-zA-Z]+Rule:\1 --\>/g,function(a,b,d){return d?c("<div>").html(d).text():""}))},getInfo:function(){return{longname:"Wikispaces autoload",
author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},error:function(){ws.common.track("Editor","Start","Inline Failure");ws.editor._editorDeferred.reject();document.location=ws.common.pathFor("page","edit",wikispaces_page)},loadData:function(a){a=c(a);try{var b=a.find("checkout checkoutStatus").text(),d=a.find("checkout checkoutUser").text(),e=a.find("checkout checkoutDate").text(),f=a.find("checkout checkoutRefreshDate").text();this.checkout(b,d,
e,f);var h;h=parseInt(a.find("dump contentChanged").text())?a.find("dump content").text():this.convertHtml();var k=a.find("dump version").text(),l=a.find("dump editorCleanup").text(),m=JSON.parse(a.find("dump pageComments").text());this.loadVersion(h,m,k,l);var n=a.find("dump autosave autosaveContent").text(),o=a.find("dump autosave autosaveDate").text(),p=a.find("dump autosave autosaveVersion").text(),q=a.find("dump autosave autosaveCleanup").text(),s=a.find("dump autosave autosaveAge").text(),t=
a.find("dump autosave autosaveConflict").text(),r=(m=a.find("dump autosave autosavePageComments").text())?JSON.parse(m):{};this.autoload(n,r,o,p,q,s,t);ws.common.track("Editor","Start","Inline")}catch(u){this.error()}},checkout:function(a,b){if("locked"==a&&(!wikispaces_isUserLoggedIn||b!=wikispaces_username))alert(this.checkoutMessage),document.location=ws.common.pathFor(wikispaces_page)},loadVersionFromForm:function(){var a=c("#wsMainEditor").val(),b=JSON.parse(this.editor.plugins.wscommon.getOption("pageComments")),
d=this.editor.plugins.wscommon.getOption("version"),e=this.editor.plugins.wscommon.getOption("editorCleanup");this.loadVersion(a,b,d,e)},loadVersion:function(a,b,d,e){var g=this;c("html, body").animate({scrollTop:0},"fast");this.editor.plugins.wscommon.setOption("version",d);this.editor.plugins.wscommon.setOption("editorCleanup",e);"plain"==this.editor.plugins.wscommon.getOption("mode")?this.editor.plugins.wstext.flipToText(a):(this.editor.setContent(a,{wsautoload:!0}),f.isIE&&(e+=",brTable"),wikispaces.util.Cleanup.cleanup(this.editor,
e,!1),this.editor.undoManager.clear(),this.editor.setClean(),this.editor.onModeSwitch.dispatch("visual"),setTimeout(function(){g.editor.focus();g.editor.wsselection.ensureCursor();g.editor.onNeedsResize.dispatch()},100),c("img",this.editor.getBody()).load(function(){g.editor.onNeedsResize.dispatch()}).each(function(){this.src=this.src}));this.editor.plugins.wscomment.loadComments(b)},editorForm:function(){return c(this.editor.getContainer()).closest("form").get(0)},autoload:function(a,b,d,e,g,h,k){var l=
this;d&&(parseInt(k)&&86400<=h?(f.mainEditor.plugins.wspopup.show("expiredDraft"),c("#expiredDraftDate").text(d),c("#expiredDraftContent").html(a)):(this.autosaveContent=a,this.autosavePageComments=b,this.autosaveVersion=e,this.autosaveCleanup=g,f.mainEditor.plugins.wspopup.show("draftRecovered"),c("#recoveredDraftDate").text(d),a=this.editor.plugins.wscommon.getOption("version"),e!=a&&(c("#outOfDateDraft").show(),e=ws.common.pathFor("page","diff",wikispaces_page)+"?v1="+encodeURIComponent(e)+"&v2="+
encodeURIComponent(a),c("#outOfDateDraft a").attr("href",e))));this.editor.onChange.add(function(){l.editor.plugins.wsautosave.autosaveDelayed()})},editorLoaded:function(){window.setTimeout(function(){ws.editor._editorDeferred.resolve()},1E3)}});f.PluginManager.add("wsautoload",wikispaces.plugins.AutoloadPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.popups.Style",{plugin:null,currentColorInput:null,init:function(a){var b=this;b.editor=a;a.plugins.wspopup.register({wsname:"stylePopupContents",title:"Color and Style",width:680,height:350,wsselection:0,onShow:function(a){b.onShow(a)},uiSetup:function(a){b.uiSetup(a)}})},onShow:function(a){this.setPlugin(a.plugin);this.resetSpanText();var b=[];a.plugin&&(a.plugin.setSpanText(a.div),a.plugin.setSpanText(a.span),b=this.dedupeColors(a.plugin.getUsedColors()));this.setupSwatches(this.getStyleColors(b));
this.mergeBasicStyleToAdvanced();this.updatePreviewStyle();this.editor.selection.isCollapsed()?c("#removeStyleButton").hide():c("#removeStyleButton").show()},setPlugin:function(a){this.plugin=a},resetSpanText:function(){this.resetSpanStyleSize();this.resetSpanStyleFont();this.resetSpanStyleColor();this.resetSpanStyleBackgroundColor();this.resetSpanStyleAlignment();this.resetSpanStyleVertical();this.resetSpanStyleStrike();c(document.styleForm.styleText).val("")},resetSpanStyleSize:function(){c(document.styleForm.styleSize).val("100%")},
resetSpanStyleFont:function(){c(document.styleForm.styleFont).val("")},resetSpanStyleColor:function(){c.farbtastic("#colorpickerColor").setColor("#000000");c(document.styleForm.styleColor).val("")},resetSpanStyleBackgroundColor:function(){c.farbtastic("#colorpickerBackgroundColor").setColor("#FFFFFF");c(document.styleForm.styleBackgroundColor).val("")},resetSpanStyleAlignment:function(){c(document.styleForm.styleAlignment).val("")},resetSpanStyleVertical:function(){c(document.styleForm.styleVertical).val("")},
resetSpanStyleStrike:function(){c(document.styleForm.styleStrike).prop("checked",!1)},mergeAdvancedStyleToBasic:function(){var a=c(document.styleForm.styleText).val(),b;(b=a.match(/^\s*font-size:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("font-size",b[1]):this.resetSpanStyleSize();(b=a.match(/^\s*font-family:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("font-family",b[1]):this.resetSpanStyleFont();(b=a.match(/^\s*color:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("color",b[1]):this.resetSpanStyleColor();
(b=a.match(/^\s*background-color:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("background-color",b[1]):this.resetSpanStyleBackgroundColor();(b=a.match(/^\s*text-align:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("text-align",b[1]):this.resetSpanStyleAlignment();(b=a.match(/^\s*vertical-align:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("vertical-align",b[1]):this.resetSpanStyleVertical();(b=a.match(/^\s*text-decoration:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("text-decoration",
b[1]):this.resetSpanStyleStrike()},updatePreviewStyle:function(){"none"!=c(".styleBasic").css("display")&&this.mergeBasicStyleToAdvanced();var a=c.trim(document.styleForm.styleText.value).replace(/;?\n/gmi,"; ");c("#stylePreviewApplied").attr("style",a)},mergeBasicStyleToAdvanced:function(){var a=c(document.styleForm.styleText).val(),b=c(document.styleForm.styleSize).val(),d=c(document.styleForm.styleFont).val(),e=c(document.styleForm.styleColor).val(),f=c(document.styleForm.styleBackgroundColor).val(),
h=c(document.styleForm.styleAlignment).val(),k=c(document.styleForm.styleVertical).val(),l=c(document.styleForm.styleStrike).prop("checked"),a=b&&"100%"!=b?a.match(/^\s*font-size:\s*.*$/gmi)?a.replace(/^\s*font-size:\s*.*$/gmi,"font-size: "+b+";"):a+"\nfont-size: "+b+";":a.replace(/^\s*font-size:\s*.*$/gmi,""),a=d?a.match(/^\s*font-family:\s*.*$/gmi)?a.replace(/^\s*font-family:\s*.*$/gmi,"font-family: "+d+";"):a+"\nfont-family: "+d+";":a.replace(/^\s*font-family:\s*.*$/gmi,""),a=e?a.match(/^\s*color:\s*.*$/gmi)?
a.replace(/^\s*color:\s*.*$/gmi,"color: "+e+";"):a+"\ncolor: "+e+";":a.replace(/^\s*color:\s*.*$/gmi,""),a=f?a.match(/^\s*background-color:\s*.*$/gmi)?a.replace(/^\s*background-color:\s*.*$/gmi,"background-color: "+f+";"):a+"\nbackground-color: "+f+";":a.replace(/^\s*background-color:\s*.*$/gmi,"");h?(a=a.match(/^\s*text-align:\s*.*$/gmi)?a.replace(/^\s*text-align:\s*.*$/gmi,"text-align: "+h+";"):a+"\ntext-align: "+h+";",a.match(/^\s*display:\s*block;\s*$/gmi)||(a+="\ndisplay: block;")):(a=a.replace(/^\s*text-align:\s*.*$/gmi,
""),a=a.replace(/^\s*display:\s*block;\s*$/gmi,""));a=k?a.match(/^\s*vertical-align:\s*.*$/gmi)?a.replace(/^\s*vertical-align:\s*.*$/gmi,"vertical-align: "+k+";"):a+"\nvertical-align: "+k+";":a.replace(/^\s*vertical-align:\s*.*$/gmi,"");a=l?a.match(/^\s*text-decoration:\s*.*$/gmi)?a.replace(/^\s*text-decoration:\s*.*$/gmi,"text-decoration: line-through;"):a+"\ntext-decoration: line-through;":a.replace(/^\s*text-decoration:\s*.*$/gmi,"");c(document.styleForm.styleText).val(c.trim(a))},dedupeColors:function(a){a.sort();
for(var b=[],c=null,e=0;e<a.length;e++)a[e]!=c&&(b[b.length]=a[e]),c=a[e];return b},getBasicColors:function(){return"#000000,#404040,#808080,#C0C0C0,#FFFFFF,#FF0000,#00FF00,#0000FF,#FFFF00,#00FFFF,#FF00FF,#800000,#008000,#000080,#808000,#008080,#800080".split(",")},getStyleColors:function(a){for(var b=this.getBasicColors(),c=0;c<a.length;c++){for(var e=!1,f=0;f<b.length;f++)if(a[c]==b[f]){e=!0;break}e||(b[b.length]=a[c])}return b},setupSwatches:function(a){var b=this;c("#styleColors").empty();for(var d=
{"float":"left",margin:"3px",width:"20px",height:"15px",cursor:"crosshair",border:"1px black solid"},e=0;e<a.length;e++){var f=document.createElement("div");d["background-color"]=a[e];c(f).css(d);c(f).attr("title",a[e]);c(f).click(function(a){b.chooseStyleColor(c(this).css("backgroundColor"));a.preventDefault()});c("#styleColors").append(f)}},chooseStyleColor:function(a){if(a=(new RGBColor(a)).toHex().toUpperCase()){var b=this.currentColorInput.name;c.farbtastic("#colorpicker"+b.substring(5)).setColor(a);
document.styleForm[b].focus()}},adjustFont:function(a){var b=c(document.styleForm.styleSize).val();b.match(/%\s*$/gi)&&(b=parseInt(b),b+=a,c(document.styleForm.styleSize).val(b+"%"));this.updatePreviewStyle()},uiSetup:function(a){var b=this;c("#switchToAdvanced").click(function(){b.hideColorPickers();b.mergeBasicStyleToAdvanced();c("#stylePopupContents .styleAdvanced").show();c("#stylePopupContents .styleBasic").hide();c("#switchToBasic").removeClass("selected");c("#switchToAdvanced").addClass("selected");
return!1});c("#switchToBasic").click(function(){b.mergeAdvancedStyleToBasic();c("#stylePopupContents .styleAdvanced").hide();c("#stylePopupContents .styleBasic").show();c("#switchToAdvanced").removeClass("selected");c("#switchToBasic").addClass("selected");return!1});c("#styleAdvancedTextarea").keyup(function(){b.updatePreviewStyle()});c("#styleAdvancedTextarea").change(function(){b.updatePreviewStyle()});c("#styleFont").focus(function(){b.hideColorPickers()});c("#styleFont").change(function(){b.updatePreviewStyle()});
c("#sizeDown").click(function(){b.hideColorPickers();b.adjustFont(-10);return!1});c("#styleSize").focus(function(){b.hideColorPickers()});c("#styleSize").keyup(function(){b.updatePreviewStyle()});c("#sizeUp").click(function(){b.hideColorPickers();b.adjustFont(10);return!1});c("#styleColor").focus(function(){b.hideColorPickers();c("#colorpickerColor").show();c("#styleColors").show();b.currentColorInput=this});c("#styleColor").focus(function(){b.updatePreviewStyle()});c("#styleBackgroundColor").focus(function(){b.hideColorPickers();
c("#colorpickerBackgroundColor").show();c("#styleColors").show();b.currentColorInput=this});c("#styleBackgroundColor").focus(function(){b.updatePreviewStyle()});c("#styleAlignment").focus(function(){b.hideColorPickers()});c("#styleAlignment").change(function(){b.updatePreviewStyle()});c("#styleVertical").focus(function(){b.hideColorPickers()});c("#styleVertical").change(function(){b.updatePreviewStyle()});c("#styleStrike").focus(function(){b.hideColorPickers()});c("#styleStrike").click(function(){b.updatePreviewStyle()}).change(function(){b.updatePreviewStyle()});
var d=function(){f.activeEditor.focus();a.close();return!1};c("#applyStyleButton").click(function(){c("#stylePopupContents .styleBasic").is(":visible")&&b.mergeBasicStyleToAdvanced();b.plugin.applyStyle();return d()});c("#removeStyleButton").click(function(){b.plugin.removeStyle();return d()});c("#styleCancel").click(d);c("#styleCloseButton").click(d);c("#colorpickerColor").farbtastic(function(a){b.farbtasticCallback.call(this,a,document.styleForm.styleColor);b.updatePreviewStyle()});c("#colorpickerBackgroundColor").farbtastic(function(a){b.farbtasticCallback.call(this,
a,document.styleForm.styleBackgroundColor);b.updatePreviewStyle()})},farbtasticCallback:function(a,b){c(b).css({backgroundColor:a,color:0.5<this.hsl[2]?"#000":"#fff"});c(b).each(function(){this.value=a})},hideColorPickers:function(){c("#colorpickerColor").hide();c("#colorpickerBackgroundColor").hide();c("#styleColors").hide()}});f.PluginManager.add("wsstylepopup",wikispaces.popups.Style)})(tinymce,jQuery);
(function(f){f.create("wikispaces.plugins.SubEditorPlugin",{init:function(c){this.editor=c;c.onInitSubEditor=new f.util.Dispatcher(c);this.plugins=c.getParam("wssubeditor_plugins");this.options=c.getParam("wssubeditor_options");var a=this.options.setup,b=function(a){a.onInit.add(function(a){c.onInitSubEditor.dispatch(a)})};this.options.setup=a?function(c){a(c);b(c)}:b;var d=this;c.addCommand("wssubeditor",function(){d.create()})},getInfo:function(){return{longname:"Wikispaces sub editor",author:"Tangient LLC",
authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},create:function(c,a,b,d){this.options.plugins=b?b:this.plugins;c=new f.Editor(c,jQuery.extend({},this.options,a));c.render();d&&(c.initialized?d(c):c.onInit.add(d));return c}});f.PluginManager.add("wssubeditor",wikispaces.plugins.SubEditorPlugin)})(tinymce);
(function(f,c){f.create("wikispaces.plugins.ImagePlugin",{"static":{newImageIdCounter:1},init:function(a){var b=this;a.addCommand("wsimage",function(){f.mainEditor.plugins.wspopup.show("imageTool",{plugin:b})});a.addButton("wsimage",{title:"Insert Images and Files",label:"File",onclick:function(){f.activeEditor.wsExecCommand("wsimage");ws.common.track("Editor","Open Image Tool")}});a.onNodeChange.add(function(a,c,g){"visual"!=a.plugins.wscommon.getOption("mode")?a.theme.controlManager().setActive("wsimage",
!1):(c=b.isFilePlaceholder(g),a.theme.controlManager().setActive("wsimage",c),c?f.mainEditor.plugins.wsimageoverlay.show(a,g):f.mainEditor.plugins.wsimageoverlay.hide())});a.onSetContent.add(function(a){c('img[src*="embedthumbnail/placeholder"]',a.getBody()).addClass("missing")});a.onClick.add(function(a,e){c(e.target).is("img.missing")&&(a.selection.select(e.target),f.mainEditor.plugins.wspopup.show("imageTool",{plugin:b}))});a.plugins.paste.onPostProcess.add(function(a,b){c("img",b.node).each(function(){var a=
c(this);if(!a.attr("src").match(/https?:\/\//)){var b=Math.max(a.attr("width"),200),d=Math.max(a.attr("height"),50),e=window.location.protocol+"//"+window.location.host+ws.common.pathFor("site","embedthumbnail","placeholder")+"?w="+b+"&h="+d;a.attr("src",e).attr("width",b).attr("height",d).addClass("missing")}})});f.isGecko&&a.onInit.add(function(){a.dom.bind(a.getBody(),"drop",function(){setTimeout(function(){c("img",a.getDoc()).each(function(){c(this).attr("alt",c(this).attr("alt").replace(/\n/g,
""))})},0)})});a.plugins.wscommon.disableUntilLibsLoad(a,"wsimage")},getInfo:function(){return{longname:"Wikispaces image",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},isFilePlaceholder:function(a){return"IMG"==a.nodeName&&!c(a).hasClass("missing")&&!c(a).hasClass("WikiMedia")&&!c(a).hasClass("WikiReference")&&!c(a).hasClass("WikiAnchor")||c(a).hasClass("WikiMediaFile")},isLocalContext:function(a){var b=null;return"/"==a&&wikispaces_isDefaultSpace?
!0:(b=a.match(/^\/([^\/]+)\/([^\/]+)\//))?b[1]==wikispaces_projectName&&b[2]==wikispaces_spaceName:!1},insertImageInEditor:function(a,b,d,e,f,h){var k=this;if("image"==d){ws.common.track("Editor","Add Image",b);var l;e?l=e:"file"==a?l=f+ws.common.encodePath(a,"view",b):"doc"==a&&(l=f+ws.common.encodePath(a,"viewfile",b));var m=c("<img>").attr("src",l).hide().appendTo(c("body"));m.load(function(){k.insertImageInEditorCallback(a,b,d,e,f,h,m)});m.attr("src",m.attr("src"))}else ws.common.track("Editor",
"Add File",b),this.insertImageInEditorCallback(a,b,d,e,f,h)},insertImageInEditorCallback:function(a,b,d,e,g,h,k){var g=f.activeEditor,l="",m="newImage-"+wikispaces.plugins.ImagePlugin.newImageIdCounter++,n=m,l=h&&this.isLocalContext(h)?"":h,o,p,q,s;if("file"==a)o="view",p="WikiMediaFile",q="WikiFile",s="File";else if("doc"==a)o="viewfile",p="WikiMediaDoc",q="GoogleDoc",s="Google Doc";else if("external"!=a)return;"image"==d?(p="",800<k.width()&&(p=' width="800" height="'+Math.floor(800/k.width()*k.height())+
'"'),a=e?e:this.isLocalContext(h)?ws.common.pathFor(a,o,b):k.attr("src"),l='<img id="'+m+'" src="'+a+'"'+p+"/>",b=f.mainEditor.plugins.wsimageoverlay):"audio"==d?(n='wikitext@@media@@type="'+a+'" key="'+l+b+'"',a=window.location.protocol+"//www."+wikispaces_domain+"/site/embedthumbnail/"+a+"-audio/"+encodeURIComponent(b)+"?h=20&w=240",l='<img src="'+a+'" class="WikiMedia '+p+'" id="'+m+'" title="Audio Player: '+ws.common.escapeHtml(b)+'" />',b=f.mainEditor.plugins.wswidgetoverlay):"video"==d?(n='wikitext@@media@@type="'+
a+'" key="'+l+b+'"',a=window.location.protocol+"//www."+wikispaces_domain+"/site/embedthumbnail/"+a+"-video/"+encodeURIComponent(b)+"?h=300&w=300",l='<img src="'+a+'" class="WikiMedia '+p+'" id="'+m+'" title="Video Player: '+ws.common.escapeHtml(b)+'" />',b=f.mainEditor.plugins.wswidgetoverlay):(n="wikitext@@"+a+"@@"+l+b,a=window.location.protocol+"//www."+wikispaces_domain+"/site/embedthumbnail/"+a+"/"+encodeURIComponent(b)+"?h=40&w=200",l='<img src="'+a+'" class="'+q+'" id="'+m+'" title="'+s+": "+
ws.common.escapeHtml(b)+'" />',b=f.mainEditor.plugins.wsimageoverlay);g.wsselection.setContent(l);m=c("#"+m,g.getBody()).attr("id",n).attr("src",a).get(0);g.wsselection.updateBookmarkToNode(m);g.wsselection.restore();g.plugins.wscommon.scrollToElement(m);b.show(g,m)}});f.PluginManager.add("wsimage",wikispaces.plugins.ImagePlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.SelectionPlugin",{init:function(a){a.onInit.add(function(){a.wsselection=new wikispaces.util.Selection(a)});f.isIE||(a.onKeyUp.add(function(a,c){16==c.keyCode&&!a.selection.isCollapsed()&&a.wsselection.tightenSelection()}),a.onMouseUp.add(function(a){a.selection.isCollapsed()||a.wsselection.tightenSelection()}),a.onExecCommand.add(function(a){a.selection.isCollapsed()||a.wsselection.tightenSelection()}))},getInfo:function(){return{longname:"Wikispaces selection",
author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}}});f.create("wikispaces.util.Selection",{bookmark:null,type:null,textBookmark:null,editor:null,Selection:function(a){this.editor=a},save:function(a){return"visual"==this.editor.plugins.wscommon.getOption("mode")&&this.bookmark||"visual"!=this.editor.plugins.wscommon.getOption("mode")&&this.textBookmark?null:this.saveOver(a)},saveOver:function(a){if("visual"==this.editor.plugins.wscommon.getOption("mode")){this.bookmarkIsCollapsed=
this.editor.selection.isCollapsed();try{return this.bookmark=this.editor.selection.getBookmark(a),this.type=a,this.bookmark}catch(b){return null}}a=this.editor.plugins.wstext.editorTextArea();this.editor.plugins.wstext.prepareSelection(a);return this.textBookmark={start:a.sel_start,end:a.sel_end}},updateBookmarkToNode:function(a){this.editor.selection.select(a);this.editor.nodeChanged();a=this.type;null===a&&(a=0);this.saveOver(a)},restore:function(a){"visual"==this.editor.plugins.wscommon.getOption("mode")?
this.bookmark&&(this.editor.selection.moveToBookmark(c.extend({},this.bookmark,{keep:a})),this.bookmarkIsCollapsed&&this.editor.selection.collapse(!0),a||(this.type=this.bookmark=null)):this.textBookmark&&(this.editor.plugins.wstext.setSelectionRange(this.editor.plugins.wstext.editorTextArea(),this.textBookmark.start,this.textBookmark.end),a||(this.textBookmark=null))},setContent:function(a,b){var d=this.editor;if("visual"==this.editor.plugins.wscommon.getOption("mode")){var e=c("<div>").append(a);
e.find("img").addClass("NewWikiImage");a=e.html();d.focus();this.restore();b&&this.avoid(b);d.selection.setContent(a);d.undoManager.add();d.onNeedsResize&&d.onNeedsResize.dispatch();c("img.NewWikiImage",d.selection.getNode()).removeClass("NewWikiImage").load(function(){d.onNeedsResize&&d.onNeedsResize.dispatch()}).each(function(){this.src=this.src})}else this.editor.plugins.wstext.editorTextArea().focus(),this.restore(),this.editor.plugins.wstext.insertInEditor(a),this.textBookmark&&(this.textBookmark.end=
this.textBookmark.start)},avoid:function(a){var b=this.editor.selection;if(a=c(b.getNode()).closest(a).get(0))b.select(a),b.collapse()},selectedLink:function(){if(this.bookmark&&this.bookmark.id){var a=c("#"+this.bookmark.id+"_start",this.editor.getDoc()).closest("a");if(0<a.length)return a.get(0);a=c("#"+this.bookmark.id+"_end",this.editor.getDoc()).closest("a");if(0<a.length)return a.get(0);a=c("#"+this.bookmark.id+"_start",this.editor.getDoc()).next("a");if(0<a.length)return a.get(0)}return c(this.editor.selection.getNode()).closest("a").get(0)},
ensureCursor:function(){if(!(f.isIE||"visual"!=this.editor.plugins.wscommon.getOption("mode"))){var a=this;setTimeout(function(){c("input.WikiSearchInput").first().focus();c(a.editor.plugins.wscommon.editorIFrame()).focus()},500)}},selectAll:function(){this.editor.selection.select(this.editor.getBody(),!0)},canStepIntoNode:function(a){if(!a||3!=a.nodeType&&1!=a.nodeType)return!1;switch(a.nodeName){case "BR":case "HR":case "EMBED":case "FRAMESET":case "FRAME":case "IFRAME":case "IMG":case "OBJECT":return!1;
default:return!0}},tightenSelection:function(){if(!f.isIE){for(var a=this.editor.selection,b=a.getRng(!0),c=b.startContainer,e=b.startOffset,g=b.endContainer,h=b.endOffset;0<b.compareBoundaryPoints(Range.START_TO_END,b);){if(3==g.nodeType){if(0<h)break;l=g.previousSibling}else if(1==g.nodeType)l=0<h?g.childNodes[h-1]:g.previousSibling;else break;var k=null;l||(l=g.parentNode,k=0);if(!this.canStepIntoNode(l))break;if(null===k)if(3==l.nodeType)k=l.nodeValue.length;else if(1==l.nodeType)k=l.childNodes.length;
else break;g=l;h=k;b.setEnd(g,h)}0>=b.compareBoundaryPoints(Range.START_TO_END,b)&&(g=c,h=e,b.setStart(c,e));for(var l=null;0<b.compareBoundaryPoints(Range.START_TO_END,b);){if(3==c.nodeType){if(c.nodeValue.length>e)break;l=c.nextSibling}else if(1==c.nodeType)l=e<c.childNodes.length?c.childNodes[e]:c.nextSibling;else break;k=null;l||(l=c.parentNode,3==l.nodeType?k=l.nodeValue.length:1==l.nodeType&&(k=l.childNodes.length));if(!this.canStepIntoNode(l))break;null===k&&(k=0);c=l;e=k;b.setStart(c,e)}0>=
b.compareBoundaryPoints(Range.START_TO_END,b)&&b.setEnd(g,h);a.setRng(b)}},isInitialTextNode:function(a){if(3!=a.nodeType)return!1;for(a=a.prevSibling;null!=a;){if(3!=a.nodeType||""!=a.nodeValue)return!1;a=a.prevSibling}return!0},isTerminalTextNode:function(a){if(3!=a.nodeType)return!1;for(a=a.nextSibling;null!=a;){if(3!=a.nodeType||""!=a.nodeValue)return!1;a=a.nextSibling}return!0},isAtTheBeginningOf:function(a){if(!this.editor.selection.isCollapsed()||0<!c(this.editor.selection.getNode()).closest(a).length)return!1;
var b=this.editor.selection.getRng(!0);if(0!=b.startOffset||!this.isInitialTextNode(b.startContainer))return!1;for(b=this.editor.selection.getNode();!c(b).is(a);){if(0<c(b).prev().size())return!1;b=b.parentNode}return!0},isAtTheEndOf:function(a){if(!this.editor.selection.isCollapsed()||0<!c(this.editor.selection.getNode()).closest(a).length)return!1;var b=this.editor.selection.getRng(!0);if(b.endContainer.length!=b.endOffset||!this.isTerminalTextNode(b.endContainer))return!1;for(b=this.editor.selection.getNode();!c(b).is(a);){if(0<
c(b).next().size())return!1;b=b.parentNode}return!0},mineOrParentsNextSibling:function(a,b){return 0==c(a).next().size()&&a.parentNode?this.mineOrParentsNextSibling(a.parentNode,b):c(a).next().is(b)},isInFrontOf:function(a){if(!this.editor.selection.isCollapsed())return!1;var b=this.editor.selection.getRng(!0);return 3!=b.endContainer.nodeType||b.endContainer.length!=b.endOffset?!1:c(b.endContainer.nextSibling).is(a)?!0:this.mineOrParentsNextSibling(this.editor.selection.getNode(),a)},selectedElements:function(a){for(var b=
this.editor.selection.getRng(!0),d=1!=b.endContainer.nodeType?b.endContainer.parentNode:b.endContainer,b=1!=b.startContainer.nodeType?b.startContainer.parentNode:b.startContainer,e=[];null!=b;){c(b).is(a)&&e.push(b);if(b==d)break;if(0<c(b).has(d).size()){c(b).find("*").each(function(){c(this).is(a)&&e.push(this);if(this==d)return!1});break}c(b).find(a).each(function(){e.push(this)});b=0<c(b).next().size()?c(b).next().get(0):c(b).parents().next().get(0)}return e},normalizeOutsideLinks:function(){var a=
this.editor.selection.getRng(!0),b=a.startContainer;3==b.nodeType&&(b=b.parentNode);c(b).is("a")&&a.setStartBefore(b);b=a.endContainer;3==b.nodeType&&(b=b.parentNode);c(b).is("a")&&a.setEndAfter(b);this.editor.selection.setRng(a)},contentBefore:function(){var a=this.editor.selection.getRng(!0),b=a.cloneRange();b.collapse(!0);b.insertNode(c("<span>",this.editor.getDoc()).attr("id","_CB").get(0));b=this.editor.getContent({format:"raw",no_events:1});c("#_CB",this.editor.getDoc()).remove();this.editor.selection.setRng(a);
return(a=b.match(/<span id="_CB"/i))?b.substring(0,a.index):""},contentAfter:function(){var a=this.editor.selection.getRng(!0),b=a.cloneRange();b.collapse(!1);b.insertNode(c("<span>",this.editor.getDoc()).attr("id","_CB").get(0));b=this.editor.getContent({format:"raw",no_events:1});c("#_CB",this.editor.getDoc()).remove();this.editor.selection.setRng(a);return(a=b.match(/<span id="_CB".*?\/span>/i))?b.substr(a.index+a[0].length):""},withinCode:function(){return 0<c(this.editor.selection.getStart()).closest("pre").size()||
0<c(this.editor.selection.getEnd()).closest("pre").size()},withinMath:function(){var a=/\[\[math\]\]/g,b=this.contentBefore().match(a),a=this.contentAfter().match(a);return b&&0!=b.length%2||a&&0!=a.length%2}});f.PluginManager.add("wsselection",wikispaces.plugins.SelectionPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.PopupPlugin",{popups:{},popupStack:[],zIndex:4E5,BORDER_HEIGHT:40,BORDER_WIDTH:15,register:function(a){if(!a.wsname||this.popups[a.wsname])return!1;a=c.extend({},a);this.popups[a.wsname]=a},show:function(a,b){var d=this.popups[a];if(!d)return!1;void 0!==d.wsselection&&!1!==d.wsselection&&(0<=d.stackPosition||f.activeEditor.undoManager.begin(),f.activeEditor.wsselection.save(d.wsselection));d.popup||(d.popup=this._openPopup(d));var e=this._getTopPopup();
if(e&&d.wsname==e.wsname)return d.popup;0<=d.stackPosition&&this.popupStack.splice(d.stackPosition,1);e&&e.popup.blur();var e=this._getMaxZIndex()||this.zIndex,g=c("#"+d.popup.id);g.css("z-index",e+2);d.stackPosition=this.popupStack.length;this.popupStack.push(d);d.popup.focus();g.show();c(window).bind("resize."+d.popup.id,function(){clearTimeout(d.popup.resizeTimeoutId);d.popup.resizeTimeoutId=setTimeout(function(){d.popup.resize()},10)});d.popup.resize(!0);this._lightBox();d.onShow&&(b||(b={}),
d.onShow(b));return d.popup},hide:function(a){a=this.popups[a];if(!a||!a.popup)return!1;if(0<=a.stackPosition){this.popupStack.splice(a.stackPosition,1);a.stackPosition=-1;var b=this._getTopPopup();b?b.popup.focus():(f.activeEditor.focus(),void 0!==a.wsselection&&!1!==a.wsselection&&f.activeEditor.wsselection.restore());void 0!==a.wsselection&&!1!==a.wsselection&&f.activeEditor.undoManager.end()}c(window).unbind("."+a.popup.id);c("#"+a.popup.id).hide();this._lightBox();return!0},resize:function(a,
b){var c=this.popups[a];if(!c||!c.popup)return!1;c.popup.resize(b);return!0},_getTopPopup:function(){return this.popupStack[this.popupStack.length-1]},_getMaxZIndex:function(){var a=this._getTopPopup();return!a?0:c("#"+a.popup.id).css("z-index")},_lightBox:function(){var a=this._getMaxZIndex()-1,b=c("#wsPopupModalBlocker");b.length||(b=c("<div>").attr("id","wsPopupModalBlocker").addClass("ui-widget-overlay").appendTo(c("body")));0>a?b.hide():b.css("z-index",a).show()},_openPopup:function(a){var b=
this,a=c.extend({min_width:a.width,min_height:a.height},a);void 0==a.content&&(a.content="<div>"+ws.editor.content.loadContent(a.wsname)+"</div>");a.id=f.DOM.uniqueId();var d=c("<div>").addClass("wsPopup ui-corner-all").attr("id",a.id).css({width:a.width,height:a.height,overflow:"hidden","z-index":-1}).append(a.content).appendTo(c("body"));c.extend(a,{close:function(){b.hide(a.wsname)},blur:function(){d.removeClass("wsPopupFocus")},focus:function(){d.addClass("wsPopupFocus")},resize:function(a){b._resizePopup(this,
a)}});a.uiSetup&&a.uiSetup(a);this._moveIntoView(a,!0);this._resizePopup(a,!0);return a},_resizePopup:function(a,b){if(!a)return!1;var d=this,e=c("#"+a.id),f=e.children().eq(0);e.ready(function(){setTimeout(function(){var h={margin:!0},k=f.outerWidth(h),l=f.outerHeight(h);c.browser.safari&&(alternateWidth=f.outerWidth(),alternateHeight=f.outerHeight(),alternateWidth>k&&(k=alternateWidth),alternateHeight>l&&(l=alternateHeight));var m=0,n=function(){var a=c(this).outerWidth(h)+m,b=c(this).outerHeight(h)+
m;a>k&&(k=a);b>l&&(l=b)};f.find("table").each(n);m=20;f.find("iframe").each(n);l<a.min_height&&(l=a.min_height);k<a.min_width&&(k=a.min_width);var n={},o=c(window).height()-d.BORDER_HEIGHT,p=c(window).width()-d.BORDER_WIDTH;l>o&&(k+=c.getScrollbarWidth());k>p?(l+=c.getScrollbarWidth(),k=p,n.overflowX="scroll"):n.overflowX="hidden";l>o?(l=o,n.overflowY="scroll"):n.overflowY="hidden";n.width=k;n.height=l;e.css(n);d._moveIntoView(a,b)},10)})},_moveIntoView:function(a,b){var d=c(window).height(),e=c(window).width(),
f=c("#"+a.id),h={};if(b)h.top=(d-f.height()+this.BORDER_WIDTH)/2,h.left=(e-f.width())/2;else{var k=parseInt(f.css("top")),l=parseInt(f.css("left")),d=d-f.height()-k-this.BORDER_WIDTH/2,e=e-f.width()-l-this.BORDER_WIDTH/2;0>d&&(h.top=k+d);0>e&&(h.left=l+e)}f.css(h)}});f.PluginManager.add("wspopup",wikispaces.plugins.PopupPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.ReferencePlugin",{popup:null,init:function(a){this.editor=a;var b=this;this.nextRefId=0;a.onBeforeSetContent.addToTop(function(a,c){if((c.load||c.wsautoload)&&"visual"==a.plugins.wscommon.getOption("mode"))b.removeReferenceEditors(),b.pullOutReferences(c)});a.onModeSwitch.add(function(a){"plain"==a&&b.removeReferenceEditors()});var d=function(){for(var d=0;d<=b.nextRefId;d++){var e=0<c(a.getDoc()).find("#citation-"+d).length,f=b.isReferenceActive(d);(f&&
!e||!f&&e)&&b.toggleReference(d)}},e=function(){d()};a.onChange.add(function(){setTimeout(e,0)});a.onUndo.add(e);a.onRedo.add(e);var g=!1;a.onKeyDown.add(function(a){g=!a.selection.isCollapsed()});a.onKeyUp.add(function(a,b){(8==b.keyCode||46==b.keyCode||g)&&d()});a.onDblClick.add(function(a,d){if(c(d.target).is("img.WikiReference")){var e=b.elementIdToRefId(c(d.target).attr("id")),e=f.editors["reference-editor-"+e];c.scrollTo(e.getContentAreaContainer(),{axis:"y",duration:500});e.focus()}})},getInfo:function(){return{longname:"Wikispaces reference",
author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},getNextRefId:function(){return++this.nextRefId},elementIdToRefId:function(a){return a.match(/-(\d+)$/)[1]},pullOutReferences:function(a){var b=!1,c=this;a.content=a.content.replace(/(&lt;ref(?:&gt;|>)((?:.|\n)*?)&lt;\/ref(?:&gt;|>))|(<pre\s+.*?>)|(<\/pre>)/gmi,function(a,f,h,k,l){if(f&&!b)return a=c.getNextRefId(),f=c.makeReferenceHtml(a),c.addReferenceEditor(a,h),f;k?b=!0:l&&(b=!1);return a})},
pushInReferences:function(a){ws.common.log("pushInReferences");return a.replace(/<img[^>]*?id="?citation-(\d+)[^>]*?>/ig,function(a,c){return"&lt;ref&gt;"+f.editors["reference-editor-"+c].getContent()+"&lt;/ref&gt;"})},makeReferenceHtml:function(a){return'<img src="/i/icon_16_numbersquare.png" alt="Reference - double click to edit" title="Reference - double click to view" width="16" height="16" class="WikiReference" id="citation-'+a+'"/> '},insertReferenceAtSelection:function(){var a=this.getNextRefId();
this.editor.wsselection.setContent(this.makeReferenceHtml(a));var b=c(this.editor.getDoc()).find("#citation-"+a),b=c(this.editor.getDoc()).find("img.WikiReference").index(b);return this.addReferenceEditor(a,"Type the content of your reference here.",b)},addReferenceEditor:function(a,b,d){var e="reference-editor-"+a,f='<div id="reference-editor-container-'+a+'" class="editorLayer referenceEditorContainer"><textarea id="'+e+'"></textarea></div>';0==c("#referenceEditors").length&&c("#pageEditor").append('<div id="referenceEditors"></div>');
"undefined"!=typeof d&&0<c("div#referenceEditors > div:nth-child("+(d+1)+")").size()?c("div#referenceEditors > div:nth-child("+(d+1)+")").before(f):c("#referenceEditors").append(f);return this.editor.plugins.wssubeditor.create(e,{reference_reference_id:a,height:"50",theme:"-reference"},null,function(a){a.setContent(b)})},toggleReference:function(a){this.isReferenceActive(a)?(c("#reference-editor-container-"+a).hide(),this.editor.focus(),this.editor.undoManager.begin(),c(this.editor.getDoc()).find("#citation-"+
a).remove(),this.editor.undoManager.end()):c("#reference-editor-container-"+a).show()},isReferenceActive:function(a){return c("#reference-editor-container-"+a).is(":visible")},referenceCount:function(){return c("#referenceEditors div.referenceEditorContainer").size()},killEditor:function(a,b){a.remove();a.destroy();c("#reference-editor-container"+b).remove();c("#reference-editor-"+b).remove()},killZombieEditor:function(a,b,c){var e=this;_.delay(function(){a.initialized?e.killEditor(a,b):e.killZombieEditor(a,
b,2*c)},c)},removeReferenceEditors:function(){var a=this;c.each(f.editors.concat(),function(){if(match=this.id.match(/^reference-editor-(\d)+/)){var b=parseInt(match[1]);this.initialized?a.killEditor(this,b):a.killZombieEditor(this,b,500)}})}});f.PluginManager.add("wsreference",wikispaces.plugins.ReferencePlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.popups.ConcurrentEditor",{editor:null,init:function(a){var b=this;b.editor=a;a.plugins.wspopup.register({wsname:"concurrentEditor",title:"Page Activity",width:300,height:100,uiSetup:function(a){b.uiSetup(a)}})},uiSetup:function(a){c("#concurrentEditorClose").click(function(b){a.close();b.preventDefault();return!1})}});f.PluginManager.add("wsconcurrenteditorpopup",wikispaces.popups.ConcurrentEditor)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.AutosavePlugin",{AUTOSAVE_INTERVAL:6E4,concurrentEditors:[],savedVersions:[],init:function(a){this.editor=a;this.autosaveEnabled=f.activeEditor.getParam("wsautosave_enabled");var b=this;a.addCommand("wsautosave",function(){b.autosave()});a.onInit.add(function(){ws.editor.content.isLoaded||(c("#concurrentEditorDetails").prop("disabled",!0),ws.editor.content.add(function(){c("#concurrentEditorDetails").prop("disabled",!1)}));setInterval(function(){f.activeEditor.undoManager.add()},
61E3)})},getInfo:function(){return{longname:"Wikispaces autosave",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},autosaveDelayed:function(){var a=this;this.autosaveDelayedHandle||(this.autosaveDelayedHandle=setTimeout(function(){a.autosave(!0)},this.AUTOSAVE_INTERVAL))},autosave:function(a,b){clearTimeout(this.autosaveDelayedHandle);delete this.autosaveDelayedHandle;if(this.autosaveEnabled){ws.common.log("autosave",a);var d=this;"undefined"==
typeof a&&(a=!0);this.setStatus("Saving Draft...");"undefined"==typeof b&&(b=this.editor.plugins.wscommon.fullContent(!1));c.ajaxq("autosave",{url:this.getAutosaveUrl(),type:"POST",async:a,cache:!1,data:{content:b,pageComments:this.editor.plugins.wscomment.newComments()},dataType:"xml",global:!1,error:function(){ws.session.reloadSession(function(){d.autosave(a)},3E3,function(){d.editor.plugins.wscommon.sessionReloadFailed()})},success:function(a){d.autosaveProcessResponse(a);ws.session.reloadSessionSuccess()}});
ws.common.log("autosave finished")}else ws.common.log("not autosaving (disabled)",a)},getAutosaveUrl:function(){var a=this.editor.plugins.wscommon.getOption("mode"),b=this.editor.plugins.wscommon.getOption("version");return ws.common.pathFor("page","autosave",wikispaces_page,b)+"?mode="+encodeURIComponent(a)},setStatus:function(a,b){c("#autosaveStatus").hide().html(a).fadeIn(2E3);b&&c("#autosaveStatus").css("color","red")},autosaveProcessResponse:function(a){ws.common.log("autosaveProcessResponse",
a);var b=this,a=c(a),d=!1,e=a.find("autosave save").text(),f=a.find("autosave error").attr("message");e?this.setStatus("Draft Saved at "+e,!1):f?this.setStatus(f,!0):this.setStatus("");e=this.savedVersions.length;"changed"==a.find("status").attr("type")&&(this.savedVersions=[],a.find("status revision").each(function(){var a=c(this).find("user").text(),d=c(this).find("date").text(),e=c(this).attr("id");b.savedVersions.push({id:e,editor:a,time:d})}));this.savedVersions.length>e&&(ws.common.track("Editor",
"Concurrent Editing","Concurrent Save"),d=!0);e=0<this.concurrentEditors.length;this.concurrentEditors=[];a.find("concurrent editor").each(function(){var a=c(this).find("user").text(),d=c(this).find("date").text();b.concurrentEditors.push({editor:a,time:d})});!e&&this.concurrentEditors.length&&(ws.common.track("Editor","Concurrent Editing","Start"),d=!0);e&&0==this.concurrentEditors.length&&ws.common.track("Editor","Concurrent Editing","End");this.concurrentEditors.length&&ws.common.track("Editor",
"Concurrent Editing","Editor Count",this.concurrentEditors.length);e=c.trim(a.find("autosave merge mergeStatus").text());this.mergeResult="";"failed"==e?ws.common.track("Editor","Concurrent Editing","Merge Failed"):"success"==e&&(ws.common.track("Editor","Concurrent Editing","Merge Success"),this.mergeResult=a.find("autosave merge mergeResult").text());this.mergeStatus=e;d&&this.statusUpdated()},showConcurrentEditorPopup:function(){f.mainEditor.plugins.wspopup.show("concurrentEditor");if(this.savedVersions.length){var a=
this.editor.plugins.wscommon.getOption("version");c("#concurrentEditor_savedVersions").empty();c.each(this.savedVersions,function(a,b){var f=c('<li><img src="/user/pic/'+b.editor+'-sm.jpg" height="16" width="16" style="vertical-align: text-top;"/> '+b.editor+" saved a new version at "+b.time+'.  <a href="'+ws.common.pathFor("page","diff",wikispaces_page)+"/"+b.id+'" target="_new">View the changes</a></li>');c("#concurrentEditor_savedVersions").append(f)});if(1<this.savedVersions.length){var b=this.savedVersions[this.savedVersions.length-
1].id;c("#concurrentEditor_savedVersion_viewChanges").html('<a href="'+ws.common.pathFor("page","diff",wikispaces_page)+"?v1="+a+"&v2="+b+'" target="_new">View all changes since I started editing</a>').show()}c("#concurrentEditor_savedVersion_heading").show()}this.concurrentEditors.length?(c("#concurrentEditor_otherEditors").empty(),c.each(this.concurrentEditors,function(a,b){var f=c('<li><img src="/user/pic/'+b.editor+'-sm.jpg" height="16" width="16" style="vertical-align: text-top"/> '+b.editor+
" started editing this page at "+b.time+"</li>");c("#concurrentEditor_otherEditors").append(f)}),c("#concurrentEditor_otherEditor_heading").show(),c("#concurrentEditor_noEditors").hide()):(c("#concurrentEditor_otherEditor_heading").hide(),c("#concurrentEditor_noEditors").show());f.mainEditor.plugins.wspopup.resize("concurrentEditor")},statusUpdated:function(){var a=this,b="";if(1==this.savedVersions.length&&!this.concurrentEditors.length)var d=this.savedVersions[0].editor,b='<img src="/user/pic/'+
d+'-sm.jpg" height="16" width="16" style="vertical-align: text-top;"/> '+d+" saved this page.";else if(1<this.savedVersions.length&&!this.concurrentEditors.length)b=this.savedVersions.length+" people have saved this page.";else if(!this.savedVersions.length&&1==this.concurrentEditors.length)d=this.concurrentEditors[0].editor,b='<img src="/user/pic/'+d+'-sm.jpg" height="16" width="16" style="vertical-align: text-top;"/> '+d+" is editing.";else if(!this.savedVersions.length&&1<this.concurrentEditors.length)b=
this.concurrentEditors.length+" people are editing.";else if(this.savedVersions.length&&this.concurrentEditors.length)b="This page is being edited and has been saved.";else return;var e=c("#concurrentEditorNotice");if(e.get(0))c("#concurrentEditorNoticeMessage").html(b);else{e=c('<div id="concurrentEditorNotice" class="mceToolbar">').hide();d=c('<div id="concurrentEditorNoticeMessage" style="display: inline;">');d.html(b);b=c('<button class="btn" id="concurrentEditorDetails"><span><span>Details</span></span></button>');
b.click(function(b){a.showConcurrentEditorPopup();e.hide();b.preventDefault();return!1});var f=c('<button class="btn"><span><span>Hide</span></span></button>');f.click(function(a){e.hide();a.preventDefault();return!1});e.append(d).append(b).append(f);c(".mceExternalToolbar").append(e)}e.is(":visible")||e.slideDown()}});f.PluginManager.add("wsautosave",wikispaces.plugins.AutosavePlugin)})(tinymce,jQuery);
(function(f){f.create("wikispaces.plugins.UndoMainPlugin",{undoData:[],redoData:[],init:function(c){this.editor=c},add:function(c,a){a=c.undoManager.subAdd(a);if(!a)return null;this.clearRedo();var b=this.editor.settings;b.custom_undo_redo_levels&&this.undoData.length>b.custom_undo_redo_levels&&this.undoData.shift().undoManager.dropOldestUndo();this.undoData.push(c);this.updateButtonState();return a},remove:function(c){if(0==this.undoData.length)return null;var a=this.undoData.pop();if(a!=c)return this.undoData.push(a),
null;(c=a.undoManager.subRemove())||this.undoData.push(a);return c},undo:function(){f.activeEditor.undoManager.typing&&(this.add(f.activeEditor),f.activeEditor.undoManager.typing=0);if(!(0>=this.undoData.length)){var c=this.undoData.pop();if(c.destroyed)return this.undo();this.redoData.push(c);c.focus();c=c.undoManager.subUndo();this.updateButtonState();return c}},redo:function(){if(this.hasRedo()){var c=this.redoData.pop();this.undoData.push(c);c.focus();c=c.undoManager.subRedo();this.updateButtonState();
return c}},clear:function(){this.undoData=[];this.redoData=[];jQuery.each(f.editors,function(){this.initialized&&this.undoManager.subClear()});this.updateButtonState()},clearRedo:function(){this.redoData=[];jQuery.each(f.editors,function(){this.initialized&&this.undoManager.clearRedo()});this.updateButtonState()},hasUndo:function(){return 0<this.undoData.length||f.activeEditor.initialize&&f.activeEditor.undoManager.typing},hasRedo:function(){return 0<this.redoData.length},updateButtonState:function(){var c=
this.editor.controlManager;c.setDisabled("undo",!this.hasUndo());c.setDisabled("redo",!this.hasRedo())},removeEditor:function(c){var a;jQuery.each([this.undoData,this.redoData],function(){for(var b=a=0;b<this.length;++b)this[b]==c?++a:this[b-a]=this[b];this.length-=a});this.updateButtonState()}});f.PluginManager.add("wsundomain",wikispaces.plugins.UndoMainPlugin)})(tinymce);
(function(f,c){f.create("wikispaces.plugins.BlockFormatPlugin",{init:function(a){this.editor=a;a.addCommand("wsFormatBlock",function(b,e){if(f.isIE){var g=c(a.selection.getNode());g.is("p")&&0==g.contents().length&&g.append("\ufeff");a.execCommand("FormatBlock",b,e)}else a.undoManager.begin(),g=a.selection.getBookmark(2),0<c(f.activeEditor.selection.getNode()).closest("li").length?(a.execCommand("FormatBlock",b,"p"),a.execCommand("FormatBlock",b,e),c(f.activeEditor.selection.getNode()).closest("li").find("p").each(function(a,
b){c(b).replaceWith(b.childNodes)})):(a.execCommand("FormatBlock",b,e),c(a.plugins.wscommon.getSiblingOfElement(a.theme.getHeaderParent(a.selection.getNode()),"previous")).filter("br").after("<br>")),a.selection.moveToBookmark(g),a.undoManager.end()});a.onKeyDown.add(function(a,b){if(13==b.keyCode&&b.shiftKey&&0<c(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").length&&!a.wsselection.isAtTheEndOf("h1,h2,h3,h4,h5,h6")){var g=c(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").get(0);a.selection.setContent("<span id='_ws_tmp'></span>");
var h=c("#_ws_tmp",a.getDoc()).get(0);a.dom.split(g,h);a.plugins.wscommon.cursorToAndRemoveElement(c("<span>",a.getDoc()).prependTo(c(h).next()));c(h).remove();f.dom.Event.cancel(b)}});if(f.isWebKit){var b=!1;a.onKeyDown.add(function(a,e){b=13==e.keyCode&&0<c(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").length});a.onKeyUp.add(function(a){if(b&&0<c(a.selection.getNode()).closest("div").length){var e=c("<span>",a.getDoc()).replaceAll(c(a.selection.getNode()).closest("div")).after("<br/>");a.plugins.wscommon.cursorToAndRemoveElement(e)}})}f.isGecko&&
a.onKeyUp.add(function(a,b){if(9==b.keyCode){var f=c(a.selection.getNode()).closest("p");/padding-left/.test(f.attr("style"))&&(f.css("padding-left",""),a.undoManager.add()&&a.undoManager.remove())}})},getInfo:function(){return{longname:"Wikispaces block Format",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}}});f.PluginManager.add("wsblockformat",wikispaces.plugins.BlockFormatPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.popups.Link",{init:function(a){var b=this;b.editor=a;a.plugins.wspopup.register({wsname:"linkTool",title:"Insert Link",width:480,height:250,wsselection:2,onShow:function(a){b.onShow(a)},uiSetup:function(a){b.uiSetup(a)}})},setPlugin:function(a){this.plugin=a},onShow:function(a){this.setPlugin(a.plugin);this.resetForms();a.plugin&&a.plugin.setupForms()},resetForms:function(){c("#linkDiv input").val("");c("#linkText").closest("tr").show();c("#linkTargetNew").prop("checked",
!1).prop("disabled",!1);c("#linkDiv #submitLink span span").text("Add Link");c("#linkDiv #removeExistingLink").hide();c("#linkWikiName").val(wikispaces_wikiName);c("#linkWikiName").select2("val",{id:wikispaces_wikiName,text:wikispaces_wikiText});c("#linkPageName").val("");c("#linkPageName").select2("val",{id:""});c("#linkPageNameError").hide();this.hideAnchorField()},prefill:function(a){null===a.linkText&&c("#linkText").closest("tr").hide();a.pageName||a.wikiName?this.prefillInternal(a.linkText,a.objectClass,
a.pageName,a.wikiName,a.anchor,a.targetNew):a.mailTo?this.prefillEmail(a.linkText,a.mailTo):a.extLink?this.prefillExternal(a.linkText,a.extLink,a.targetNew):a.linkText&&(c("#linkText").val(a.linkText),c("#linkPageName").val(a.linkText),c("#linkPageName").select2("val",{id:"page:"+a.linkText,text:a.linkText}))},prefillInternal:function(a,b,d,e,f,h){c("#linkText").val(a);a=e;wikispaces_wikiName==e&&(a=wikispaces_wikiText);c("#linkWikiName").val(e);c("#linkWikiName").select2("val",{id:e,text:a});c("#linkPageName").val(("page"==
b?"":b+":")+d);c("#linkPageName").select2("val",{id:b+":"+d,text:d});c("#linkAnchor").val(f);f&&this.showAnchorField();c("#linkTargetNew").prop("checked",h);c("#linkDiv #submitLink span span").text("Change Link");c("#linkDiv #removeExistingLink").show();this.showInternal()},prefillExternal:function(a,b,d){c("#linkText").val(a);c("#linkUrl").val(b);c("#linkTargetNew").prop("checked",d);c("#linkDiv #submitLink span span").text("Change Link");c("#linkDiv #removeExistingLink").show();this.showExternal()},
prefillEmail:function(a,b){c("#linkText").val(a);c("#linkEmailAddress").val(b);c("#linkDiv #submitLink span span").text("Change Link");c("#linkDiv #removeExistingLink").show();this.showEmail()},disableSelect:function(){this.sessionFailure=!0},getValidatedLinkComponents:function(){if(c("#linkText").is(":visible")){var a=c("#linkText").val();if(""==a)return alert("Please enter link text."),!1;if(!this.validateLinkText(a))return!1}var b=c("#linkTargetNew").prop("checked");if("Internal"==this.linkType){var d=
c("#linkWikiName").val(),e=c("#linkPageName").val(),f="page",h;if(h=e.match(/(.+):(.+)/))f=h[1],e=h[2];if(""==d||""==e)return alert("Please enter a wiki and page name."),!1;if(!this.validatePageName(e))return!1;h=null;return"page"==f&&(h=c("#linkAnchor").val())&&!this.validateAnchor(h)?!1:{linkText:a,wikiName:d,pageName:e,objectClass:f,anchor:h,targetNew:b}}if("Email"==this.linkType){b=c("#linkEmailAddress").val();if(!b.match(/.+@.+\..+/))return alert("Please enter a valid e-mail address."),!1;b=
b.replace(/[\]\[{}|]/g,encodeURIComponent);return{linkText:a,mailTo:b}}if("External"==this.linkType){d=c("#linkUrl").val();d=d.replace(/[\]\[{}|]/g,encodeURIComponent);if(""==d)return alert("Please enter a URL."),!1;d.match(/^[a-zA-Z0-9.+-]+:\/\//)||(d="http://"+d);return{linkText:a,url:d,targetNew:b}}},validatePageName:function(a){if(a.match(/^\.\.?\s*$/))return c("#linkPageNameError").text("Wiki page names cannot be '.' or '..'.").show(),!1;if(255<a.length)return c("#linkPageNameError").text("Wiki page name cannot be more than 255 characters.").show(),
!1;var b,d,e,f=a.match(ws.common.full_link_regex);f&&(b=f[1],d=f[2],e=f[3]);(a=a.match(ws.common.single_page_regex))&&(e=a[2]);if(!f&&!a)return c("#linkPageNameError").text("To link to a page in another team, use the format 'project/team/page'.").show(),!1;if(b&&b.match(ws.common.projectNameRegex))return c("#linkPageNameError").text("Project names cannot contain: [ ] :").show(),!1;if(d&&d.match(ws.common.teamNameRegex))return c("#linkPageNameError").text("Team names cannot contain: [ ] :").show(),
!1;if(e.match(ws.common.pageNameRegex))return c("#linkPageNameError").text('Wiki page names cannot contain: [ ] : | { } $ + " # @').show(),!1;c("#linkPageNameError").hide();return!0},validateLinkText:function(a){if(a.match(/]]|]$/))return c("#linkTextError").show(),!1;c("#linkTextError").hide();return!0},validateAnchor:function(a){if(a.match(/^[^\]\|]+$/))return c("#linkAnchorError").hide(),!0;c("#linkAnchorError").show();return!1},showInternal:function(){this.linkType="Internal";c("#linkDiv .selected").removeClass("selected");
c("#switchToInternal").addClass("selected");c("#linkDiv .modeRow").hide();c("#linkDiv .internalLink").show();c("#linkTargetNew").prop("disabled",!1);c("#linkTextWiki").focus();c("#linkAnchor").val()?this.showAnchorField():this.hideAnchorField()},showExternal:function(){this.linkType="External";c("#linkDiv .selected").removeClass("selected");c("#switchToExternal").addClass("selected");c("#linkDiv .modeRow").hide();c("#linkDiv .externalLink").show();c("#linkTargetNew").prop("disabled",!1);c("#url").focus()},
showEmail:function(){this.linkType="Email";c("#linkDiv .selected").removeClass("selected");c("#switchToEmail").addClass("selected");c("#linkDiv .modeRow").hide();c("#linkDiv .emailLink").show();c("#linkTargetNew").prop("disabled",!0);c("#linkTextEmail").focus()},showAnchorField:function(){c("#anchorCellOff").hide();c("#anchorCellOn").show()},hideAnchorField:function(){c("#anchorCellOff").show();c("#anchorCellOn").hide()},uiSetup:function(a){var b=this;this.linkType="Internal";c("#switchToInternal").click(function(){b.showInternal()});
c("#switchToExternal").click(function(){b.showExternal()});c("#switchToEmail").click(function(){b.showEmail()});c("#linkWikiAnchor").click(function(){b.showAnchorField();return!1});if(c.browser.msie&&8>parseInt(c.browser.version))c("#linkWikiName").replaceWith("<input id='linkWikiName' type='text'/>"),c("#linkPageName").replaceWith("<input id='linkPageName' type='text'/>");else{var d=function(a){return a.title?ws.common.escapeHtml(a.title):a.text?ws.common.escapeHtml(a.text):""};c("#linkWikiName").select2({placeholder:{title:"Find a wiki",
id:""},createSearchChoice:function(a){a=a.replace(/,/,"");return{id:a,text:a}},ajax:{url:ws.common.pathFor("wiki","autocomplete"),dataType:"text",data:function(a,b){return{q:a,p:b,n:10}},results:function(a){a=_(a.split("\n")).chain().compact().map(function(a){a=a.split("|");return{text:a[1],id:a[0]}}).value();return{results:a,more:10==a.length}}},formatSelection:d,formatResult:d});c("#linkPageName").select2({placeholder:{title:"Find a page, file, or doc",id:""},createSearchChoice:function(a){a=a.replace(/,/,
"");return{id:"page:"+a,text:a}},ajax:{url:ws.common.pathFor("space","autocompletepage"),dataType:"text",data:function(a,b){return{w:c("#linkWikiName").val(),q:a,p:b,n:10}},results:function(a){a=_(a.split("\n")).chain().compact().map(function(a){a=a.split("|");return{text:a[0],id:a[2]+":"+a[0],iconUrl:a[4]}}).value();return{results:a,more:10==a.length}}},formatSelection:ws.select2.formatObject,formatResult:ws.select2.formatObject});c("#linkPageName").change(function(){var a;if(a=c(this).val().match(/^(?:\w+\:)?(.*\/)$/))c(this).select2("open"),
c("#linkPageName").nextAll().find(".select2-search input").focus().val(a[1]).trigger("keyup-change")});c("#linkText").is(":visible")&&(c("#linkPageName").change(function(){var a=c(this).val().match(/(?:\w+\:)?(.*)/)[1];if(a&&(!c("#linkText").val()||b.linkTextFromSelection))c("#linkText").val(a),b.linkTextFromSelection=!0}),c("#linkText").change(function(){b.linkTextFromSelection=!1}))}var e=function(){f.activeEditor.focus();a.close();f.mainEditor.plugins.wsimageoverlay.refreshLinkStatus();return!1};
c("#submitLink").click(function(){var a=null;if(a=b.getValidatedLinkComponents())b.plugin.insertLinkFromComponents(a),e()});c("#removeExistingLink").click(function(){b.plugin.removeLink();e()});c("#linkCloseButton, #cancelLink").click(e)}});f.PluginManager.add("wslinkpopup",wikispaces.popups.Link)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.StylePlugin",{firstTime:!0,init:function(a){var b=this;this.editor=a;a.addCommand("wsStyle",function(){ws.common.track("Editor","Open Style Tool");var d=a.selection;if(c(d.getNode()).closest("pre").length)alert("You cannot apply a style inside of a code block.");else{var e=b.getSelectedSpan(d),d=b.getSelectedDiv(d);f.mainEditor.plugins.wspopup.show("stylePopupContents",{plugin:b,span:e,div:d})}});a.addButton("wsstyle",{title:"Style Text",onclick:function(){f.activeEditor.wsExecCommand("wsStyle")}});
a.onNodeChange.add(function(a,b,f){ws.editor.content.isLoaded&&b.setDisabled("wsstyle",a.wsselection&&a.wsselection.withinCode());b.setActive("wsstyle",0<c(f).closest("span,div,font,strike,s").length)});a.plugins.wscommon.disableUntilLibsLoad(a,"wsstyle")},getInfo:function(){return{longname:"Wikispaces style",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},applyStyle:function(){ws.common.track("Editor","Apply Style");var a=c(document.styleForm.styleText).val(),
b=f.activeEditor;b.wsselection.restore();if(b.selection.isCollapsed()){var d=c(b.selection.getNode()).closest("span").get(0);if(d){b.selection.setContent('<span id="splitter">\ufeff</span>');var e=c("#splitter",b.getDoc()).removeAttr("id").get(0);b.dom.split(d,e);b.selection.select(e,!0);f.isWebKit||(b.selection.collapse(),c(e).remove())}}else this.removeStyle();d=b.dom.parseStyle(a);d["text-align"]&&"auto"!=d["text-align"]?(a=c(b.selection.getNode()).closest("div,p,td,th,li,h1,h2,h3,h4,h5,h6"),a.length&&
(a.is("div")||(e=b.selection.getBookmark(),div=c("<div>",b.getDoc()),a.wrapInner("<div>"),a=a.children("div").eq(0),b.selection.moveToBookmark(e)),a.css("text-align",d["text-align"]),delete d.display,delete d["text-align"])):(!d["text-align"]||"auto"==d["text-align"])&&c(b.selection.getNode()).closest("div,p,td,th,li,h1,h2,h3,h4,h5,h6").css("text-align","");var a="",g;for(g in d)a+=g+": "+d[g]+";\n";if(a){if(b.selection.isCollapsed()&&f.isIE)return this.applyCaretStyleIE(b,a);b.formatter.register("ws_style",
{inline:"span",styles:d});b.formatter.apply("ws_style")}},applyCaretStyleIE:function(a,b){var d=a.dom.uniqueId(),e=a.getDoc(),f=e.selection.createRange();a.selection.setContent(c("<div>").append(c("<span>").attr("style",b).attr("id",d).text("\ufeff")).html());f.moveToElementText(c("#"+d,e)[0]);f.select()},removeStyle:function(){var a=f.activeEditor;a.wsselection.restore(!0);a.execCommand("RemoveFormat");a.nodeChanged()},setSpanText:function(a){if(a&&(a=c(a).attr("style"))){var b=this;document.styleForm.removeStyleButton.disabled=
!1;c.each(f.activeEditor.dom.parseStyle(a),function(a,c){"function"!=typeof c&&b.setSpanTextValue(a,c)})}},setSpanTextValue:function(a,b){var d=ws.common.normalizeCssSelector(a);ws.common.log("setting "+a+" as "+d+" with "+b);switch(d){case "fontSize":c(document.styleForm.styleSize).val(b);break;case "fontFamily":d=b.replace(/,\s*/gi,", ");c(document.styleForm.styleFont).val(d);break;case "color":d=(new RGBColor(b)).toHex().toUpperCase();c(document.styleForm.styleColor).val(d);c.farbtastic("#colorpickerColor").setColor(d);
break;case "backgroundColor":d=(new RGBColor(b)).toHex().toUpperCase();c(document.styleForm.styleBackgroundColor).val(d);c.farbtastic("#colorpickerBackgroundColor").setColor(d);break;case "textAlign":c(document.styleForm.styleAlignment).val(b);break;case "verticalAlign":c(document.styleForm.styleVertical).val(b);c(document.styleForm.styleVertical).val()!=b&&(d=c("<option>").val(b).html(b),c(document.styleForm.styleVertical).append(d),c(document.styleForm.styleVertical).val(b));break;case "textDecoration":("line-through"==
b||"lineThrough"==b)&&c(document.styleForm.styleStrike).prop("checked",!0);break;case "accelerator":case "csstext":case "cssText":break;default:c(document.styleForm.styleText).val(c(document.styleForm.styleText).val()+"\n"+a+": "+b+";")}},getUsedColors:function(){var a=[];c.each(f.editors,function(){c(this.dom.select("span,div")).each(function(){var b=c(this);b.css("color")&&"transparent"!=b.css("color")&&(a[a.length]=(new RGBColor(b.css("color"))).toHex().toUpperCase());b.css("backgroundColor")&&
"transparent"!=b.css("backgroundColor")&&(a[a.length]=(new RGBColor(b.css("backgroundColor"))).toHex().toUpperCase())})});return a},getSelectedDiv:function(a){a.getRng(!0).cloneContents();var b=null;return b=c(a.getNode()).closest("div").get(0)},getSelectedSpan:function(a){for(var b=a.getRng(!0).cloneContents(),d=null,e=0;e<b.childNodes.length;++e){var g=b.childNodes[e];if(!(3==g.nodeType&&(""==g.nodeValue||"\ufeff"==g.nodeValue))){if(1!=g.nodeType||d){d=null;break}d=g}}d||(d=c(a.getNode()).closest("span,font,strike,s").get(0));
d&&d.nodeName.toLowerCase().match(/^(font|strike|s)$/)&&(a=d.nodeName.toLowerCase(),"s"==a&&(a="strike"),b=f.explode(f.settings.font_size_style_values),b={font:{backgroundColor:d.style.backgroundColor,color:d.color,fontFamily:d.face,fontSize:b[parseInt(d.size)-1]},strike:{textDecoration:"line-through"}},this.editor.wsselection.restore(),this.editor.wsselection.save(),a=this.editor.dom.create("span",{style:b[a]}),this.editor.dom.replace(a,d,1),this.editor.wsselection.restore(!0),d=a);return d}});f.PluginManager.add("wsstyle",
wikispaces.plugins.StylePlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.WidgetPlugin",{init:function(a){var b=this;b.editor=a;a.addCommand("wsWidget",function(){b.openWidget()});a.addButton("wswidget",{title:"Embed Widget",label:"Widget",onclick:function(){f.activeEditor.wsExecCommand("wsWidget")}});a.onNodeChange.add(function(a,c,g){"visual"!=a.plugins.wscommon.getOption("mode")?a.theme.controlManager().setActive("wswidget",!1):(a.theme.controlManager().setDisabled("wswidget",a.plugins.wscommon.isCommentEditor()),c=b.findWidgetPlaceholder(g),
a.theme.controlManager().setActive("wswidget",!!c),c?f.mainEditor.plugins.wswidgetoverlay.show(a,c):f.mainEditor.plugins.wswidgetoverlay.hide())});a.onDblClick.add(function(a,c){var f=null;(f=b.findWidgetPlaceholder(c.target))&&b.openWidget(f)});a.onKeyPress.addToTop(function(a,b){if(13==b.keyCode){var g=a.selection.getNode(),g=c(g).closest("pre,code");if(g.length){var h=!1;f.isWebKit?("\n"!=g.text().substr(-1)&&(h=!0),a.selection.setContent('\n<span id="wsHold"></span>')):a.selection.setContent('<br/><span id="wsHold">\ufeff</span>');
a.plugins.wscommon.cursorToAndRemoveElement(c("#wsHold",a.getDoc()).get(0));h&&"\n"==g.text().substr(-1)&&(a.selection.setContent('\n<span id="wsHold"></span>'),a.plugins.wscommon.cursorToAndRemoveElement(c("#wsHold",a.getDoc()).get(0)));b.preventDefault();b.stopPropagation();return!1}}});a.plugins.wscommon.disableUntilLibsLoad(a,"wswidget")},getInfo:function(){return{longname:"Wikispaces widgets",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},
openWidget:function(a){a||(a=this.findWidgetPlaceholder(this.editor.selection.getNode()));if(!c(a).is(".WikiMediaToc, .WikiMediaTocFlat")){var b="",b=c(a).is(".WikiAnchor")?"#"+c(a).attr("id").match(/@@([^@]+)$/)[1]:c(a).attr("id");this.selectedPlaceholder=a;ws.common.track("Editor","Open Media Tool");f.mainEditor.plugins.wspopup.show("mediaTool",{plugin:this,mediaString:b})}},insertWidget:function(a,b){ws.common.track("Editor","Add Media",b);if(this.selectedPlaceholder){var d=c(a).attr({style:c(this.selectedPlaceholder).attr("style"),
align:c(this.selectedPlaceholder).attr("align")});c(this.selectedPlaceholder).replaceWith(d);f.mainEditor.plugins.wswidgetoverlay.hide()}else this.editor.wsselection.setContent(a)},findWidgetPlaceholder:function(a){return c(a).is("img.WikiMedia")&&!c(a).hasClass("WikiMediaFile")||c(a).hasClass("WikiAnchor")?a:null},insertCharacter:function(a){ws.common.track("Editor","Add Character",a);f.activeEditor.wsselection.setContent(a)},insertToc:function(a){ws.common.track("Editor","Insert Toc",a);a?f.activeEditor.wsselection.setContent('<img id="wikitext@@toc@@flat" class="NewWikiMedia WikiMedia WikiMediaTocFlat" title="Table of Contents" src="'+
window.location.protocol+"//www."+wikispaces_domain+'/site/embedthumbnail/toc/flat?w=100&h=16"/>',"h1,h2,h3,h4,h5,h6"):f.activeEditor.wsselection.setContent('<img id="wikitext@@toc@@normal" class="NewWikiMedia WikiMedia WikiMediaToc" title="Table of Contents" src="'+window.location.protocol+"//www."+wikispaces_domain+'/site/embedthumbnail/toc/normal?w=225&h=100"/>',"h1,h2,h3,h4,h5,h6")},insertReference:function(){var a=f.mainEditor.plugins.wsreference.insertReferenceAtSelection();f.mainEditor.focus();
setTimeout(function(){c.scrollTo(a.getContentAreaContainer(),{axis:"y",duration:500});a.focus();a.wsselection.selectAll()},100)},insertReferences:function(){ws.common.track("Editor","Insert References");f.mainEditor.wsselection.setContent("\n&lt;references/&gt;")},insertCode:function(){var a=f.activeEditor,b=a.dom.encode(document.codeMediaForm.code.value),b=b.replace(/\r\n|\n|\r/g,"<br/>"),d=a.dom.encode(document.codeMediaForm.format.value);d||(d="text");ws.common.track("Editor","Add Code",d);a.wsselection.setContent('<pre id="wsTempPre" class="'+
d+'">'+b+"</pre><br/>");b=c("#wsTempPre",a.getDoc());d=b.closest("p,div,h1,h2,h3,h4,h5,h6");d.length&&a.dom.split(d.get(0),b.get(0));b=c("#wsTempPre",a.getDoc());b.nextAll("p,div,h1,h2,h3,h4,h5,h6").length&&(a.selection.select(b.nextAll("p,div,h1,h2,h3,h4,h5,h6").get(0),!0),a.selection.collapse(!0));b.removeAttr("id");document.codeMediaForm.reset();a.onNeedsResize.dispatch()},insertAnchor:function(a){var b=c("<div>").text(a).html(),b=b.replace(/"/g,"&quot;");f.activeEditor.wsselection.setContent('<img src="/i/anchor.gif" class="WikiAnchor"  alt="Anchor"  id="wikitext@@anchor@@'+
b+'" title="Anchor: '+b+'"/>');ws.common.track("Editor","Add Anchor",a);return!0}});f.PluginManager.add("wswidget",wikispaces.plugins.WidgetPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.PreviewPlugin",{init:function(a){this.editor=a;var b=this;a.addCommand("preview",function(){b.showPreview()});a.addCommand("endPreview",function(){b.hidePreview()});a.onModeSwitch.add(function(){c("#previewBox").length&&b.hidePreview()})},getInfo:function(){return{longname:"Wikispaces preview",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},showPreview:function(){var a=this;this.getPreviewData(this.editor.plugins.wscommon.fullContent(!0,
"empty"),this.editor.plugins.wscommon.getOption("mode"),function(b){a.hideEditor();b=c("<div></div>").attr("id","previewBox").addClass("wiki editorLayer").css({width:"100%",position:"relative"}).html(b);c(a.editor.getContainer()).append(b);a.editor.theme.showToolSet("preview");WikispacesCommentManager.hideAll();a.commentSpaces=WikispacesCommentManager.preemptSpaces();WikispacesCommentManager.readOnly=!0;a.previewSpace=new WikispacesCommentSpace(b,"#wsMainEditor_container","#wsMainEditor_container")})},
hidePreview:function(){c("#previewBox").remove();this.editor.theme.showToolSet();c(".mceToolbar.spinner").remove();c(".mceToolbar").show();this.showEditor();WikispacesCommentManager.removeSpace(this.previewSpace);WikispacesCommentManager.restoreSpaces(this.commentSpaces);WikispacesCommentManager.readOnly=!1;"visual"==this.editor.plugins.wscommon.getOption("mode")?(WikispacesCommentManager.redrawAll(!0),WikispacesCommentManager.forceWidth()):WikispacesCommentManager.hideAll()},getPreviewData:function(a,
b,d){var e=this,f=c("<div></div>").attr("id","previewSpinner").addClass("wikispaces_content").addClass("mceToolbar spinner").css({textAlign:"center"}).html('Loading Preview <img src="/i/spinner.gif" alt="" width="18" height="18" style="padding-top: 9px; vertical-align: -4px;"/>');c(".mceToolbar").hide();c(e.editor.plugins.wscommon.editorToolbar()).append(f);c.ajax({url:ws.common.pathFor("page","preview",wikispaces_page),type:"POST",async:!0,cache:!1,data:{content:a,mode:b},dataType:"xml",global:!1,
error:function(){ws.session.reloadSession(function(){e.showPreview()},3E3,function(){e.editor.plugins.wscommon.sessionReloadFailed();c(".mceToolbar.spinner").remove();c(".mceToolbar").show()})},success:function(a){ws.common.log("showPreviewResponse",a);ws.session.reloadSessionSuccess();a=c(a);a.find("preview").length&&d(a.find("preview").text());c(".mceToolbar.spinner").remove();c(".mceToolbar").show();a.find("preview").length||(a.find("error").length?(a=a.find("error").attr("message"),alert(a)):
alert("An unexpected error occurred."))}})},hideEditor:function(){this.bookmark=null;try{this.bookmark=this.editor.selection.getBookmark(2)}catch(a){}c(".WikiOverlay").hide();this.frameHeight=c(this.editor.plugins.wscommon.editorIFrame()).height();c(this.editor.getContentAreaContainer()).hide();c("#referenceEditors").hide()},showEditor:function(){c(this.editor.getContentAreaContainer()).show();c(this.editor.plugins.wscommon.editorIFrame()).height(this.frameHeight);c("#referenceEditors").show();var a=
this;setTimeout(function(){try{a.bookmark&&a.editor.selection.moveToBookmark(a.bookmark)}catch(b){}a.editor.focus();a.editor.wsselection.ensureCursor()},100)}});f.PluginManager.add("wspreview",wikispaces.plugins.PreviewPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.popups.Table",{plugin:null,init:function(a){var b=this;a.plugins.wspopup.register({wsname:"tablePopupContents",title:"Insert Table",width:280,height:100,wsselection:0,onShow:function(a){b.onShow(a)},uiSetup:function(a){b.uiSetup(a)}})},setPlugin:function(a){this.plugin=a},onShow:function(a){this.setPlugin(a.plugin)},uiSetup:function(a){var b=this;c("#addTableButton").click(function(){b.plugin.addTable(document.insertTableForm.rows.value,document.insertTableForm.cols.value);
a.close()});c("#tableCancelLink").click(function(){a.close();return!1});c("#tableCloseButton").click(function(){a.close();return!1})}});f.PluginManager.add("wstablepopup",wikispaces.popups.Table)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.CommentPlugin",{popup:null,init:function(a){this.editor=a;WikispacesCommentManager.clear();WikispacesCommentManager.readOnly=!1;a.addButton("wscomment",{title:"Add Comment",label:"Comment",onclick:function(){f.activeEditor.wsExecCommand("wsComment")}});a.onInit.add(function(){_.defer(function(){WikispacesCommentManager.showAll()});_.delay(function(){WikispacesCommentManager.redrawAll()},1E3);_.delay(function(){WikispacesCommentManager.redrawAll()},3E3)});
a.onModeSwitch.add(function(a){"visual"==a?_.defer(function(){WikispacesCommentManager.showAll()}):"plain"==a&&WikispacesCommentManager.hideAll()})},getInfo:function(){return{longname:"Wikispaces comment",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},isAutoSaveComments:function(a){return _(a).any(function(a){return _.isString(a)})},loadComments:function(a){this.isAutoSaveComments(a)?WikispacesCommentManager.retrieveData(function(){_(a).each(function(a,
c){var e=WikispacesCommentManager.commentById(c);if(e){var f=new WikispacesCommentReply(a);e.addReply(f);_.defer(function(){f.compose()})}else e=new WikispacesComment(a,c),WikispacesCommentManager.addComment(e),_.defer(function(){e.compose()})})}):WikispacesCommentManager.load(a)},newComments:function(){var a={};c(WikispacesCommentManager.flatComments()).each(function(){this.unsaved()&&(a[this.commentId]=this.body())});return a},markCommentsSaved:function(){WikispacesCommentManager.markCommentsSaved()}});
f.PluginManager.add("wscomment",wikispaces.plugins.CommentPlugin)})(tinymce,jQuery);
(function(f){var c=f.DOM;f.create("wikispaces.themes.WikispacesTheme",{init:function(a){var b=this;b.editor=a;var c=["Bold","Italic","Underline","InsertUnorderedList","InsertOrderedList"];a.onInit.add(function(){for(var e=49;57>=e;e++)delete a.shortcuts["ctrl,,,"+e];a.plugins.wscommon.resizeToolbar();jQuery(window).resize(function(){a.plugins.wscommon.resizeToolbar()});_.delay(function(){jQuery(window).scrollLeft(0)},1E3);a.onNodeChange.add(function(a,e,g){"visual"==a.plugins.wscommon.getOption("mode")&&
(f.each(c,function(c){b.controlManager().get(c.toLowerCase()).setDisabled(a.wsselection&&a.wsselection.withinCode());b.controlManager().get(c.toLowerCase()).setActive(a.queryCommandState(c))}),e=b.getHeaderParent(g),b.controlManager().get("formatlistbox").select(e?e.nodeName.toLowerCase():"p"));b.controlManager().get("insertunorderedlist").isActive()&&b.controlManager().get("insertorderedlist").isActive()&&(jQuery(g).closest("ul,ol").is("ul")?b.controlManager().get("insertorderedlist").setActive(!1):
b.controlManager().get("insertunorderedlist").setActive(!1))});"plain"==a.plugins.wscommon.getOption("mode")&&a.plugins.wstext?(a.plugins.wstext.flipToText(jQuery("#wsMainEditor").val()),ws.common.track("Editor","Start","Text")):ws.common.track("Editor","Start","Visual");"wsMainEditor"==a.id&&jQuery("#wsMainEditor_container .mceIframeContainer").click(function(){var b=jQuery("<span>",a.getDoc()).appendTo(f.mainEditor.getBody());f.mainEditor.plugins.wscommon.cursorToAndRemoveElement(b);jQuery(".WikiOverlay").hide()});
f.isIE&&a.dom.bind(a.getDoc(),"controlselect",function(b){jQuery(b.srcElement).is("img,pre")&&a.onClick.dispatch(a,b)})});var e=!1;a.onPaste.add(function(a){a.onChange.dispatch()});a.onKeyDown.add(function(a,b){if(!b.ctrlKey&&!b.altKey&&("9"==b.keyCode&&(b.preventDefault(),b.stopPropagation()),8==b.keyCode||46==b.keyCode))e=!a.selection.isCollapsed()});a.onKeyUp.add(function(a,b){(8==b.keyCode||46==b.keyCode)&&e&&a.undoManager.add()});f.isWebKit&&a.onKeyUp.add(function(a,b){if((8==b.keyCode||46==
b.keyCode)&&e&&""==jQuery.trim(jQuery(a.getBody()).text())&&a.dom.isBlock(jQuery(a.getBody()).children().get(0))){a.undoManager.begin();jQuery(a.getDoc().body).children().remove();var c=jQuery("<span>",a.getDoc()).appendTo(a.getDoc().body).after("<br/>");a.plugins.wscommon.cursorToAndRemoveElement(c);a.undoManager.end();a.undoManager.remove()}});a.onActivate.add(function(a){b.controlManager().editor=a;jQuery(a.getContentAreaContainer()).addClass("active_editor")});a.onDeactivate.add(function(a){a.initialized&&
(jQuery(a.getContainer()).is(":visible")&&a.selection.collapse(),jQuery(a.getContentAreaContainer()).removeClass("active_editor"))});a.onModeSwitch=new f.util.Dispatcher(a);a.onModeSwitch.add(function(a){f.each(c,function(a){b.controlManager().get(a.toLowerCase()).setActive(!1)});"plain"==a?jQuery("#switchEditorModes span.mceText").text("Visual Editor").attr("title","Visual Editor"):jQuery("#switchEditorModes span.mceText").text("WikiText Editor").attr("title","WikiText Editor");b.showToolSet()});
a.setClean=function(){this.startContent=f.trim(this.getContent({format:"raw",no_events:1}))};a.addCommand("wsInsertHorizontalRule",function(){f.isWebKit?a.execCommand("InsertHtml",!1,"<hr>"):a.execCommand("InsertHorizontalRule")});a.wsExecCommand=function(b,c,d,e){switch(b){case "Bold":case "Italic":case "Underline":case "wsFormatBlock":case "wsInsertHorizontalRule":case "wsInsertOrderedList":case "wsInsertUnorderedList":"plain"!=a.plugins.wscommon.getOption("mode")&&a.undoManager.add()}switch(b){case "Bold":case "Italic":case "Underline":case "wsFormatBlock":case "wsInsertHorizontalRule":case "wsInsertOrderedList":case "wsInsertUnorderedList":case "wslink":case "wsimage":case "wsTable":case "wsWidget":case "wsStyle":case "preview":case "endPreview":if("plain"==
a.plugins.wscommon.getOption("mode")){this.execCommand(b+"Text",c,d,e);break}default:this.execCommand(b,c,d,e)}}},controlManager:function(){return f.mainEditor.controlManager},getHeaderParent:function(a){a=this.editor.dom.getParents(a);for(i=0;i<a.length;i++)if(a[i].nodeName.toLowerCase().match(/h\d/))return a[i]},showToolSet:function(a){var b=jQuery("#wsMainEditor_tools1 td > *:first-child");switch(a){case "preview":b.css("visibility","hidden");jQuery("#wsMainEditor_wssave_action").css("visibility",
"visible");jQuery("#wsMainEditor_wssave_open").css("visibility","visible");jQuery("#wsMainEditor_wsendpreview").css("visibility","visible");jQuery("#wsMainEditor_wsendpreview").css(jQuery.browser.msie&&8<=jQuery.browser.version?{left:-60,top:7}:{right:170,top:28});jQuery.browser.webkit&&jQuery("#wsMainEditor_wsendpreview").parent().css("position","");break;default:b.css("visibility","visible"),jQuery("#wsMainEditor_wsendpreview").css("visibility","hidden"),"plain"==this.editor.plugins.wscommon.getOption("mode")&&
(jQuery("#wsMainEditor_wscomment").css("visibility","hidden"),jQuery("#wsMainEditor_undo").css("visibility","hidden"),jQuery("#wsMainEditor_redo").css("visibility","hidden")),wikispaces_can_discuss||jQuery("#wsMainEditor_wscomment").css("visibility","hidden")}},renderUI:function(a){var b=this,d=b.editor,e=d.controlManager,g=c.insertAfter(c.create("div",{id:d.id+"_container","class":"mceEditor "+d.settings.skin+"Skin"}),a.targetNode),h=c.add(g,"div",{id:d.id+"_external","class":"mceExternalToolbar toolbarLayer"});
c.insertAfter(c.create("div",{id:d.id+"_overlay","class":"wsPopupModalBlocker blockerLayer",style:"display: block !important; "}),a.targetNode);b.toolbar=e.createToolbar("tools1");b.toolbar.add(e.createButton("bold",{title:"Bold",onclick:function(){f.activeEditor.wsExecCommand("Bold");ws.common.track("Editor","Bold")}}));b.toolbar.add(e.createButton("italic",{title:"Italic",onclick:function(){f.activeEditor.wsExecCommand("Italic");ws.common.track("Editor","Italic")}}));b.toolbar.add(e.createButton("underline",
{title:"Underline",onclick:function(){f.activeEditor.wsExecCommand("Underline");ws.common.track("Editor","Underline")}}));b.toolbar.add(e.createControl("wsstyle"));b.toolbar.add(e.createSeparator());var k=e.createListBox("formatlistbox",{title:"Format",onselect:function(a){f.activeEditor.wsExecCommand("wsFormatBlock",!1,a);ws.common.track("Editor","Select Font",a);jQuery("#wsMainEditor_formatlistbox").removeClass("mceListBoxSelected")}});k.onRenderMenu.add(function(a,b){b.onShowMenu.add(function(){f.activeEditor.wsselection.save(2);
if(!b.alreadyRendered){b.alreadyRendered=!0;var a=function(a){if(document.defaultView&&document.defaultView.getComputedStyle)return document.defaultView.getComputedStyle(a,"");if(a.currentStyle)return a.currentStyle},c=function(a,b,c){if(document.defaultView&&document.defaultView.getComputedStyle)for(var d=0;d<b.length;d++){var e=b[d],f=b.getPropertyValue(e),g=a.getPropertyValue(e);f&&f!=g&&jQuery(c).css(e,f)}else for(e in b)e=e.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),f=b[e],g=a[e],
f&&f!=g&&jQuery(c).css(e,f)};jQuery(document.body).append('<div class="wiki" style="display: none;" id="styleHolder"><h1>h1</h1><h2>h2</h2><h3>h3</h3><h4>h4</h4><h5>h5</h5><h6>h6</h6><span>span</span></div>');jQuery("#styleHolder").children().each(function(){var b;b="span"==this.nodeName.toLowerCase()?jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu .toolbar_formatmenu_normal .mceText"):jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu .toolbar_formatmenu_"+this.nodeName.toLowerCase()+
" .mceText");var d=a(jQuery("#styleHolder").get(0)),e=a(this);c(d,e,b.get(0));b.css("white-space","nowrap")})}});b.onHideMenu.add(function(){f.activeEditor.wsselection.restore();setTimeout(function(){f.activeEditor.focus()},100)});b.settings.max_height=185});k.add("Heading 1","h1",{"class":"toolbar_formatmenu_h1"});k.add("Heading 2","h2",{"class":"toolbar_formatmenu_h2"});k.add("Heading 3","h3",{"class":"toolbar_formatmenu_h3"});k.add("Heading 4","h4",{"class":"toolbar_formatmenu_h4"});k.add("Heading 5",
"h5",{"class":"toolbar_formatmenu_h5"});k.add("Heading 6","h6",{"class":"toolbar_formatmenu_h6"});k.add("Normal","p",{"class":"toolbar_formatmenu_normal"});b.toolbar.add(k);k.originalShow=k.showMenu;k.showMenu=function(){var a=jQuery(window).scrollTop();k.originalShow();jQuery(window).scrollTop(a);jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu tr.mceFirst td").css("height",0);jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu tr.mceFirst td a").html("").css({position:"relative",
height:0,padding:0});jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu_co").css("height","auto").css("width","auto");jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu").css({borderBottom:"1px solid #d4d0c9",borderRight:"1px solid #d4d0c9"}).appendTo(document.body);d.plugins.wstoolbarscroll.moveScroller();a=f.DOM.select("a","menu_"+k.menu.id)[1];jQuery(a).is(":visible")&&a.focus();k.menu._focusIdx=1};b.toolbar.add(e.createSeparator());b.toolbar.add(e.createButton("insertorderedlist",
{title:"Numbered List",onclick:function(){f.activeEditor.wsExecCommand("wsInsertOrderedList");ws.common.track("Editor","Add Ordered List")}}));b.toolbar.add(e.createButton("insertunorderedlist",{title:"Bulleted List",onclick:function(){f.activeEditor.wsExecCommand("wsInsertUnorderedList");ws.common.track("Editor","Add Unordered List")}}));b.toolbar.add(e.createButton("hr",{title:"Insert Horizontal Rule",onclick:function(){f.activeEditor.wsExecCommand("wsInsertHorizontalRule");ws.common.track("Editor",
"Add Horizontal Rule")}}));b.toolbar.add(e.createSeparator());b.toolbar.add(e.createControl("wslink"));b.toolbar.add(e.createControl("wsimage"));b.toolbar.add(e.createControl("wswidget"));b.toolbar.add(e.createControl("wstable"));b.toolbar.add(e.createControl("wscomment"));b.toolbar.add(e.createSeparator());b.toolbar.add(e.createButton("undo",{title:"Undo",onclick:function(){f.activeEditor.wsExecCommand("Undo");ws.common.track("Editor","Undo")}}));b.toolbar.add(e.createButton("redo",{title:"Redo",
onclick:function(){f.activeEditor.wsExecCommand("Redo");ws.common.track("Editor","Redo")}}));b.toolbar.add(e.createSeparator());b.toolbar.add(e.createButton("wspreview",{title:"Preview",label:"Preview","class":"btn",onclick:function(){f.mainEditor.wsExecCommand("preview",!1,!1,{skip_undo:!0});ws.common.track("Editor","Preview")}}));b.toolbar.add(e.createButton("wsendpreview",{title:"Continue Editing",label:"Continue Editing","class":"btn continueBtn",onclick:function(){f.mainEditor.wsExecCommand("endPreview",
!1,!1,{skip_undo:!0})}}));b.toolbar.add(e.createControl("wscancel"));var l=e.createControl("wssave");b.toolbar.add(l);b.toolbar.renderTo(h);jQuery("#pageEditor").addClass("defaultSkin");jQuery("#wsMainEditor_external").prependTo("#pageEditor");jQuery(h).find(".btn span.mceButtonLabel").wrap("<span />");jQuery(h).find(".btn.mceSplitButton span.mceSplitButtonLabel").wrap("<span />");jQuery(h).find(".btn.mceSplitButton span.mceOpen").removeClass("btn").wrap("<span />");jQuery.browser.msie&&"8.0"<=jQuery.browser.version&&
jQuery(h).find(".btn.mceSplitButton span.mceOpen").html("&zwj;");jQuery(h).find(".btn.mceAction").addClass("pill-l");jQuery(h).find(".btn.mceOpen").addClass("pill-r");jQuery("#wsMainEditor_formatlistbox_open").click(function(){return!1}).bind("mousedown",function(){k.showMenu();return!1});b.preventMenuClose=!1;jQuery("#menu_wsMainEditor_wsMainEditor_wssave_menu").live("mouseover",function(){b.preventMenuClose=!0;jQuery("#menu_wsMainEditor_wsMainEditor_wssave_menu").die("mouseover");jQuery(this).hover(function(){return b.preventMenuClose=
!0},function(){b.preventMenuClose=!1;setTimeout(function(){b.preventMenuClose||l.hideMenu()},500);return!0})});jQuery(h).find("#wsMainEditor_wssave .btn.mceOpen").click(function(a){b.preventMenuClose=!b.preventMenuClose;l.showMenu();a.preventDefault();return!1});jQuery(h).find("#wsMainEditor_wssave .btn.mceOpen").hoverIntent({sensitivity:3,interval:200,over:function(){l.showMenu()},timeout:500,out:function(){b.preventMenuClose||l.hideMenu()}});jQuery(h).prepend('<table style="width: 100%; border-collapse: collapse; background: transparent;" ><tr style="height: 21px;"><td style="width:10px; background: url(/i/window-bar-nl.png) no-repeat left bottom; padding: 0;"><img src="/i/c.gif" width="10" height="21" alt="" /></td><td style="width:75%; background: url(/i/window-bar-n.png) repeat-x left bottom; padding: 0;"></td><td style="width:23px; background: url(/i/window-bar-yl.png) no-repeat left bottom; padding: 0;"><img src="/i/c.gif" width="23" height="21" alt="" /></td><td style="width:25%; background: url(/i/window-bar-m.png) repeat-x left bottom; padding: 0; text-align: right;"><span id="autosaveStatus"></span></td><td style="width:10px; background: url(/i/window-bar-mr.png) no-repeat left bottom; padding: 0;"><img src="/i/c.gif" width="10" height="21" alt="" /></td></tr></table>');
jQuery("#wsMainEditor_external").css({MozUserSelect:"none",KhtmlUserSelect:"None",cursor:"default"}).bind("selectstart",function(){return!1});a=c.add(g,"div",{"class":"mceIframeContainer editorLayer active_editor",style:"position: relative;"});g=c.add(g,"div",{style:"display: none;"});return{iframeContainer:a,editorContainer:d.id+"_container",sizeContainer:g,deltaHeight:0}},getInfo:function(){return{longname:"Wikispaces theme",author:"Tangient LLC",authorurl:"http://wikispaces.com",version:"0.1"}}});
f.ThemeManager.add("wikispaces",wikispaces.themes.WikispacesTheme)})(tinymce);
(function(f){f.create("wikispaces.plugins.ImageTextPlugin:wikispaces.plugins.ImagePlugin",{init:function(c){var a=this;this.editor=c;c.addCommand("wsimageText",function(){f.mainEditor.plugins.wspopup.show("imageTool",{plugin:a})})},getInfo:function(){return{longname:"Wikispaces image text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},insertImageInEditorCallback:function(c,a,b,d,e,f,h){(e=f)&&this.isLocalContext(f)&&(e="");"audio"==b||"video"==
b?this.editor.wsselection.setContent('[[media type="'+c+'" key="'+e+a+'"]]'):(f="","image"==b&&800<h.width&&(f=' width="800" height="'+Math.floor(800/h.width*h.height)+'"'),"image"==b&&(c="image"),this.editor.wsselection.setContent("[["+c+":"+(d?d:e+a)+f+"]]"))}});f.PluginManager.add("wsimagetext",wikispaces.plugins.ImageTextPlugin)})(tinymce);
(function(f){f.create("wikispaces.plugins.WidgetTextPlugin:wikispaces.plugins.WidgetPlugin",{init:function(c){var a=this;this.editor=c;c.addCommand("wsWidgetText",function(){ws.common.track("Editor","Open Media Tool");var b="";c.plugins.wstext.expandSelectionToTag("[[","media","]]")?b="wikitext@@media@@"+c.plugins.wstext.getSelectedText().match(/\[\[media (.*)\]\]/)[1]:c.plugins.wstext.expandSelectionToTag("[[","rss","]]")?b="wikitext@@rss@@"+c.plugins.wstext.getSelectedText().match(/\[\[rss (.*)\]\]/)[1]:
c.plugins.wstext.expandSelectionToTag("[[","","]]")&&(b=c.plugins.wstext.getSelectedText().match(/^\[\[(#.+)\]\]/)[1]);f.mainEditor.plugins.wspopup.show("mediaTool",{plugin:a,mediaString:b})})},getInfo:function(){return{longname:"Wikispaces widgets text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},insertWidget:function(c,a){ws.common.track("Editor","Add Media",a);this.editor.wsselection.setContent(c)},insertCharacter:function(c,a){ws.common.track("Editor",
"Add Character",c);this.editor.wsselection.setContent(a)},insertReference:function(){ws.common.track("Editor","Insert Reference");this.editor.wsselection.setContent("<ref></ref>")},insertReferences:function(){ws.common.track("Editor","Insert References");this.editor.wsselection.setContent("\n<references/>")},insertToc:function(c){ws.common.track("Editor","Insert Toc",c);c?this.editor.wsselection.setContent("\n[[toc|flat]]"):this.editor.wsselection.setContent("\n[[toc]]")},insertCode:function(c,a){a||
(a="text");ws.common.track("Editor","Add Code",a);this.editor.wsselection.setContent('\n[[code format="'+a+'"]]\n'+c+"\n[[code]]\n")},insertAnchor:function(c){ws.common.track("Editor","Add Anchor",c);this.editor.wsselection.setContent("[[#"+c+"]]");return!0}});f.PluginManager.add("wswidgettext",wikispaces.plugins.WidgetTextPlugin)})(tinymce);
(function(f){f.create("wikispaces.plugins.TableTextPlugin:wikispaces.plugins.TablePlugin",{init:function(c){var a=this;this.editor=c;c.addCommand("wsTableText",function(){f.mainEditor.plugins.wspopup.show("tablePopupContents",{plugin:a})})},getInfo:function(){return{longname:"Wikispaces table text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},addTable:function(c,a){ws.common.track("Editor","Add Table",c+"x"+a);for(var b="",d=0;d<c;d++){b+=
"\n||";for(cols=0;cols<a;cols++)b+=" ||"}this.editor.wsselection.setContent(b+"\n")}});f.PluginManager.add("wstabletext",wikispaces.plugins.TableTextPlugin)})(tinymce);
(function(f,c){f.create("wikispaces.plugins.WidgetOverlay:wikispaces.plugins.ImageOverlay",{getInfo:function(){return{longname:"Wikispaces widget overlay",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},init:function(a,b){var c=this;a.onInit.add(function(a){var b=function(a){a.onClick.add(function(a,b){var e=a.plugins.wswidget.findWidgetPlaceholder(b.target);e?c.show(a,e):c.hide()})};a.onInitSubEditor.add(b);b(a)});this.overlayInit(a,b)},show:function(a,
b){this.parent(a,b);if(c(b).hasClass("WikiAnchor")){var d=c(b).attr("id").match(/@@([^@]+)$/)[1];c("#mediaAnchorName").text(ws.common.truncify(d,40));c("#mediaEdit").show();c("#mediaAppearance").hide();c("#mediaAnchorNameSection").show()}else c(b).is(".WikiMediaToc, .WikiMediaTocFlat")?(c("#mediaEdit").hide(),c("#mediaAppearance").hide()):c(b).is(".WikiMediaRss, .WikiMediaInclude")?(c("#mediaEdit").show(),c("#mediaAppearance").hide()):(c("#mediaEdit").show(),c("#mediaAppearance").show()),c("#mediaAnchorNameSection").hide();
this.repositionAndShow()},overlayContent:function(){return ws.editor.content.loadContent("mediaProperties")},refreshAlignment:function(){c("#mediaAlign a").removeClass("buttonSelected");switch(this.currentAlignment()){case "left":c("#mediaAlignLeft").addClass("buttonSelected");break;case "center":c("#mediaAlignCenter").addClass("buttonSelected");break;case "right":c("#mediaAlignRight").addClass("buttonSelected")}},setup:function(){var a=this;c("#mediaAlignLeft").click(function(){a.setImageAlignment("left");
return!1});c("#mediaAlignCenter").click(function(){a.setImageAlignment("center");return!1});c("#mediaAlignRight").click(function(){a.setImageAlignment("right");return!1});c("#mediaAlignNone").click(function(){a.setImageAlignment("");return!1});c("#mediaSizeDown").click(function(){a.adjustImageSize(-0.1);return!1});c("#mediaSizeUp").click(function(){a.adjustImageSize(0.1);return!1});c("#mediaSizeOriginal").click(function(){a.adjustImageSize(0,!0);return!1});c("#mediaSizeFit").click(function(){a.adjustImageSize(0,
!1,!0);return!1});c("#mediaEditLink").click(function(){a.editor.plugins.wswidget.openWidget(a.img);a.hide();return!1});c("#mediaRemoveLink").click(function(){a.editor.undoManager.add();a.editor.dom.remove(a.img);a.hide();return!1})},toggleFitImage:function(){800<c(this.img).width()?c("#mediaSizeFit").show():c("#mediaSizeFit").hide()}});f.PluginManager.add("wswidgetoverlay",wikispaces.plugins.WidgetOverlay)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.LinkTextPlugin:wikispaces.plugins.LinkPlugin",{init:function(a){var b=this;this.editor=a;a.addCommand("wslinkText",function(){f.mainEditor.plugins.wspopup.show("linkTool",{plugin:b})})},getInfo:function(){return{longname:"Wikispaces link (text)",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},setupForms:function(){this.editor.wsselection.restore(!0);this.editor.plugins.wstext.expandSelectionToTag("[[",
"","]]");var a=c.trim(this.editor.plugins.wstext.getSelectedText());a&&this.editor.plugins.wslinkpopup.prefill(this.parseLink(a))},parseLink:function(a){var b="",c="",e=null;if(e=a.match(/^\[\[(@)?((?:[a-zA-Z0-9.+-]+:\/\/|mailto:).*?)(?:\|(.*))?\]\]$/i)){var f=a="";e[1]&&(b=e[1]);e[3]&&(c=e[3]);if(e[2]){a=e[2];e=null;if(e=a.match(/^mailto:(.+)/i))f=e[1];c||(c=a)}return{linkText:c,extLink:a,mailTo:f,targetNew:b}}if(e=a.match(/\[\[(@)?(?:([a-z0-9-]+):)?(?:([a-z0-9-]+)[:\/])?([^|\[\]\{\}\$#@\\]+)(?:\#([A-Za-z][-A-Za-z0-9_ ]*))?(?:\|([^\[\]\xff]+))?\]\]/)){var h=
f=a="",k="page";e[1]&&(b=e[1]);e[2]&&e[3]?(k=e[2],a=e[3]):e[2]&&("doc"==e[2]||"file"==e[2]?k=e[2]:a=e[2]);e[4]&&(f=e[4]);if(match=f.match(/^[\/:](.*)/))a=wikispaces_wikiName,f=match[1];e[5]&&(h=e[5]);e[6]&&(c=e[6]);c||(c=a&&a!=wikispaces_wikiName?a+" / "+f:f);return{linkText:c,objectClass:k,pageName:f,wikiName:a,anchor:h,targetNew:b}}return{linkText:a}},insertLinkFromComponents:function(a){var b="";a.targetNew&&(b="@");if(a.pageName){var c=("page"==a.objectClass?"":a.objectClass+":")+(a.wikiName==
wikispaces_wikiName?"":a.wikiName+":")+a.pageName;this.editor.wsselection.setContent("[["+b+c+(a.anchor?a.anchor:"")+(a.linkText==c?"":"|"+a.linkText)+"]] ");ws.common.track("Editor","Add Link",a.wikiName+":"+c)}else c=a.mailTo?"mailto:"+encodeURI(a.mailTo).replace(/%25/g,"%"):encodeURI(a.url).replace(/%25/g,"%"),this.editor.wsselection.setContent("[["+b+c+(c==a.linkText?"":"|"+a.linkText)+"]] "),ws.common.track("Editor","Add Link",c);return!0},removeLink:function(){ws.common.track("Editor","Remove Link");
if(this.editor.plugins.wstext.expandSelectionToTag("[[","","]]")){var a=this.editor.plugins.wstext.getSelectedText();if("[[code]]"!=a&&!a.match(/^\[\[media /)&&!a.match(/^\[\[file /)&&!a.match(/^\[\[image /)&&!a.match(/^\[\[include /)){a=a.match(/(\s*)\[\[([^\]]*)\]\](\s*)/);a=a[1]+a[2]+a[3];this.editor.plugins.wstext.insertInEditor(a);return}}alert("Please put your cursor inside of the link wikitext to remove it.")}});f.PluginManager.add("wslinktext",wikispaces.plugins.LinkTextPlugin)})(tinymce,
jQuery);
(function(f,c){f.create("wikispaces.plugins.PreviewTextPlugin:wikispaces.plugins.PreviewPlugin",{init:function(a){this.editor=a;var b=this;a.addCommand("previewText",function(){b.showPreview()});a.addCommand("endPreviewText",function(){b.hidePreview()})},getInfo:function(){return{longname:"Wikispaces preview text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},hideEditor:function(){c("#plainTextEditor").hide()},showEditor:function(){c("#plainTextEditor").show()}});f.PluginManager.add("wspreviewtext",
wikispaces.plugins.PreviewTextPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.StyleTextPlugin:wikispaces.plugins.StylePlugin",{init:function(a){var b=this;this.editor=a;a.addCommand("wsStyleText",function(){var a=b.editor.plugins.wstext.getSelectedText();f.mainEditor.plugins.wspopup.show("stylePopupContents",{plugin:b,text:a})})},getInfo:function(){return{longname:"Wikispaces style text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},setSpanText:function(a){if(a.text&&(a=a.text.match(/^<span\s+.*?style="([\s\S]*?)"[\s\S]*<\/span>$/i))&&
2==a.length)for(var a=a[1].split(";"),b=0;b<a.length;b++){var d=a[b].split(":"),e=c.trim(d[0]),d=c.trim(d[1]);e&&d&&(this.setSpanTextValue(e,d),document.styleForm.removeStyleButton.disabled=!1)}},applyStyle:function(){ws.common.track("Editor","Apply Style");var a=c.trim(document.styleForm.styleText.value);if(0<a.length){var b=this.editor.plugins.wstext.getSelectedText(),d=b.match(/^<span [\s\S]*?>([\s\S]*)<\/span>$/i);d&&2==d.length&&(b=d[1]);document.getElementById("textEditor").focus();this.editor.plugins.wstext.insertInEditor('<span style="'+
a+'">'+b+"</span>")}else this.removeStyle();return!1},removeStyle:function(){ws.common.track("Editor","Remove Style");var a=this.editor.plugins.wstext.getSelectedText().match(/^<span [\s\S]*?>([\s\S]*)<\/span>$/i);a&&2==a.length&&this.editor.plugins.wstext.insertInEditor(a[1])},getUsedColors:function(){var a=[],b=this.editor.plugins.wstext.getContent().match(/style=\"[^\"]*?color:\s*.*?[;\"]/gi);if(b)for(var c=0;c<b.length;c++){var e=b[c].match(/color:\s*(.*?)[;\"]/i);a[a.length]=(new RGBColor(e[1])).toHex().toUpperCase()}return a}});
f.PluginManager.add("wsstyletext",wikispaces.plugins.StyleTextPlugin)})(tinymce,jQuery);
(function(f,c){f.create("wikispaces.plugins.TextPlugin",{init:function(a){var b=this;b.editor=a;a.addCommand("wstext",function(){"visual"==a.plugins.wscommon.getOption("mode")?b.switchToTextEditor():(c("#previewBox").length&&a.execCommand("endPreviewText"),b.switchToVisualEditor())});a.addCommand("BoldText",function(){b.wrapTextEditorSelection("**")});a.addCommand("ItalicText",function(){b.wrapTextEditorSelection("//")});a.addCommand("UnderlineText",function(){b.wrapTextEditorSelection("__")});a.addCommand("wsFormatBlockText",
function(a,c){var f="";"h1"==c?f="=":"h2"==c?f="==":"h3"==c?f="===":"h4"==c?f="====":"h5"==c?f="=====":"h6"==c&&(f="======");if(f)if(b.getSelectedText())b.insertInEditor("\n"+f+b.getSelectedText()+f+"\n");else{var h=document.getElementById("textEditor");b.prepareSelection(h);var k=h.sel_start+f.length+1;b.insertInEditor("\n"+f+f+"\n");b.setSelectionRange(h,k,k)}document.getElementById("textEditor").focus()});a.addCommand("wsInsertOrderedListText",function(){b.addListInTextEditor("#")});a.addCommand("wsInsertUnorderedListText",
function(){b.addListInTextEditor("*")});a.addCommand("wsInsertHorizontalRuleText",function(){b.insertInEditor("\n----\n")})},getInfo:function(){return{longname:"Wikispaces text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},flipToText:function(a){this.editor.undoManager.clear();c("#plainTextEditor").show();c("#textEditor").show().val(a);c("html, body").animate({scrollTop:0},"fast");c("#wsMainEditor_container").css("position","static");this.editor.plugins.wscommon.setOption("mode",
"plain");this.editor.onModeSwitch.dispatch("plain");c(this.editor.getContentAreaContainer()).hide();setTimeout(function(){c("#textEditor").focus()},500);f.isIE&&(a=function(){c("#textEditor").css("width",c("#textEditor").parent().width()-10)},a(),c(window).resize(a));this.setClean()},switchToTextEditor:function(){var a=this;this.convertContent(this.editor.plugins.wscommon.fullContent(!0),"plain",function(b){a.flipToText(b)},function(){a.switchToTextEditor()});ws.common.track("Editor","Switch Mode To",
"Text")},switchToVisualEditor:function(){var a=this;this.convertContent(this.editor.plugins.wstext.getContent(),"visual",function(b){c("#plainTextEditor").hide();c(a.editor.getContentAreaContainer()).show();c("html, body").animate({scrollTop:0},"fast");a.editor.plugins.wscommon.setOption("mode","visual");a.editor.onModeSwitch.dispatch("visual");a.editor.setContent(b,{load:!0});a.editor.undoManager.clear();a.editor.onNeedsResize.dispatch();setTimeout(function(){a.editor.onNeedsResize.dispatch()},1E3);
a.editor.wsselection.ensureCursor();a.editor.focus();c("#wsMainEditor_container").css("position","relative")},function(){a.switchToVisualEditor()});ws.common.track("Editor","Switch Mode To","Visual")},convertContent:function(a,b,d,e){var f=this,h=c("<div></div>").attr("id","textSpinner").addClass("wikispaces_content").addClass("mceToolbar spinner").css({textAlign:"center"}).html('Loading <img src="/i/spinner.gif" alt="" width="18" height="18" style="padding-top: 9px; vertical-align: -4px;"/>');c(".mceToolbar").hide();
c(f.editor.plugins.wscommon.editorToolbar()).append(h);c.ajax({url:ws.common.pathFor("page","convert",wikispaces_page),type:"POST",async:!1,cache:!1,data:{content:a,mode:b},dataType:"xml",global:!1,error:function(){ws.session.reloadSession(e,3E3,function(){f.editor.plugins.wscommon.sessionReloadFailed();c(".mceToolbar.spinner").remove();c(".mceToolbar").show()})},success:function(a){ws.session.reloadSessionSuccess();a=c(a).find("convert");a.length&&d(a.text());c(".mceToolbar.spinner").remove();c(".mceToolbar").show()}})},
editorTextArea:function(){return c("#textEditor").get(0)},getContent:function(){return c("#textEditor").val()},isDirty:function(){return this.getContent()!=this.cleanContent},setClean:function(){this.cleanContent=this.getContent()},insertInEditor:function(a){var b=document.getElementById("textEditor");b.focus();if(document.selection)sel=document.selection.createRange(),sel.text=a,sel.select();else if(b.selectionStart||"0"==b.selectionStart){var d=b.selectionStart,e=b.selectionEnd,f=b.scrollTop;c(b).val(b.value.substring(0,
d)+a+b.value.substring(e,b.value.length));b.scrollTop=f;d==e?this.setSelectionRange(b,d+a.length,d+a.length):this.setSelectionRange(b,d,d+a.length);this.editor.wsselection.saveOver()}else b.value+=a},setSelectionRange:function(a,b,c){if(a.setSelectionRange)return a.setSelectionRange(b,c);a=a.createTextRange();a.collapse(!0);a.moveEnd("character",c);a.moveStart("character",b);a.select()},wrapTextEditorSelection:function(a){for(var b=this.getSelectedText(),c=b.length,b=b.replace(/^\s+/,""),e=c-b.length,
b=b.replace(/\s+$/,""),f=c-e-b.length,c="",c=b.substring(0,a.length)==a&&b.substring(b.length-a.length,b.length)==a?b.substring(a.length,b.length-a.length):a+b+a,a=0;a<e;a++)c=" "+c;for(a=0;a<f;a++)c+=" ";e=document.getElementById("textEditor");this.prepareSelection(e);a=e.sel_start;b=e.sel_end;f=c.length;this.insertInEditor(c);a==b?this.setSelectionRange(e,a+f/2,a+f/2):this.setSelectionRange(e,a,f+a);this.editor.wsselection.saveOver();e.focus()},getSelectedText:function(){var a=document.getElementById("textEditor");
return a?(this.prepareSelection(a),a.sel_text?a.sel_text:""):""},prepareSelection:function(a){a.sel_text="";a.sel_text_pre="";a.sel_text_post="";a.sel_start=0;a.sel_end=0;a.focus();if("number"==typeof a.selectionStart)a.sel_start=a.selectionStart,a.sel_end=a.selectionEnd;else if(document.selection){var b=document.selection.createRange();if(b.parentElement()!=a)return;var d=b.duplicate();d.moveToElementText(a);d.setEndPoint("EndToEnd",b);for(var d=d.text.length,b=d-b.text.length,e=a.value,f=d-1;f>=
b;--f)"\n"==e.charAt(f)&&--d;for(f=b-1;0<=f;--f)"\n"==e.charAt(f)&&(--d,--b);a.sel_start=b;a.sel_end=d}d=c(a).val();a.sel_text=d.substring(a.sel_start,a.sel_end);a.sel_text_pre=d.substring(0,a.sel_start);a.sel_text_post=d.substring(a.sel_end)},expandSelectionToLine:function(){var a=document.getElementById("textEditor");this.prepareSelection(a);for(var b,d=c(a).val(),e=a.sel_start-1;0<=e;e--)if("\n"==d.charAt(e)){b=e+1;break}for(e=a.sel_end;e<d.length&&"\n"!=d.charAt(e);e++);this.setSelectionRange(a,
b,e);return!0},expandSelectionToTag:function(a,b,d){var e=this.getSelectedText().replace(/^\s+/,"").replace(/\s+$/,"");if(e)return e.substring(0,b.length+a.length)==a+b&&e.substring(e.length-d.length,e.length)==d?!0:!1;e=document.getElementById("textEditor");this.prepareSelection(e);var f=0,h=0,k=e.sel_start-1;0>k&&(k=0);for(var l=null,m=c(e).val();0<=k;k--)if(m.substr(k,a.length+b.length)==a+b){if(0==h){l=k;break}h--}else{if(m.substr(k,a.length)==a)return!1;m.substr(k,d.length)==d&&e.sel_start-k>=
d.length&&h++}if(null==l)return!1;k=e.sel_end-(d.length-1);0>k&&(k=0);for(k<l+a.length+b.length&&(k=l+a.length+b.length);k<m.length-1;k++)if(m.substr(k,d.length)==d){if(0==f)return this.setSelectionRange(e,l,k+d.length),this.editor.wsselection.saveOver(),!0;f--}else m.substr(k,a.length)==a&&f++;return!1},addListInTextEditor:function(a){this.getSelectedText()||this.expandSelectionToLine();var b=document.getElementById("textEditor");this.prepareSelection(b);for(var c=b.sel_text,e="",f=!0,c=c.split("\n"),
h=0;h<c.length;h++){var k;(k=c[h].match(/^(\#|\*|\>)+\s(.*)$/i))?(k[1].charAt(0)!=a&&(f=!1),e+="\n"+a+" "+k[2]):(f=!1,e+="\n"+a+" "+c[h])}if(0==b.sel_text_pre.length||"\n"==b.sel_text_pre.charAt(b.sel_text_pre.length-1))e=e.substring(1,e.length);if(f){c=b.sel_text;e="";c=c.split("\n");for(h=0;h<c.length;h++)if(k=c[h].match(/^(\#|\*|\>)+\s(.*)$/i))e+=k[2]+"\n";"\n"!=b.sel_text.charAt(b.sel_text.length-1)&&(e=e.substring(0,e.length-1))}this.insertInEditor(e)}});f.PluginManager.add("wstext",wikispaces.plugins.TextPlugin)})(tinymce,
jQuery);
(function(f){var c=f.DOM;f.create("wikispaces.themes.ReferenceTheme:wikispaces.themes.WikispacesTheme",{renderUI:function(a){var b=this.editor,d=b.controlManager,e=b.getParam("reference_reference_id"),g=c.insertAfter(c.create("div",{id:b.id+"_container","class":"mceEditor "+b.settings.skin+"Skin editorLayer referenceEditor",style:"position: relative; margin-top: 5px; "}),a.targetNode),a=c.add(g,"div",{"class":"mceIframeContainer editorLayer",style:"position: relative;"}),h=c.add(g,"div",{id:b.id+"_external",
"class":"toolbarLayer"});this.toolbar=d.createToolbar("tools1");this.toolbar.add(d.createButton("wsremovereference",{title:"Remove Reference",label:"Remove Reference","class":"btn",onclick:function(){f.mainEditor.plugins.wsreference.toggleReference(e)}}));this.toolbar.add(d.createButton("wsgotoreference",{title:"Show Citation",label:"Show Citation","class":"btn",onclick:function(){var a=jQuery(f.mainEditor.getDoc()).find("#citation-"+e),c=b.plugins.wscommon.absoluteOffset(a.get(0)).top,d=0,g=function(){2<
d++||a.animate({opacity:"0.1"},500,"swing",function(){a.animate({opacity:"1.0"},500,"swing",g)})};jQuery(window).scrollTo(c-55,{axis:"y",duration:500,onAfter:g})}}));this.toolbar.renderTo(h);jQuery(h).find(".btn span.mceButtonLabel").wrap("<span />");jQuery(h).find("td:first-child").attr("width",5);jQuery(h).find("td:nth-child(2)").attr("width",140);jQuery(h).find("td:nth-child(3)").attr("width",120);d=c.add(g,"div",{style:"display: none;"});return{iframeContainer:a,editorContainer:b.id+"_container",
sizeContainer:d,deltaHeight:0}},getInfo:function(){return{longname:"Wikispaces reference theme",author:"Tangient LLC",authorurl:"http://wikispaces.com",version:"0.1"}}});f.ThemeManager.add("reference",wikispaces.themes.ReferenceTheme)})(tinymce);
(function(f){var c=f.DOM;f.create("wikispaces.themes.SubEditorTheme:wikispaces.themes.WikispacesTheme",{renderUI:function(a){var b=this.editor,d=c.insertAfter(c.create("div",{id:b.id+"_container","class":"mceEditor "+b.settings.skin+"Skin editorLayer",style:"position: relative; "}),a.targetNode),a=c.add(d,"div",{"class":"mceIframeContainer editorLayer",style:"position: relative;"}),d=c.add(d,"div",{style:"display: none;"});return{iframeContainer:a,editorContainer:b.id+"_container",sizeContainer:d,
deltaHeight:0}},getInfo:function(){return{longname:"Wikispaces subeditor theme",author:"Tangient LLC",authorurl:"http://wikispaces.com",version:"0.1"}}});f.ThemeManager.add("subeditor",wikispaces.themes.SubEditorTheme)})(tinymce);(function(){tinymce.create("tinymce.plugins.Rgbcolor",{init:function(){}});tinymce.PluginManager.add("rgbcolor",tinymce.plugins.Rgbcolor)})();
function RGBColor(f){this.ok=!1;"#"==f.charAt(0)&&(f=f.substr(1,6));var f=f.replace(/ /g,""),f=f.toLowerCase(),c={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",
darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",
gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",
lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",
oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",
slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},a;for(a in c)f==a&&(f=c[a]);var b=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,
example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}];for(a=0;a<b.length;a++){var d=b[a].process,e=b[a].re.exec(f);e&&(channels=d(e),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=0>this.r||isNaN(this.r)?0:255<this.r?255:this.r;this.g=0>this.g||isNaN(this.g)?0:
255<this.g?255:this.g;this.b=0>this.b||isNaN(this.b)?0:255<this.b?255:this.b;this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);1==a.length&&(a="0"+a);1==b.length&&(b="0"+b);1==c.length&&(c="0"+c);return"#"+a+b+c};this.getHelpXML=function(){for(var a=[],d=0;d<b.length;d++)for(var e=b[d].example,f=0;f<e.length;f++)a[a.length]=e[f];for(var m in c)a[a.length]=m;e=document.createElement("ul");
e.setAttribute("id","rgbcolor-examples");for(d=0;d<a.length;d++)try{var n=document.createElement("li"),o=new RGBColor(a[d]),p=document.createElement("div");p.style.cssText="margin: 3px; border: 1px solid black; background:"+o.toHex()+"; color:"+o.toHex();p.appendChild(document.createTextNode("test"));var q=document.createTextNode(" "+a[d]+" -> "+o.toRGB()+" -> "+o.toHex());n.appendChild(p);n.appendChild(q);e.appendChild(n)}catch(s){}return e}}
(function(){tinymce.create("tinymce.plugins.Autoresize",{init:function(f){f.onNeedsResize=new tinymce.util.Dispatcher(f);f.onNeedsResize.add(this.fitEditor);f.onSetContent.add(this.fitEditor);f.onChange.add(this.fitEditor);f.onKeyDown.add(this.fitEditor);f.onInit.add(this.fitEditor);f.onPaste.add(function(){_.delay(function(){f.onNeedsResize.dispatch()},200)});f.onNeedsResize.dispatch()},fitEditor:function(){editorID=this.id;var f,c,a;c=document.getElementById(editorID+"_ifr");if(null!=c&&(c.contentDocument?
a=c.contentDocument:c.contentWindow?a=c.contentWindow.document:c.document&&(a=c.document),null!=a)){a.body.style.overflow="hidden";f=c.parentNode.parentNode.parentNode.parentNode;f.style.height="auto";f=parseInt(c.style.height);a=tinymce.isWebKit||jQuery.browser.mozilla?jQuery(a.body).height():parseInt(a.body.scrollHeight);var b=tinymce.isWebKit?0:50;a+b>f?c.style.height=a+b+"px":a+b<f&&(c.style.height=Math.max(a+b,100)+"px");jQuery(c).parent().css("width","100%");jQuery(c).scrollTo(0)}}});tinymce.PluginManager.add("autoresize",
tinymce.plugins.Autoresize)})();window.wikispaces_jsLoaded=window.wikispaces_jsLoaded||[];window.wikispaces_jsLoaded.push({editorc:"2:6036c16841ea1dc3b710f96e17d21a10"});
